{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\komun\\\\booking-app\\\\frontend\\\\src\\\\pages\\\\CategoryView.tsx\",\n  _env,\n  _s = $RefreshSig$();\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport { Card, CardContent } from \"../components/ui/card\";\nimport { Badge } from \"../components/ui/badge\";\nimport { Button } from \"../components/ui/button\";\nimport { Skeleton } from \"../components/ui/skeleton\";\nimport { Separator } from \"../components/ui/separator\";\nimport { ToggleGroup, ToggleGroupItem } from \"../components/ui/toggle-group\";\nimport { ArrowLeft, ExternalLink } from \"lucide-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = ((_env = import.meta.env) === null || _env === void 0 ? void 0 : _env.VITE_API_BASE) || window.__API_BASE__ || \"http://127.0.0.1:8000\";\n\n/** Вади масив от различни възможни форми на отговор: [], {items:[]}, {tools:[]}, {data:[]}, {results:[]} */\nfunction extractArray(raw) {\n  if (Array.isArray(raw)) return raw;\n  if (Array.isArray(raw === null || raw === void 0 ? void 0 : raw.items)) return raw.items;\n  if (Array.isArray(raw === null || raw === void 0 ? void 0 : raw.tools)) return raw.tools;\n  if (Array.isArray(raw === null || raw === void 0 ? void 0 : raw.data)) return raw.data;\n  if (Array.isArray(raw === null || raw === void 0 ? void 0 : raw.results)) return raw.results;\n  // последен шанс – ако е обект и съдържа някъде масив\n  if (raw && typeof raw === \"object\") {\n    const firstArray = Object.values(raw).find(Array.isArray);\n    if (Array.isArray(firstArray)) return firstArray;\n  }\n  return [];\n}\n\n/** Нормализира инструмент към очакваната форма от фронтенда */\nfunction normalizeTool(t) {\n  var _ref, _ref2, _ref3, _ref4, _t$name, _ref5, _ref6, _ref7, _ref8, _t$link, _t$links, _ref9, _ref0, _ref1, _t$icon, _ref10, _ref11, _ref12, _t$description, _ref13, _ref14, _ref15, _t$tags, _ref16, _ref17, _t$rating, _t$id;\n  const name = (_ref = (_ref2 = (_ref3 = (_ref4 = (_t$name = t === null || t === void 0 ? void 0 : t.name) !== null && _t$name !== void 0 ? _t$name : t === null || t === void 0 ? void 0 : t.title) !== null && _ref4 !== void 0 ? _ref4 : t === null || t === void 0 ? void 0 : t.tool_name) !== null && _ref3 !== void 0 ? _ref3 : t === null || t === void 0 ? void 0 : t.tool) !== null && _ref2 !== void 0 ? _ref2 : t === null || t === void 0 ? void 0 : t.id) !== null && _ref !== void 0 ? _ref : \"Untitled tool\";\n  const link = (_ref5 = (_ref6 = (_ref7 = (_ref8 = (_t$link = t === null || t === void 0 ? void 0 : t.link) !== null && _t$link !== void 0 ? _t$link : t === null || t === void 0 ? void 0 : t.url) !== null && _ref8 !== void 0 ? _ref8 : t === null || t === void 0 ? void 0 : t.href) !== null && _ref7 !== void 0 ? _ref7 : t === null || t === void 0 ? void 0 : (_t$links = t.links) === null || _t$links === void 0 ? void 0 : _t$links.website) !== null && _ref6 !== void 0 ? _ref6 : t === null || t === void 0 ? void 0 : t.website) !== null && _ref5 !== void 0 ? _ref5 : null;\n  const icon = (_ref9 = (_ref0 = (_ref1 = (_t$icon = t === null || t === void 0 ? void 0 : t.icon) !== null && _t$icon !== void 0 ? _t$icon : t === null || t === void 0 ? void 0 : t.logo) !== null && _ref1 !== void 0 ? _ref1 : t === null || t === void 0 ? void 0 : t.icon_url) !== null && _ref0 !== void 0 ? _ref0 : t === null || t === void 0 ? void 0 : t.image) !== null && _ref9 !== void 0 ? _ref9 : null;\n  const description = (_ref10 = (_ref11 = (_ref12 = (_t$description = t === null || t === void 0 ? void 0 : t.description) !== null && _t$description !== void 0 ? _t$description : t === null || t === void 0 ? void 0 : t.desc) !== null && _ref12 !== void 0 ? _ref12 : t === null || t === void 0 ? void 0 : t.summary) !== null && _ref11 !== void 0 ? _ref11 : t === null || t === void 0 ? void 0 : t.about) !== null && _ref10 !== void 0 ? _ref10 : null;\n\n  // позволяваме различни ключове за тагове\n  const rawTags = (_ref13 = (_ref14 = (_ref15 = (_t$tags = t === null || t === void 0 ? void 0 : t.tags) !== null && _t$tags !== void 0 ? _t$tags : t === null || t === void 0 ? void 0 : t.labels) !== null && _ref15 !== void 0 ? _ref15 : t === null || t === void 0 ? void 0 : t.keywords) !== null && _ref14 !== void 0 ? _ref14 : t === null || t === void 0 ? void 0 : t.badges) !== null && _ref13 !== void 0 ? _ref13 : [];\n  const tags = Array.isArray(rawTags) ? rawTags.filter(x => typeof x === \"string\").map(x => x.trim()).filter(Boolean) : [];\n\n  // оценка, ако я има\n  let rating = null;\n  const r = (_ref16 = (_ref17 = (_t$rating = t === null || t === void 0 ? void 0 : t.rating) !== null && _t$rating !== void 0 ? _t$rating : t === null || t === void 0 ? void 0 : t.score) !== null && _ref17 !== void 0 ? _ref17 : t === null || t === void 0 ? void 0 : t.rank) !== null && _ref16 !== void 0 ? _ref16 : null;\n  if (typeof r === \"number\") rating = r;\n  return {\n    id: (_t$id = t === null || t === void 0 ? void 0 : t.id) !== null && _t$id !== void 0 ? _t$id : name,\n    name: String(name),\n    description,\n    tags,\n    icon,\n    link,\n    rating\n  };\n}\n\n/** Помощна проверка за филтър по тагове */\nfunction toolHasTag(tool, tag) {\n  var _tool$tags;\n  const tags = ((_tool$tags = tool.tags) !== null && _tool$tags !== void 0 ? _tool$tags : []).map(x => x.toLowerCase());\n  return tags.some(x => x.includes(tag.toLowerCase()));\n}\nexport default function CategoryView() {\n  _s();\n  const {\n    cap = \"\"\n  } = useParams();\n  const [loading, setLoading] = useState(true);\n  const [tools, setTools] = useState([]);\n  const [filter, setFilter] = useState(null);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    let cancelled = false;\n    const controller = new AbortController();\n    async function load() {\n      setLoading(true);\n      setError(null);\n      try {\n        const ts = Date.now();\n\n        // Основен (официален) ендпойнт:\n        const url1 = `${API_BASE}/catalog/tools?cap=${encodeURIComponent(cap || \"\")}&t=${ts}`;\n        const res1 = await fetch(url1, {\n          signal: controller.signal,\n          headers: {\n            \"Cache-Control\": \"no-cache\"\n          }\n        });\n\n        // fallback към /catalog/categories/:cap ако бекендът е такъв\n        let data;\n        if (res1.ok) {\n          data = await res1.json();\n        } else {\n          const url2 = `${API_BASE}/catalog/categories/${encodeURIComponent(cap || \"\")}?t=${ts}`;\n          const res2 = await fetch(url2, {\n            signal: controller.signal,\n            headers: {\n              \"Cache-Control\": \"no-cache\"\n            }\n          });\n          if (!res2.ok) {\n            throw new Error(`Failed to load tools. HTTP ${res1.status} / ${res2.status}`);\n          }\n          data = await res2.json();\n        }\n        const arr = extractArray(data).map(normalizeTool);\n        if (!cancelled) {\n          setTools(arr);\n          setLoading(false);\n        }\n      } catch (e) {\n        if (cancelled || (e === null || e === void 0 ? void 0 : e.name) === \"AbortError\") return;\n        console.error(\"CategoryView fetch failed\", e);\n        if (!cancelled) {\n          setError(\"Възникна грешка при зареждане на инструментите.\");\n          setTools([]);\n          setLoading(false);\n        }\n      }\n    }\n    load();\n    return () => {\n      cancelled = true;\n      controller.abort();\n    };\n  }, [cap]);\n  const shown = useMemo(() => {\n    // базов списък\n    let list = tools;\n\n    // приложи филтър по таг\n    if (filter) {\n      const f = filter.toLowerCase();\n      if (f === \"free\") {\n        list = list.filter(t => toolHasTag(t, \"free\") || toolHasTag(t, \"безплат\") || toolHasTag(t, \"freemium\"));\n      } else if (f === \"trending\") {\n        list = list.filter(t => toolHasTag(t, \"trending\") || toolHasTag(t, \"trend\") || toolHasTag(t, \"популяр\"));\n      } else if (f === \"new\") {\n        list = list.filter(t => toolHasTag(t, \"new\") || toolHasTag(t, \"нов\") || toolHasTag(t, \"ново\"));\n      }\n    }\n    return list;\n  }, [tools, filter]);\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    className: \"mx-auto max-w-7xl px-4 py-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-end justify-between gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/categories\",\n          className: \"inline-flex items-center gap-2 text-slate-600 hover:text-blue-600 transition-colors p-2 -ml-2 rounded-xl\",\n          children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n            className: \"w-4 h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-2xl md:text-3xl font-bold tracking-tight break-words\",\n            children: cap\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-muted-foreground mt-1\",\n            children: \"\\u0418\\u043D\\u0441\\u0442\\u0440\\u0443\\u043C\\u0435\\u043D\\u0442\\u0438 \\u0432 \\u0442\\u0430\\u0437\\u0438 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F. \\u0418\\u0437\\u043F\\u043E\\u043B\\u0437\\u0432\\u0430\\u0439 \\u0444\\u0438\\u043B\\u0442\\u0440\\u0438\\u0442\\u0435, \\u0437\\u0430 \\u0434\\u0430 \\u043F\\u0440\\u0435\\u0446\\u0438\\u0437\\u0438\\u0440\\u0430\\u0448 \\u0440\\u0435\\u0437\\u0443\\u043B\\u0442\\u0430\\u0442\\u0438\\u0442\\u0435.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ToggleGroup, {\n        type: \"single\",\n        value: filter !== null && filter !== void 0 ? filter : \"\",\n        onValueChange: v => setFilter(v || null),\n        className: \"bg-muted rounded-xl p-1\",\n        children: [/*#__PURE__*/_jsxDEV(ToggleGroupItem, {\n          value: \"\",\n          \"aria-label\": \"All\",\n          children: \"\\u0412\\u0441\\u0438\\u0447\\u043A\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ToggleGroupItem, {\n          value: \"free\",\n          \"aria-label\": \"Free\",\n          children: \"\\u0411\\u0435\\u0437\\u043F\\u043B\\u0430\\u0442\\u043D\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ToggleGroupItem, {\n          value: \"trending\",\n          \"aria-label\": \"Trending\",\n          children: \"\\u0422\\u0440\\u0435\\u043D\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ToggleGroupItem, {\n          value: \"new\",\n          \"aria-label\": \"New\",\n          children: \"\\u041D\\u043E\\u0432\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Separator, {\n      className: \"my-6\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid sm:grid-cols-2 lg:grid-cols-3 gap-4\",\n      children: Array.from({\n        length: 9\n      }).map((_, i) => /*#__PURE__*/_jsxDEV(Skeleton, {\n        className: \"h-40 rounded-2xl\"\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 9\n    }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-sm text-red-600 bg-red-50 border border-red-200 rounded-xl p-3\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 9\n    }, this) : shown.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-sm text-muted-foreground\",\n      children: \"\\u041D\\u044F\\u043C\\u0430 \\u0438\\u043D\\u0441\\u0442\\u0440\\u0443\\u043C\\u0435\\u043D\\u0442\\u0438.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid sm:grid-cols-2 lg:grid-cols-3 gap-4\",\n      children: shown.map(t => {\n        var _t$id2;\n        return /*#__PURE__*/_jsxDEV(\"a\", {\n          href: t.link || \"#\",\n          target: \"_blank\",\n          rel: \"noreferrer\",\n          className: \"group\",\n          onClick: e => {\n            if (!t.link) e.preventDefault();\n          },\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            className: \"rounded-2xl h-full hover:shadow-md transition\",\n            children: /*#__PURE__*/_jsxDEV(CardContent, {\n              className: \"pt-5\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-start gap-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-10 h-10 rounded-xl bg-slate-100 flex items-center justify-center overflow-hidden shrink-0\",\n                  children: t.icon ? /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: t.icon,\n                    alt: t.name,\n                    className: \"w-10 h-10 object-cover\",\n                    loading: \"lazy\",\n                    onError: e => {\n                      const img = e.currentTarget;\n                      img.style.display = \"none\";\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 275,\n                    columnNumber: 25\n                  }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-slate-400 text-sm\",\n                    children: \"AI\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 286,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 273,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"min-w-0\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                      className: \"font-semibold truncate\",\n                      children: t.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 291,\n                      columnNumber: 25\n                    }, this), typeof t.rating === \"number\" && /*#__PURE__*/_jsxDEV(Badge, {\n                      variant: \"secondary\",\n                      children: t.rating.toFixed(2)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 293,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 290,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-slate-600 line-clamp-2 mt-0.5\",\n                    children: t.description || \"AI Tool\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 298,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-2 flex flex-wrap gap-1\",\n                    children: (t.tags || []).slice(0, 4).map((tag, i) => /*#__PURE__*/_jsxDEV(Badge, {\n                      variant: \"outline\",\n                      children: tag\n                    }, i, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 303,\n                      columnNumber: 27\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 301,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-3\",\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      size: \"sm\",\n                      variant: t.link ? \"default\" : \"secondary\",\n                      className: \"rounded-xl\",\n                      children: [\"\\u041E\\u0442\\u0432\\u043E\\u0440\\u0438 \\u0438\\u043D\\u0441\\u0442\\u0440\\u0443\\u043C\\u0435\\u043D\\u0442\", \" \", /*#__PURE__*/_jsxDEV(ExternalLink, {\n                        className: \"w-4 h-4 ml-2\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 315,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 309,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 308,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 15\n          }, this)\n        }, (_t$id2 = t.id) !== null && _t$id2 !== void 0 ? _t$id2 : t.name, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 201,\n    columnNumber: 5\n  }, this);\n}\n_s(CategoryView, \"8K6QrFJFI9U/RVArN+ciDeYMdZA=\", false, function () {\n  return [useParams];\n});\n_c = CategoryView;\nvar _c;\n$RefreshReg$(_c, \"CategoryView\");","map":{"version":3,"names":["useEffect","useMemo","useState","useParams","Link","Card","CardContent","Badge","Button","Skeleton","Separator","ToggleGroup","ToggleGroupItem","ArrowLeft","ExternalLink","jsxDEV","_jsxDEV","API_BASE","_env","import","meta","env","VITE_API_BASE","window","__API_BASE__","extractArray","raw","Array","isArray","items","tools","data","results","firstArray","Object","values","find","normalizeTool","t","_ref","_ref2","_ref3","_ref4","_t$name","_ref5","_ref6","_ref7","_ref8","_t$link","_t$links","_ref9","_ref0","_ref1","_t$icon","_ref10","_ref11","_ref12","_t$description","_ref13","_ref14","_ref15","_t$tags","_ref16","_ref17","_t$rating","_t$id","name","title","tool_name","tool","id","link","url","href","links","website","icon","logo","icon_url","image","description","desc","summary","about","rawTags","tags","labels","keywords","badges","filter","x","map","trim","Boolean","rating","r","score","rank","String","toolHasTag","tag","_tool$tags","toLowerCase","some","includes","CategoryView","_s","cap","loading","setLoading","setTools","setFilter","error","setError","cancelled","controller","AbortController","load","ts","Date","now","url1","encodeURIComponent","res1","fetch","signal","headers","ok","json","url2","res2","Error","status","arr","e","console","abort","shown","list","f","className","children","to","fileName","_jsxFileName","lineNumber","columnNumber","type","value","onValueChange","v","from","length","_","i","_t$id2","target","rel","onClick","preventDefault","src","alt","onError","img","currentTarget","style","display","variant","toFixed","slice","size","_c","$RefreshReg$"],"sources":["C:/Users/komun/booking-app/frontend/src/pages/CategoryView.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\nimport { Card, CardContent } from \"../components/ui/card\";\r\nimport { Badge } from \"../components/ui/badge\";\r\nimport { Button } from \"../components/ui/button\";\r\nimport { Skeleton } from \"../components/ui/skeleton\";\r\nimport { Separator } from \"../components/ui/separator\";\r\nimport { ToggleGroup, ToggleGroupItem } from \"../components/ui/toggle-group\";\r\nimport { ArrowLeft, ExternalLink } from \"lucide-react\";\r\n\r\ntype Tool = {\r\n  id?: number | string;\r\n  name: string;\r\n  description?: string | null;\r\n  tags?: string[];\r\n  icon?: string | null;\r\n  link?: string | null;\r\n  rating?: number | null;\r\n};\r\n\r\nconst API_BASE =\r\n  (import.meta as any).env?.VITE_API_BASE ||\r\n  (window as any).__API_BASE__ ||\r\n  \"http://127.0.0.1:8000\";\r\n\r\n/** Вади масив от различни възможни форми на отговор: [], {items:[]}, {tools:[]}, {data:[]}, {results:[]} */\r\nfunction extractArray(raw: any): any[] {\r\n  if (Array.isArray(raw)) return raw;\r\n  if (Array.isArray(raw?.items)) return raw.items;\r\n  if (Array.isArray(raw?.tools)) return raw.tools;\r\n  if (Array.isArray(raw?.data)) return raw.data;\r\n  if (Array.isArray(raw?.results)) return raw.results;\r\n  // последен шанс – ако е обект и съдържа някъде масив\r\n  if (raw && typeof raw === \"object\") {\r\n    const firstArray = Object.values(raw).find(Array.isArray);\r\n    if (Array.isArray(firstArray)) return firstArray as any[];\r\n  }\r\n  return [];\r\n}\r\n\r\n/** Нормализира инструмент към очакваната форма от фронтенда */\r\nfunction normalizeTool(t: any): Tool {\r\n  const name =\r\n    t?.name ??\r\n    t?.title ??\r\n    t?.tool_name ??\r\n    t?.tool ??\r\n    t?.id ??\r\n    \"Untitled tool\";\r\n\r\n  const link =\r\n    t?.link ?? t?.url ?? t?.href ?? t?.links?.website ?? t?.website ?? null;\r\n\r\n  const icon = t?.icon ?? t?.logo ?? t?.icon_url ?? t?.image ?? null;\r\n\r\n  const description =\r\n    t?.description ?? t?.desc ?? t?.summary ?? t?.about ?? null;\r\n\r\n  // позволяваме различни ключове за тагове\r\n  const rawTags = (t?.tags ??\r\n    t?.labels ??\r\n    t?.keywords ??\r\n    t?.badges ??\r\n    []) as any[];\r\n\r\n  const tags: string[] = Array.isArray(rawTags)\r\n    ? rawTags\r\n        .filter((x) => typeof x === \"string\")\r\n        .map((x) => x.trim())\r\n        .filter(Boolean)\r\n    : [];\r\n\r\n  // оценка, ако я има\r\n  let rating: number | null = null;\r\n  const r = t?.rating ?? t?.score ?? t?.rank ?? null;\r\n  if (typeof r === \"number\") rating = r;\r\n\r\n  return {\r\n    id: t?.id ?? name,\r\n    name: String(name),\r\n    description,\r\n    tags,\r\n    icon,\r\n    link,\r\n    rating,\r\n  };\r\n}\r\n\r\n/** Помощна проверка за филтър по тагове */\r\nfunction toolHasTag(tool: Tool, tag: string) {\r\n  const tags = (tool.tags ?? []).map((x) => x.toLowerCase());\r\n  return tags.some((x) => x.includes(tag.toLowerCase()));\r\n}\r\n\r\nexport default function CategoryView() {\r\n  const { cap = \"\" } = useParams();\r\n  const [loading, setLoading] = useState(true);\r\n  const [tools, setTools] = useState<Tool[]>([]);\r\n  const [filter, setFilter] = useState<string | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    const controller = new AbortController();\r\n\r\n    async function load() {\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        const ts = Date.now();\r\n\r\n        // Основен (официален) ендпойнт:\r\n        const url1 = `${API_BASE}/catalog/tools?cap=${encodeURIComponent(\r\n          cap || \"\"\r\n        )}&t=${ts}`;\r\n\r\n        const res1 = await fetch(url1, {\r\n          signal: controller.signal,\r\n          headers: { \"Cache-Control\": \"no-cache\" },\r\n        });\r\n\r\n        // fallback към /catalog/categories/:cap ако бекендът е такъв\r\n        let data: any;\r\n        if (res1.ok) {\r\n          data = await res1.json();\r\n        } else {\r\n          const url2 = `${API_BASE}/catalog/categories/${encodeURIComponent(\r\n            cap || \"\"\r\n          )}?t=${ts}`;\r\n          const res2 = await fetch(url2, {\r\n            signal: controller.signal,\r\n            headers: { \"Cache-Control\": \"no-cache\" },\r\n          });\r\n          if (!res2.ok) {\r\n            throw new Error(\r\n              `Failed to load tools. HTTP ${res1.status} / ${res2.status}`\r\n            );\r\n          }\r\n          data = await res2.json();\r\n        }\r\n\r\n        const arr = extractArray(data).map(normalizeTool);\r\n\r\n        if (!cancelled) {\r\n          setTools(arr);\r\n          setLoading(false);\r\n        }\r\n      } catch (e: any) {\r\n        if (cancelled || e?.name === \"AbortError\") return;\r\n        console.error(\"CategoryView fetch failed\", e);\r\n        if (!cancelled) {\r\n          setError(\"Възникна грешка при зареждане на инструментите.\");\r\n          setTools([]);\r\n          setLoading(false);\r\n        }\r\n      }\r\n    }\r\n\r\n    load();\r\n    return () => {\r\n      cancelled = true;\r\n      controller.abort();\r\n    };\r\n  }, [cap]);\r\n\r\n  const shown = useMemo(() => {\r\n    // базов списък\r\n    let list = tools;\r\n\r\n    // приложи филтър по таг\r\n    if (filter) {\r\n      const f = filter.toLowerCase();\r\n      if (f === \"free\") {\r\n        list = list.filter(\r\n          (t) =>\r\n            toolHasTag(t, \"free\") ||\r\n            toolHasTag(t, \"безплат\") ||\r\n            toolHasTag(t, \"freemium\")\r\n        );\r\n      } else if (f === \"trending\") {\r\n        list = list.filter(\r\n          (t) =>\r\n            toolHasTag(t, \"trending\") ||\r\n            toolHasTag(t, \"trend\") ||\r\n            toolHasTag(t, \"популяр\")\r\n        );\r\n      } else if (f === \"new\") {\r\n        list = list.filter(\r\n          (t) =>\r\n            toolHasTag(t, \"new\") ||\r\n            toolHasTag(t, \"нов\") ||\r\n            toolHasTag(t, \"ново\")\r\n        );\r\n      }\r\n    }\r\n\r\n    return list;\r\n  }, [tools, filter]);\r\n\r\n  return (\r\n    <main className=\"mx-auto max-w-7xl px-4 py-8\">\r\n      <div className=\"flex items-end justify-between gap-4\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <Link\r\n            to=\"/categories\"\r\n            className=\"inline-flex items-center gap-2 text-slate-600 hover:text-blue-600 transition-colors p-2 -ml-2 rounded-xl\"\r\n          >\r\n            <ArrowLeft className=\"w-4 h-4\" />\r\n            <span className=\"font-medium\">Назад</span>\r\n          </Link>\r\n          <div>\r\n            <h1 className=\"text-2xl md:text-3xl font-bold tracking-tight break-words\">\r\n              {cap}\r\n            </h1>\r\n            <p className=\"text-muted-foreground mt-1\">\r\n              Инструменти в тази категория. Използвай филтрите, за да прецизираш\r\n              резултатите.\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <ToggleGroup\r\n          type=\"single\"\r\n          value={filter ?? \"\"}\r\n          onValueChange={(v) => setFilter(v || null)}\r\n          className=\"bg-muted rounded-xl p-1\"\r\n        >\r\n          <ToggleGroupItem value=\"\" aria-label=\"All\">\r\n            Всички\r\n          </ToggleGroupItem>\r\n          <ToggleGroupItem value=\"free\" aria-label=\"Free\">\r\n            Безплатни\r\n          </ToggleGroupItem>\r\n          <ToggleGroupItem value=\"trending\" aria-label=\"Trending\">\r\n            Тренд\r\n          </ToggleGroupItem>\r\n          <ToggleGroupItem value=\"new\" aria-label=\"New\">\r\n            Нови\r\n          </ToggleGroupItem>\r\n        </ToggleGroup>\r\n      </div>\r\n\r\n      <Separator className=\"my-6\" />\r\n\r\n      {loading ? (\r\n        <div className=\"grid sm:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {Array.from({ length: 9 }).map((_, i) => (\r\n            <Skeleton key={i} className=\"h-40 rounded-2xl\" />\r\n          ))}\r\n        </div>\r\n      ) : error ? (\r\n        <div className=\"text-sm text-red-600 bg-red-50 border border-red-200 rounded-xl p-3\">\r\n          {error}\r\n        </div>\r\n      ) : shown.length === 0 ? (\r\n        <div className=\"text-sm text-muted-foreground\">Няма инструменти.</div>\r\n      ) : (\r\n        <div className=\"grid sm:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {shown.map((t) => (\r\n            <a\r\n              key={t.id ?? t.name}\r\n              href={t.link || \"#\"}\r\n              target=\"_blank\"\r\n              rel=\"noreferrer\"\r\n              className=\"group\"\r\n              onClick={(e) => {\r\n                if (!t.link) e.preventDefault();\r\n              }}\r\n            >\r\n              <Card className=\"rounded-2xl h-full hover:shadow-md transition\">\r\n                <CardContent className=\"pt-5\">\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <div className=\"w-10 h-10 rounded-xl bg-slate-100 flex items-center justify-center overflow-hidden shrink-0\">\r\n                      {t.icon ? (\r\n                        <img\r\n                          src={t.icon}\r\n                          alt={t.name}\r\n                          className=\"w-10 h-10 object-cover\"\r\n                          loading=\"lazy\"\r\n                          onError={(e) => {\r\n                            const img = e.currentTarget as HTMLImageElement;\r\n                            img.style.display = \"none\";\r\n                          }}\r\n                        />\r\n                      ) : (\r\n                        <span className=\"text-slate-400 text-sm\">AI</span>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"min-w-0\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <h3 className=\"font-semibold truncate\">{t.name}</h3>\r\n                        {typeof t.rating === \"number\" && (\r\n                          <Badge variant=\"secondary\">\r\n                            {t.rating.toFixed(2)}\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                      <p className=\"text-sm text-slate-600 line-clamp-2 mt-0.5\">\r\n                        {t.description || \"AI Tool\"}\r\n                      </p>\r\n                      <div className=\"mt-2 flex flex-wrap gap-1\">\r\n                        {(t.tags || []).slice(0, 4).map((tag, i) => (\r\n                          <Badge key={i} variant=\"outline\">\r\n                            {tag}\r\n                          </Badge>\r\n                        ))}\r\n                      </div>\r\n                      <div className=\"mt-3\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant={t.link ? \"default\" : \"secondary\"}\r\n                          className=\"rounded-xl\"\r\n                        >\r\n                          Отвори инструмент{\" \"}\r\n                          <ExternalLink className=\"w-4 h-4 ml-2\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </a>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </main>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}