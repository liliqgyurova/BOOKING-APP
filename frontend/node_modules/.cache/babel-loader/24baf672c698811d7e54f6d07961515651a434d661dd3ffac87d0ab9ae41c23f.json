{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\komun\\\\booking-app\\\\frontend\\\\src\\\\App.tsx\",\n  _env,\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { Search, Star, MessageCircle, Zap, Sparkles, History, X, ArrowLeft, Grid3x3, Heart, User, Menu, Wand2 } from 'lucide-react';\nimport { Button } from './components/ui/button';\nimport { Input } from './components/ui/input';\nimport { Badge } from './components/ui/badge';\nimport { Card, CardContent } from './components/ui/card';\nimport { openOAuthPopup, fetchMe, refreshSession, logout } from './auth';\nimport PlanMindMap from './components/ui/PlanMindMap';\nimport CategoryView from './pages/CategoryView';\n\n// Mapping –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç App.tsx –∏ cap –ø–∞—Ä–∞–º–µ—Ç—Ä–∏\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CATEGORY_TO_CAP_MAPPING = {\n  'assistants-productivity': 'cap:text-explain',\n  'text-writing': 'cap:text-edit',\n  'images-design': 'cap:image-generate',\n  'video-3d': 'cap:video-generate',\n  'audio-music': 'cap:voice-generate',\n  'business-marketing': 'cap:research-web',\n  'coding-development': 'cap:automate-workflow',\n  // –∏–ª–∏ —Å—ä–∑–¥–∞–π –Ω–æ–≤ cap –∑–∞ coding\n  'automation-agents': 'cap:automate-workflow',\n  'data-analysis': 'cap:slide-generate',\n  'education-learning': 'cap:doc-read-pdf',\n  // –∏–ª–∏ —Å—ä–∑–¥–∞–π –Ω–æ–≤ cap\n  'health-wellness': 'cap:integrations',\n  // –∏–ª–∏ —Å—ä–∑–¥–∞–π –Ω–æ–≤ cap  \n  'specialized-niche': 'cap:integrations'\n};\n/* ---------- API base ---------- */\nconst API_BASE = ((_env = import.meta.env) === null || _env === void 0 ? void 0 : _env.VITE_API_BASE) || window.__API_BASE__ || 'http://127.0.0.1:8000';\n\n/* ---------- Types matching backend ---------- */\n\n/* ---------- Language and Localization ---------- */\n\nconst translations = {\n  en: {\n    // Header\n    discover: 'Discover',\n    categories: 'Categories',\n    learn: 'Learn',\n    favorites: 'Favorites',\n    signIn: 'Sign In',\n    profile: 'Profile',\n    signOut: 'Sign Out',\n    // Hero\n    heroTitle: 'Discover AI tools that',\n    heroTitleHighlight: 'actually help',\n    heroSubtitle: 'From writing essays to creating art, find the perfect AI tools for your goals.',\n    inputPlaceholder: 'What do you want to achieve with AI?',\n    inputExamples: 'e.g., Write better emails, create a logo, analyze data...',\n    findTools: 'Find Tools',\n    // Recent prompts\n    recentPrompts: 'Recent prompts',\n    clearAll: 'Clear all',\n    // Status messages\n    loading: 'üîÑ Finding the best tools for you...',\n    errorGeneric: '‚ö†Ô∏è Something went wrong while fetching tools.',\n    // Search and filters\n    searchPlaceholder: 'Search tools, categories, or goals...',\n    favoritesOnly: 'Favorites only',\n    // Journey section\n    journeyTitle: 'Your AI Journey',\n    journeySubtitle: 'Interactive visualization of your personalized AI workflow',\n    // Results section\n    resultsTitle: 'AI Tools & Suggestions',\n    resultsSubtitle: 'Detailed step-by-step guide with AI assistance',\n    resultsFor: 'Results for',\n    toolsFound: 'tools',\n    savedCount: 'saved',\n    // Prompt suggestion\n    assistantSuggestion: 'AI Assistant Suggestion',\n    copyPasteReady: 'Copy & Paste Ready',\n    copy: 'Copy',\n    copied: 'Copied!',\n    promptHint: 'üí° Copy this prompt and paste it into any AI assistant (ChatGPT, Claude, etc.) for personalized guidance on this step.',\n    recommendedTools: 'recommended tools',\n    // Mind map specific\n    stepSpecificTools: 'Step-specific tools',\n    sharedToolsForStep: 'Shared tools for this step',\n    usedInXSteps: 'Used in {count} steps',\n    uniqueTools: 'unique tools',\n    sharedAcrossSteps: 'shared across steps',\n    stepsTotal: 'steps total',\n    // Tool cards\n    aiTool: 'AI Tool',\n    free: 'Free',\n    openTool: 'Open Tool',\n    noLink: 'No Link Available',\n    save: 'Save',\n    saved: 'Saved',\n    addToFavorites: 'Add to favorites',\n    removeFromFavorites: 'Remove from favorites',\n    // Empty states\n    readyTitle: 'Ready to discover AI tools?',\n    readySubtitle: 'Tell us what you want to achieve and we\\'ll find the perfect tools for you.',\n    noToolsTitle: 'No tools found',\n    noToolsSubtitle: 'Try adjusting your search or filters.',\n    // Favorites page\n    myFavorites: 'My Favorites',\n    back: 'Back',\n    noFavoritesTitle: 'No favorites yet',\n    noFavoritesSubtitle: 'Mark tools with the star to save them here for quick access.',\n    discoverTools: 'Discover Tools',\n    // Categories page\n    categoriesTitle: 'AI Tool Categories',\n    categoriesSubtitle: 'Browse our comprehensive collection of AI tools organized by purpose and functionality.',\n    searchCategories: 'Search categories...',\n    browseCategory: 'Browse Category',\n    toolsInCategory: 'tools in this category',\n    totalCategories: 'Categories',\n    totalTools: 'Total Tools',\n    // Auth\n    createAccount: 'Create account',\n    emailPassword: 'email / password',\n    signInWithGoogle: 'Sign in with Google',\n    createYourAccount: 'Create your account',\n    signInToAccount: 'Sign in to your account',\n    yourName: 'Your name (optional)',\n    email: 'Email',\n    password: 'Password',\n    alreadyHaveAccount: 'Already have an account?',\n    dontHaveAccount: 'Don\\'t have an account?',\n    cancel: 'Cancel',\n    orContinueWith: 'or continue with',\n    google: 'Google',\n    // Profile\n    yourProfile: 'Your Profile',\n    name: 'Name',\n    avatarUrl: 'Avatar URL',\n    saveChanges: 'Save changes',\n    // Mobile nav\n    home: 'Home',\n    chat: 'Chat',\n    // Errors\n    signInFailed: 'Sign in failed. Check backend/.env and CORS.',\n    signUpFailed: 'Sign up failed.',\n    profileUpdateFailed: 'Profile update failed.',\n    copyFailed: 'Copy failed. Please select and copy manually.',\n    // Execution summary\n    executionSummary: 'Execution Summary',\n    executionSummarySubtitle: 'Quick overview of your AI workflow',\n    forSteps: 'For steps',\n    forStep: 'For step',\n    useTheseTool: 'use this tool',\n    useTheseTools: 'use these tools',\n    toolRecommendation: 'Tool Recommendation'\n  },\n  bg: {\n    // Header\n    discover: '–û—Ç–∫—Ä–∏–≤–∞–Ω–µ',\n    categories: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏',\n    learn: '–ù–∞—É—á–∏',\n    favorites: '–õ—é–±–∏–º–∏',\n    signIn: '–í—Ö–æ–¥',\n    profile: '–ü—Ä–æ—Ñ–∏–ª',\n    signOut: '–ò–∑—Ö–æ–¥',\n    // Hero\n    heroTitle: '–û—Ç–∫—Ä–∏–π—Ç–µ AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∫–æ–∏—Ç–æ',\n    heroTitleHighlight: '–Ω–∞–∏—Å—Ç–∏–Ω–∞ –ø–æ–º–∞–≥–∞—Ç',\n    heroSubtitle: '–û—Ç –ø–∏—Å–∞–Ω–µ –Ω–∞ –µ—Å–µ—Ç–∞ –¥–æ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –∏–∑–∫—É—Å—Ç–≤–æ - –Ω–∞–º–µ—Ä–µ—Ç–µ –ø–µ—Ä—Ñ–µ–∫—Ç–Ω–∏—Ç–µ AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –≤–∞—à–∏—Ç–µ —Ü–µ–ª–∏.',\n    inputPlaceholder: '–ö–∞–∫–≤–æ –∏—Å–∫–∞—Ç–µ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ —Å AI?',\n    inputExamples: '–Ω–∞–ø—Ä., –ü–∏—Å–∞–Ω–µ –Ω–∞ –ø–æ-–¥–æ–±—Ä–∏ –∏–º–µ–π–ª–∏, —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –ª–æ–≥–æ, –∞–Ω–∞–ª–∏–∑ –Ω–∞ –¥–∞–Ω–Ω–∏...',\n    findTools: '–ù–∞–º–µ—Ä–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\n    // Recent prompts\n    recentPrompts: '–ü–æ—Å–ª–µ–¥–Ω–∏ –∑–∞—è–≤–∫–∏',\n    clearAll: '–ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–∏',\n    // Status messages\n    loading: 'üîÑ –¢—ä—Ä—Å–∏–º –Ω–∞–π-–¥–æ–±—Ä–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –≤–∞—Å...',\n    errorGeneric: '‚ö†Ô∏è –í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ—Ç–æ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏—Ç–µ.',\n    // Search and filters\n    searchPlaceholder: '–¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ —Ü–µ–ª–∏...',\n    favoritesOnly: '–°–∞–º–æ –ª—é–±–∏–º–∏',\n    // Journey section\n    journeyTitle: '–í–∞—à–µ—Ç–æ AI –ø—ä—Ç–µ—à–µ—Å—Ç–≤–∏–µ',\n    journeySubtitle: '–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –≤–∞—à–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω AI —Ä–∞–±–æ—Ç–µ–Ω –ø–æ—Ç–æ–∫',\n    // Results section\n    resultsTitle: 'AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è',\n    resultsSubtitle: '–ü–æ–¥—Ä–æ–±–Ω–æ —Å—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å AI –ø–æ–º–æ—â',\n    resultsFor: '–†–µ–∑—É–ª—Ç–∞—Ç–∏ –∑–∞',\n    toolsFound: '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞',\n    savedCount: '–∑–∞–ø–∞–∑–µ–Ω–∏',\n    // Prompt suggestion\n    assistantSuggestion: '–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç AI –∞—Å–∏—Å—Ç–µ–Ω—Ç',\n    copyPasteReady: '–ì–æ—Ç–æ–≤–æ –∑–∞ –∫–æ–ø–∏—Ä–∞–Ω–µ',\n    copy: '–ö–æ–ø–∏—Ä–∞–π',\n    copied: '–ö–æ–ø–∏—Ä–∞–Ω–æ!',\n    promptHint: 'üí° –ö–æ–ø–∏—Ä–∞–π—Ç–µ —Ç–æ–∑–∏ –ø—Ä–æ–º–ø—Ç –∏ –≥–æ –ø–æ—Å—Ç–∞–≤–µ—Ç–µ –≤ –Ω—è–∫–æ–π AI –∞—Å–∏—Å—Ç–µ–Ω—Ç (ChatGPT, Claude, –∏ –¥—Ä.) –∑–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–æ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∑–∞ —Ç–∞–∑–∏ —Å—Ç—ä–ø–∫–∞.',\n    recommendedTools: '–ø—Ä–µ–ø–æ—Ä—ä—á–∞–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞',\n    // Mind map specific\n    stepSpecificTools: '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ —Ç–∞–∑–∏ —Å—Ç—ä–ø–∫–∞',\n    sharedToolsForStep: '–°–ø–æ–¥–µ–ª–µ–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ —Ç–∞–∑–∏ —Å—Ç—ä–ø–∫–∞',\n    usedInXSteps: '–ò–∑–ø–æ–ª–∑–≤–∞–Ω –≤ {count} —Å—Ç—ä–ø–∫–∏',\n    uniqueTools: '—É–Ω–∏–∫–∞–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞',\n    sharedAcrossSteps: '—Å–ø–æ–¥–µ–ª–µ–Ω–∏ –º–µ–∂–¥—É —Å—Ç—ä–ø–∫–∏—Ç–µ',\n    stepsTotal: '—Å—Ç—ä–ø–∫–∏ –æ–±—â–æ',\n    // Tool cards\n    aiTool: 'AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç',\n    free: '–ë–µ–∑–ø–ª–∞—Ç–µ–Ω',\n    openTool: '–û—Ç–≤–æ—Ä–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç',\n    noLink: '–ù—è–º–∞ –Ω–∞–ª–∏—á–µ–Ω –ª–∏–Ω–∫',\n    save: '–ó–∞–ø–∞–∑–∏',\n    saved: '–ó–∞–ø–∞–∑–µ–Ω–æ',\n    addToFavorites: '–î–æ–±–∞–≤–∏ –≤ –ª—é–±–∏–º–∏',\n    removeFromFavorites: '–ü—Ä–µ–º–∞—Ö–Ω–∏ –æ—Ç –ª—é–±–∏–º–∏',\n    // Empty states\n    readyTitle: '–ì–æ—Ç–æ–≤–∏ –¥–∞ –æ—Ç–∫—Ä–∏–≤–∞–µ—Ç–µ AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏?',\n    readySubtitle: '–ö–∞–∂–µ—Ç–µ –Ω–∏ –∫–∞–∫–≤–æ –∏—Å–∫–∞—Ç–µ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ –∏ —â–µ –Ω–∞–º–µ—Ä–∏–º –ø–µ—Ä—Ñ–µ–∫—Ç–Ω–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –≤–∞—Å.',\n    noToolsTitle: '–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\n    noToolsSubtitle: '–û–ø–∏—Ç–∞–π—Ç–µ –¥–∞ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ —Ç—ä—Ä—Å–µ–Ω–µ—Ç–æ –∏–ª–∏ —Ñ–∏–ª—Ç—Ä–∏—Ç–µ.',\n    // Favorites page\n    myFavorites: '–ú–æ–∏—Ç–µ –ª—é–±–∏–º–∏',\n    back: '–ù–∞–∑–∞–¥',\n    noFavoritesTitle: '–û—â–µ –Ω—è–º–∞ –ª—é–±–∏–º–∏',\n    noFavoritesSubtitle: '–ú–∞—Ä–∫–∏—Ä–∞–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Å—ä—Å –∑–≤–µ–∑–¥–∏—á–∫–∞—Ç–∞, –∑–∞ –¥–∞ –≥–∏ –∑–∞–ø–∞–∑–∏—Ç–µ —Ç—É–∫ –∑–∞ –±—ä—Ä–∑ –¥–æ—Å—Ç—ä–ø.',\n    discoverTools: '–û—Ç–∫—Ä–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\n    // Categories page\n    categoriesTitle: 'AI –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\n    categoriesSubtitle: '–†–∞–∑–≥–ª–µ–¥–∞–π—Ç–µ –Ω–∞—à–∞—Ç–∞ –æ–±—à–∏—Ä–Ω–∞ –∫–æ–ª–µ–∫—Ü–∏—è –æ—Ç AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –æ—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–Ω–∏ –ø–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç.',\n    searchCategories: '–¢—ä—Ä—Å–µ–Ω–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...',\n    browseCategory: '–†–∞–∑–≥–ª–µ–¥–∞–π –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\n    toolsInCategory: '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤ —Ç–∞–∑–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\n    totalCategories: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏',\n    totalTools: '–û–±—â–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\n    // Auth\n    createAccount: '–°—ä–∑–¥–∞–π –ø—Ä–æ—Ñ–∏–ª',\n    emailPassword: '–∏–º–µ–π–ª / –ø–∞—Ä–æ–ª–∞',\n    signInWithGoogle: '–í—Ö–æ–¥ —Å Google',\n    createYourAccount: '–°—ä–∑–¥–∞–π—Ç–µ –≤–∞—à–∏—è –ø—Ä–æ—Ñ–∏–ª',\n    signInToAccount: '–í–ª–µ–∑—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª–∞ —Å–∏',\n    yourName: '–í–∞—à–µ—Ç–æ –∏–º–µ (–ø–æ –∏–∑–±–æ—Ä)',\n    email: '–ò–º–µ–π–ª',\n    password: '–ü–∞—Ä–æ–ª–∞',\n    alreadyHaveAccount: '–í–µ—á–µ –∏–º–∞—Ç–µ –ø—Ä–æ—Ñ–∏–ª?',\n    dontHaveAccount: '–ù—è–º–∞—Ç–µ –ø—Ä–æ—Ñ–∏–ª?',\n    cancel: '–û—Ç–∫–∞–∑',\n    orContinueWith: '–∏–ª–∏ –ø—Ä–æ–¥—ä–ª–∂–µ—Ç–µ —Å',\n    google: 'Google',\n    // Profile\n    yourProfile: '–í–∞—à–∏—è—Ç –ø—Ä–æ—Ñ–∏–ª',\n    name: '–ò–º–µ',\n    avatarUrl: 'URL –Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞',\n    saveChanges: '–ó–∞–ø–∞–∑–∏ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ',\n    // Mobile nav\n    home: '–ù–∞—á–∞–ª–æ',\n    chat: '–ß–∞—Ç',\n    // Errors\n    signInFailed: '–ù–µ—É—Å–ø–µ—à–µ–Ω –≤—Ö–æ–¥. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ backend/.env –∏ CORS.',\n    signUpFailed: '–ù–µ—É—Å–ø–µ—à–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è.',\n    profileUpdateFailed: '–ù–µ—É—Å–ø–µ—à–Ω–æ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞.',\n    copyFailed: '–ù–µ—É—Å–ø–µ—à–Ω–æ –∫–æ–ø–∏—Ä–∞–Ω–µ. –ú–æ–ª—è, —Å–µ–ª–µ–∫—Ç–∏—Ä–∞–π—Ç–µ –∏ –∫–æ–ø–∏—Ä–∞–π—Ç–µ —Ä—ä—á–Ω–æ.',\n    // Execution summary\n    executionSummary: '–ò–∑–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω –ø—Ä–µ–≥–ª–µ–¥',\n    executionSummarySubtitle: '–ë—ä—Ä–∑ –ø—Ä–µ–≥–ª–µ–¥ –Ω–∞ –≤–∞—à–∏—è AI —Ä–∞–±–æ—Ç–µ–Ω –ø–æ—Ç–æ–∫',\n    forSteps: '–ó–∞ —Å—Ç—ä–ø–∫–∏',\n    forStep: '–ó–∞ —Å—Ç—ä–ø–∫–∞',\n    useTheseTool: '–∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Ç–æ–∑–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç',\n    useTheseTools: '–∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Ç–µ–∑–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\n    toolRecommendation: '–ü—Ä–µ–ø–æ—Ä—ä–∫–∞ –∑–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏'\n  }\n};\n\n// Language detection function\nfunction detectLanguage(text) {\n  if (!text || text.trim().length < 3) return 'en';\n\n  // Bulgarian characters detection\n  const bulgarianChars = /[–∞-—è]/gi;\n  const bulgarianMatches = text.match(bulgarianChars);\n  const bulgarianRatio = bulgarianMatches ? bulgarianMatches.length / text.length : 0;\n\n  // If more than 20% of characters are Cyrillic, consider it Bulgarian\n  return bulgarianRatio > 0.2 ? 'bg' : 'en';\n}\n\n/* ---------- Favorites v2 (persist full tool) ---------- */\n\nconst FAVS_V2_KEY = 'myai:favs_v2';\nconst FAVS_V1_KEY = 'myai:favs';\n\n/* ---------- Recent prompts ---------- */\nconst RECENT_KEY = 'myai:recent_prompts';\nconst RECENT_MAX = 6;\n\n/* ---------- Language preference ---------- */\nconst LANGUAGE_KEY = 'myai:language';\n\n/* ---------- Helpers ---------- */\nfunction groupsFromPlanFallback(plan) {\n  const byTitle = new Map();\n  for (const p of plan) {\n    var _byTitle$get;\n    const title = p.task;\n    const bucket = (_byTitle$get = byTitle.get(title)) !== null && _byTitle$get !== void 0 ? _byTitle$get : new Map();\n    for (const t of p.tools) bucket.set(t.name, t);\n    byTitle.set(title, bucket);\n  }\n  return Array.from(byTitle.entries()).map(([title, bucket]) => ({\n    title,\n    tools: Array.from(bucket.values())\n  }));\n}\n\n// Enhanced suggested prompt builder with language support\n// Enhanced suggested prompt builder with language support and step-specific context\n// Direct actionable prompt builder that creates copy-paste ready prompts\nfunction buildStepPrompt(goal, stepTitle, tools, language) {\n  const isBg = language === 'bg';\n\n  // Normalize goal and step for analysis\n  const stepLower = stepTitle.toLowerCase();\n  const goalLower = goal.toLowerCase();\n\n  // Create placeholder for user's specific context\n  const goalPlaceholder = goal || (isBg ? '[–≤–∞—à–∞—Ç–∞ —Ü–µ–ª/–ø—Ä–æ–¥—É–∫—Ç/—É—Å–ª—É–≥–∞]' : '[your goal/product/service]');\n\n  // Generate specific, actionable prompts based on step content\n  let actionablePrompt = '';\n\n  // Research steps\n  if (stepLower.includes('–∏–∑—Å–ª–µ–¥–≤') || stepLower.includes('–ø—Ä–æ—É—á') || stepLower.includes('research') || stepLower.includes('–∞–Ω–∞–ª–∏–∑') || stepLower.includes('analyze') || stepLower.includes('–∞—É–¥–∏—Ç–æ—Ä–∏—è')) {\n    if (stepLower.includes('–∞—É–¥–∏—Ç–æ—Ä–∏—è') || stepLower.includes('audience') || stepLower.includes('–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç') || stepLower.includes('competitor')) {\n      actionablePrompt = isBg ? `–ù–∞–ø—Ä–∞–≤–∏ –ø–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ—É—á–≤–∞–Ω–µ –Ω–∞ —Ü–µ–ª–µ–≤–∞—Ç–∞ –∞—É–¥–∏—Ç–æ—Ä–∏—è –∑–∞ ${goalPlaceholder}, –∫–∞—Ç–æ –≤–∫–ª—é—á–∏—à –¥–µ–º–æ–≥—Ä–∞—Ñ—Å–∫–∏ –¥–∞–Ω–Ω–∏, –ø—Å–∏—Ö–æ–≥—Ä–∞—Ñ—Å–∫–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏ –º–æ–¥–µ–ª–∏ –∏ –æ—Å–Ω–æ–≤–Ω–∏ –±–æ–ª–∫–∏/–∂–µ–ª–∞–Ω–∏—è. –°–ª–µ–¥ —Ç–æ–≤–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∏—Ç–µ (–º–µ—Å—Ç–Ω–∏ –∏ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∏), –æ–ø–∏—à–∏ —Ç–µ—Ö–Ω–∏—Ç–µ —Å–∏–ª–Ω–∏ –∏ —Å–ª–∞–±–∏ —Å—Ç—Ä–∞–Ω–∏, —Ü–µ–Ω–æ–≤–∞ –ø–æ–ª–∏—Ç–∏–∫–∞, –∫–∞–Ω–∞–ª–∏ –∑–∞ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—è –∏ —É–Ω–∏–∫–∞–ª–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ. –ó–∞–≤—ä—Ä—à–∏ —Å –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∫–∞–∫ –º–æ—è—Ç –±–∏–∑–Ω–µ—Å –º–æ–∂–µ –¥–∞ —Å–µ –æ—Ç–ª–∏—á–∏.` : `Conduct detailed research on the target audience for ${goalPlaceholder}, including demographic data, psychographic characteristics, behavioral patterns, and main pain points/desires. Then analyze competitors (local and international), describe their strengths and weaknesses, pricing policy, communication channels, and unique value proposition. End with recommendations on how my business can differentiate itself.`;\n    } else if (stepLower.includes('–ø–∞–∑–∞—Ä') || stepLower.includes('market') || stepLower.includes('—Ç–µ–Ω–¥–µ–Ω') || stepLower.includes('trend')) {\n      actionablePrompt = isBg ? `–ê–Ω–∞–ª–∏–∑–∏—Ä–∞–π –ø–∞–∑–∞—Ä–Ω–∏—Ç–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞ ${goalPlaceholder}. –ü—Ä–æ—É—á–∏ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –ø–∞–∑–∞—Ä–∞, —Ç–µ–º–ø–æ–≤–µ—Ç–µ –Ω–∞ —Ä–∞—Å—Ç–µ–∂, –∫–ª—é—á–æ–≤–∏—Ç–µ –∏–≥—Ä–∞—á–∏, —Ä–µ–≥—É–ª–∞—Ç–æ—Ä–Ω–∏—Ç–µ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω–∏—Ç–µ –ø—Ä–æ–º–µ–Ω–∏. –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–π –Ω–∏—à–æ–≤–∏ —Å–µ–≥–º–µ–Ω—Ç–∏, –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏ –Ω—É–∂–¥–∏ –∏ –±—ä–¥–µ—â–∏ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –¥–∞–Ω–Ω–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –∏–∑—Ç–æ—á–Ω–∏—Ü–∏, –∏ –∑–∞–≤—ä—Ä—à–∏ —Å –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –ø–∞–∑–∞—Ä–Ω–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–∞–Ω–µ.` : `Analyze market trends and opportunities for ${goalPlaceholder}. Research market size, growth rates, key players, regulatory requirements, and technological changes. Identify niche segments, unmet needs, and future opportunities. Provide specific data, statistics, and sources, and conclude with market positioning recommendations.`;\n    } else {\n      actionablePrompt = isBg ? `–ü—Ä–æ–≤–µ–¥–∏ –∑–∞–¥—ä–ª–±–æ—á–µ–Ω–æ –∏–∑—Å–ª–µ–¥–≤–∞–Ω–µ –∑–∞ ${goalPlaceholder}. –°—ä–±–µ—Ä–∏ –∞–∫—Ç—É–∞–ª–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç –Ω–∞–¥–µ–∂–¥–Ω–∏ sources, –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–π –Ω–∞–π-–¥–æ–±—Ä–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏—è—Ç–∞, –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–π –∫–ª—é—á–æ–≤–∏—Ç–µ —É—Å–ø–µ—à–Ω–∏ —Ñ–∞–∫—Ç–æ—Ä–∏ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏—Ç–µ —Ä–∏—Å–∫–æ–≤–µ. –°—ä–∑–¥–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω –¥–æ–∫–ª–∞–¥ —Å –æ—Å–Ω–æ–≤–Ω–∏ –Ω–∞—Ö–æ–¥–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ —Å–ª–µ–¥–≤–∞—â–∏ —Å—Ç—ä–ø–∫–∏.` : `Conduct in-depth research on ${goalPlaceholder}. Gather current information from reliable sources, analyze industry best practices, identify key success factors and potential risks. Create a structured report with key findings, statistics, and recommendations for next steps.`;\n    }\n  }\n\n  // Creative/Design steps\n  else if (stepLower.includes('—Å—ä–∑–¥–∞') || stepLower.includes('–≥–µ–Ω–µ—Ä–∏—Ä') || stepLower.includes('create') || stepLower.includes('–¥–∏–∑–∞–π–Ω') || stepLower.includes('design') || stepLower.includes('–∫–æ–Ω—Ü–µ–ø—Ü') || stepLower.includes('concept')) {\n    if (stepLower.includes('–ª–æ–≥–æ') || stepLower.includes('logo') || stepLower.includes('–±—Ä–∞–Ω–¥') || stepLower.includes('brand')) {\n      actionablePrompt = isBg ? `–°—ä–∑–¥–∞–π –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –∑–∞ –ª–æ–≥–æ –∏ –≤–∏–∑—É–∞–ª–Ω–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç –∑–∞ ${goalPlaceholder}. –û–ø–∏—à–∏ 3-5 —Ä–∞–∑–ª–∏—á–Ω–∏ –¥–∏–∑–∞–π–Ω–µ—Ä—Å–∫–∏ –ø–æ—Å–æ–∫–∏, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ —Ü–≤–µ—Ç–æ–≤–∞ –ø–∞–ª–∏—Ç—Ä–∞, —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏—è, —Å—Ç–∏–ª –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ. –ó–∞ –≤—Å—è–∫–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –æ–±—è—Å–Ω–∏ —Å–∏–º–≤–æ–ª–∏–∫–∞—Ç–∞, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ—Ç–æ –≤—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∫–∞–∫ –æ—Ç—Ä–∞–∑—è–≤–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ –±—Ä–∞–Ω–¥–∞. –î–æ–±–∞–≤–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ –Ω–æ—Å–∏—Ç–µ–ª–∏ (—É–µ–±, –ø–µ—á–∞—Ç, —Å–æ—Ü–∏–∞–ª–Ω–∏ –º—Ä–µ–∂–∏) –∏ —Ñ–∞–π–ª–æ–≤–∏ —Ñ–æ—Ä–º–∞—Ç–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ.` : `Create a logo and visual identity concept for ${goalPlaceholder}. Describe 3-5 different design directions, including color palette, typography, style, and mood. For each concept, explain the symbolism, psychological impact, and how it reflects the brand values. Add recommendations for application across different media (web, print, social media) and file formats for execution.`;\n    } else if (stepLower.includes('–∫–æ–Ω—Ç–µ–Ω—Ç') || stepLower.includes('content') || stepLower.includes('–º–∞—Ç–µ—Ä–∏–∞–ª') || stepLower.includes('–∫–∞–º–ø–∞–Ω') || stepLower.includes('campaign')) {\n      actionablePrompt = isBg ? `–°—ä–∑–¥–∞–π –Ω–∞–±–æ—Ä –æ—Ç –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∏ –∑–∞ ${goalPlaceholder}, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ: —Å–ª–æ–≥–∞–Ω, –∫–ª—é—á–æ–≤–∏ –ø–æ—Å–ª–∞–Ω–∏—è, —Ç–µ–∫—Å—Ç–æ–≤–µ –∑–∞ —Å–æ—Ü–∏–∞–ª–Ω–∏ –º—Ä–µ–∂–∏, –∏–º–µ–π–ª –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –∫—Ä–∞—Ç–∫–æ –≤–∏–¥–µ–æ-—Å—Ü–µ–Ω–∞—Ä–∏–π. –ú–∞—Ç–µ—Ä–∏–∞–ª–∏—Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–∞ —Å—ä–æ–±—Ä–∞–∑–µ–Ω–∏ —Å —Ü–µ–ª–µ–≤–∞—Ç–∞ –∞—É–¥–∏—Ç–æ—Ä–∏—è, –¥–∞ –ø–æ–¥—á–µ—Ä—Ç–∞–≤–∞—Ç —É–Ω–∏–∫–∞–ª–Ω–æ—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏ –¥–∞ –ø—Ä–µ–¥–∏–∑–≤–∏–∫–≤–∞—Ç –µ–º–æ—Ü–∏—è –∏ –∞–Ω–≥–∞–∂–∏—Ä–∞–Ω–æ—Å—Ç. –î–∞–π –º–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∑–∞ —Ä–µ–∫–ª–∞–º–Ω–∏ –∫–∞–º–ø–∞–Ω–∏–∏ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∫–∞–Ω–∞–ª–∏ (Facebook, Instagram, Google Ads, TikTok –∏ –¥—Ä.), –±—é–¥–∂–µ—Ç–∏ –∏ –æ—á–∞–∫–≤–∞–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏.` : `Create a set of marketing materials for ${goalPlaceholder}, including: slogan, key messages, social media copy, email campaigns, and a short video script. Materials should be tailored to the target audience, highlight the unique value proposition, and evoke emotion and engagement. Also provide advertising campaign suggestions with specific channels (Facebook, Instagram, Google Ads, TikTok, etc.), budgets, and expected results.`;\n    } else {\n      actionablePrompt = isBg ? `–†–∞–∑—Ä–∞–±–æ—Ç–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –∑–∞ ${goalPlaceholder}. –°—ä–∑–¥–∞–π 3 —Ä–∞–∑–ª–∏—á–Ω–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –≤–∏–∑—É–∞–ª–Ω–∏—Ç–µ –µ–ª–µ–º–µ–Ω—Ç–∏, —Ü–≤–µ—Ç–æ–≤–∞ —Å—Ö–µ–º–∞, —Å—Ç–∏–ª –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ. –ó–∞ –≤—Å–µ–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç –æ–±—è—Å–Ω–∏ —Ü–µ–ª–µ–≤–∞—Ç–∞ –∞—É–¥–∏—Ç–æ—Ä–∏—è, –∫–ª—é—á–æ–≤–∏—Ç–µ —Å—ä–æ–±—â–µ–Ω–∏—è –∏ –æ—á–∞–∫–≤–∞–Ω–æ—Ç–æ –≤—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ. –í–∫–ª—é—á–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∏ –∏ –≤—Ä–µ–º–µ –∑–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è.` : `Develop a creative concept for ${goalPlaceholder}. Create 3 different variants with detailed description of visual elements, color scheme, style, and mood. For each variant, explain the target audience, key messages, and expected impact. Include specific implementation recommendations, required resources, and timeline for execution.`;\n    }\n  }\n\n  // Strategy/Planning steps\n  else if (stepLower.includes('–ø–ª–∞–Ω') || stepLower.includes('—Å—Ç—Ä–∞—Ç–µ–≥') || stepLower.includes('plan') || stepLower.includes('strategy') || stepLower.includes('–æ—Ä–≥–∞–Ω–∏') || stepLower.includes('organize')) {\n    actionablePrompt = isBg ? `–°—ä–∑–¥–∞–π –¥–µ—Ç–∞–π–ª–µ–Ω —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏ –ø–ª–∞–Ω –∑–∞ ${goalPlaceholder}. –í–∫–ª—é—á–∏: –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ —Ü–µ–ª–∏ —Å –≤—Ä–µ–º–µ–≤–∏ —Ä–∞–º–∫–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∏ –∏ –±—é–¥–∂–µ—Ç, –∫–ª—é—á–æ–≤–∏ –¥–µ–π—Å—Ç–≤–∏—è –∏ –º–∏–ª–µ—Å—Ç—ä–Ω–∏, –æ—Ç–≥–æ–≤–æ—Ä–Ω–∏ –ª–∏—Ü–∞/—Ä–æ–ª–∏, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ —Ä–∏—Å–∫–æ–≤–µ –∏ –º–µ—Ä–∫–∏ –∑–∞ —Ç—è—Ö–Ω–æ—Ç–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–∞–Ω–µ. –î–æ–±–∞–≤–∏ KPI –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ –∏–∑–º–µ—Ä–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å–∞ –∏ –ø–ª–∞–Ω –∑–∞ —Ä–µ–¥–æ–≤–Ω–æ —Ä–µ–≤—é –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ç–∞.` : `Create a detailed strategic plan for ${goalPlaceholder}. Include: specific goals with timelines, required resources and budget, key activities and milestones, responsible persons/roles, potential risks and mitigation measures. Add KPI metrics for measuring progress and a plan for regular review and strategy updates.`;\n  }\n\n  // Implementation/Execution steps\n  else if (stepLower.includes('–∏–∑–ø—ä–ª–Ω') || stepLower.includes('—Ä–µ–∞–ª–∏–∑') || stepLower.includes('implement') || stepLower.includes('execute') || stepLower.includes('build') || stepLower.includes('develop')) {\n    actionablePrompt = isBg ? `–°—ä–∑–¥–∞–π –ø–æ–¥—Ä–æ–±–µ–Ω –ø–ª–∞–Ω –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω–∞ ${goalPlaceholder}. –†–∞–∑–±–∏–π –ø—Ä–æ—Ü–µ—Å–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∑–∞–¥–∞—á–∏ —Å—ä—Å —Å—Ä–æ–∫–æ–≤–µ, –¥–µ—Ñ–∏–Ω–∏—Ä–∞–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏—Ç–µ —Ä–µ—Å—É—Ä—Å–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Å—ä–∑–¥–∞–π –≤—Ä–µ–º–µ–≤–∞ –ª–∏–Ω–∏—è —Å –∫—Ä–∏—Ç–∏—á–Ω–∏ –º–æ–º–µ–Ω—Ç–∏. –í–∫–ª—é—á–∏ –∫–æ–Ω—Ç—Ä–æ–ª–Ω–∏ —Ç–æ—á–∫–∏ –∑–∞ –∫–∞—á–µ—Å—Ç–≤–æ, –≤—ä–∑–º–æ–∂–Ω–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –∏ –∞–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏ —Ä–µ—à–µ–Ω–∏—è. –î–æ–±–∞–≤–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –µ–∫–∏–ø, –±—é–¥–∂–µ—Ç –∏ –º–µ—Ç–æ–¥–∏ –∑–∞ –ø—Ä–æ—Å–ª–µ–¥—è–≤–∞–Ω–µ –Ω–∞ –Ω–∞–ø—Ä–µ–¥—ä–∫–∞.` : `Create a detailed execution plan for ${goalPlaceholder}. Break down the process into specific tasks with deadlines, define required resources and tools, create a timeline with critical moments. Include quality checkpoints, possible obstacles, and alternative solutions. Add recommendations for team, budget, and progress tracking methods.`;\n  }\n\n  // Testing/Validation steps\n  else if (stepLower.includes('—Ç–µ—Å—Ç') || stepLower.includes('–ø—Ä–æ–≤–µ—Ä') || stepLower.includes('test') || stepLower.includes('validate') || stepLower.includes('–æ—Ü–µ–Ω–∫') || stepLower.includes('evaluate')) {\n    actionablePrompt = isBg ? `–°—ä–∑–¥–∞–π –ø–ª–∞–Ω –∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ ${goalPlaceholder}. –î–µ—Ñ–∏–Ω–∏—Ä–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞ —É—Å–ø–µ—Ö, –º–µ—Ç–æ–¥–∏ –∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ (A/B —Ç–µ—Å—Ç–æ–≤–µ, –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –∏–Ω—Ç–µ—Ä–≤—é—Ç–∞, –ø–∏–ª–æ—Ç–Ω–∏ –ø—Ä–æ–≥—Ä–∞–º–∏), –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏. –û–ø–∏—à–∏ –∫–∞–∫ –¥–∞ —Å—ä–±–∏—Ä–∞—à –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞—à –æ–±—Ä–∞—Ç–Ω–∞—Ç–∞ –≤—Ä—ä–∑–∫–∞, –∫–∞–∫ –¥–∞ –∏—Ç–µ—Ä–∏—Ä–∞—à –±–∞–∑–∏—Ä–∞–Ω–æ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ –∏ –∫–∞–∫–≤–∏ –∫–æ—Ä–µ–∫—Ü–∏–∏ –¥–∞ –ø—Ä–∞–≤–∏—à –ø—Ä–µ–¥–∏ —Ñ–∏–Ω–∞–ª–Ω–æ—Ç–æ –ø—É—Å–∫–∞–Ω–µ.` : `Create a testing and validation plan for ${goalPlaceholder}. Define specific success criteria, testing methods (A/B tests, user interviews, pilot programs), required tools and metrics. Describe how to collect and analyze feedback, how to iterate based on results, and what corrections to make before final launch.`;\n  }\n\n  // Launch/Finalization steps\n  else if (stepLower.includes('–ø—É—Å–∫–∞') || stepLower.includes('–ª–∞–Ω—Å–∏—Ä') || stepLower.includes('launch') || stepLower.includes('—Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä') || stepLower.includes('–∑–∞–≤—ä—Ä—à') || stepLower.includes('complete') || stepLower.includes('–ø—É–±–ª–∏–∫') || stepLower.includes('publish')) {\n    actionablePrompt = isBg ? `–ù–∞–ø—Ä–∞–≤–∏ –ø–ª–∞–Ω –∑–∞ –ª–∞–Ω—Å–∏—Ä–∞–Ω–µ –Ω–∞ ${goalPlaceholder}, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –≤—Ä–µ–º–µ–≤–∞ –ª–∏–Ω–∏—è, —Å—Ç—ä–ø–∫–∏ –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞, —Å—ä–¥—ä—Ä–∂–∞—Ç–µ–ª–µ–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä –∑–∞ —Å–æ—Ü–∏–∞–ª–Ω–∏—Ç–µ –º—Ä–µ–∂–∏, PR —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∏ –≤—ä–∑–º–æ–∂–Ω–∏ –ø–∞—Ä—Ç–Ω—å–æ—Ä—Å—Ç–≤–∞/–∏–Ω—Ñ–ª—É–µ–Ω—Å—ä—Ä–∏. –û–ø–∏—à–∏ –∫–∞–∫ –¥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–∞–º–µ –æ–Ω–ª–∞–π–Ω –∏ –æ—Ñ–ª–∞–π–Ω –¥–µ–π–Ω–æ—Å—Ç–∏—Ç–µ, –∫–∞–∫ –¥–∞ –∏–∑–≥—Ä–∞–¥—è –æ—á–∞–∫–≤–∞–Ω–µ –ø—Ä–µ–¥–∏ –ª–∞–Ω—Å–∏—Ä–∞–Ω–µ—Ç–æ –∏ –∫–∞–∫ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ –≤–∏–¥–∏–º–æ—Å—Ç –≤ –ø—ä—Ä–≤–∏—Ç–µ 30 –¥–Ω–∏.` : `Create a launch plan for ${goalPlaceholder}, including timeline, preparation steps, social media content calendar, PR strategy, and potential partnerships/influencers. Describe how to synchronize online and offline activities, how to build anticipation before launch, and how to achieve maximum visibility in the first 30 days.`;\n  }\n\n  // Monitoring/Optimization steps\n  else if (stepLower.includes('–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥') || stepLower.includes('—Å–ª–µ–¥–µ–Ω') || stepLower.includes('monitor') || stepLower.includes('–∞–Ω–∞–ª–∏–∑') || stepLower.includes('–ø–æ–¥–æ–±—Ä') || stepLower.includes('optimize') || stepLower.includes('—Ä–µ–∑—É–ª—Ç–∞—Ç') || stepLower.includes('result')) {\n    actionablePrompt = isBg ? `–ü—Ä–µ–¥–ª–æ–∂–∏ —Å–∏—Å—Ç–µ–º–∞ –∑–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ –æ—Ç ${goalPlaceholder}. –û–ø–∏—à–∏ –∫–æ–∏ KPI –¥–∞ —Å–ª–µ–¥—è (—Ç—Ä–∞—Ñ–∏–∫, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, CAC, ROI, –∞–Ω–≥–∞–∂–∏—Ä–∞–Ω–æ—Å—Ç, –æ—Ç–∑–∏–≤–∏), –∫–∞–∫–≤–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º (Google Analytics, Meta Ads Manager, CRM –∏ –¥—Ä.), –∫–∞–∫ –¥–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–º –¥–∞–Ω–Ω–∏—Ç–µ –∏ –∫–∞–∫–≤–∏ —Å—Ç—ä–ø–∫–∏ –∑–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–≥–∞ –¥–∞ –ø—Ä–µ–¥–ø—Ä–∏–µ–º–∞–º. –î–æ–±–∞–≤–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∏–¥–µ–∏ –∑–∞ A/B —Ç–µ—Å—Ç–æ–≤–µ, –∑–∞ –¥–∞ –ø–æ–¥–æ–±—Ä—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—Ç–∞.` : `Suggest a system for monitoring results from ${goalPlaceholder}. Describe which KPIs to track (traffic, conversions, CAC, ROI, engagement, reviews), what tools to use (Google Analytics, Meta Ads Manager, CRM, etc.), how to analyze data, and what optimization steps I can take. Also add specific A/B test ideas to improve effectiveness.`;\n  }\n\n  // Generic fallback\n  else {\n    actionablePrompt = isBg ? `–°—ä–∑–¥–∞–π –¥–µ—Ç–∞–π–ª–µ–Ω –ø–ª–∞–Ω –∑–∞ \"${stepTitle}\" –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ ${goalPlaceholder}. –í–∫–ª—é—á–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ —Å—Ç—ä–ø–∫–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –≤—Ä–µ–º–µ–≤–∏ —Ä–∞–º–∫–∏, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ –ø—Ä–µ–¥–∏–∑–≤–∏–∫–∞—Ç–µ–ª—Å—Ç–≤–∞ –∏ –∫–∞–∫ –¥–∞ –≥–∏ –ø—Ä–µ–æ–¥–æ–ª–µ–µ–º. –î–æ–±–∞–≤–∏ –∏–∑–º–µ—Ä–∏–º–∏ —Ü–µ–ª–∏, –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞ —É—Å–ø–µ—Ö –∏ –ø–ª–∞–Ω –∑–∞ –ø—Ä–æ—Å–ª–µ–¥—è–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å–∞.` : `Create a detailed plan for \"${stepTitle}\" in the context of ${goalPlaceholder}. Include specific execution steps, required resources and tools, timelines, potential challenges and how to overcome them. Add measurable goals, success criteria, and a progress tracking plan.`;\n  }\n\n  // Add tool-specific guidance if tools are available\n  if (tools.length > 0) {\n    const toolNames = tools.map(t => t.name).join(', ');\n    const toolGuidance = isBg ? `\\n\\n–ü—Ä–∏ —Ä–∞–±–æ—Ç–∞—Ç–∞ –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–ª–µ–¥–Ω–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏: ${toolNames}. –ó–∞ –≤—Å–µ–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ–±—è—Å–Ω–∏ –∫–∞–∫ —Ç–æ—á–Ω–æ –¥–∞ –≥–æ –∏–∑–ø–æ–ª–∑–≤–∞–º –∑–∞ —Ç–∞–∑–∏ –∑–∞–¥–∞—á–∞, –∫–∞–∫–≤–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∞ –Ω–∞–π-–ø–æ–ª–µ–∑–Ω–∏ –∏ –∫–∞–∫ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–∞ –Ω–∞–π-–¥–æ–±—Ä–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏.` : `\\n\\nUse these tools in your work: ${toolNames}. For each tool, explain exactly how to use it for this task, which features are most useful, and how to achieve the best results.`;\n    actionablePrompt += toolGuidance;\n  }\n  return actionablePrompt;\n}\n\n// read a cookie by name (for XSRF)\nfunction getCookie(name) {\n  const parts = document.cookie ? document.cookie.split('; ') : [];\n  for (const part of parts) {\n    const eq = part.indexOf('=');\n    const key = decodeURIComponent(eq > -1 ? part.slice(0, eq) : part);\n    if (key === name) {\n      const val = eq > -1 ? part.slice(eq + 1) : '';\n      return decodeURIComponent(val);\n    }\n  }\n  return null;\n}\n\n/* ---------- Simple hash router ---------- */\n\nfunction getViewFromHash() {\n  if (window.location.hash === '#/favorites') return 'favorites';\n  if (window.location.hash === '#/categories') return 'categories';\n  if (window.location.hash.startsWith('#/categories/')) return 'category';\n  return 'home';\n}\nfunction CategoryViewWrapper() {\n  const hash = window.location.hash;\n  let cap = '';\n  if (hash.startsWith('#/categories/')) {\n    const pathPart = hash.substring('#/categories/'.length);\n    cap = decodeURIComponent(pathPart);\n  }\n  return /*#__PURE__*/_jsxDEV(CategoryView, {\n    cap: cap\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 503,\n    columnNumber: 10\n  }, this);\n}\n_c = CategoryViewWrapper;\nfunction goFavorites() {\n  if (window.location.hash !== '#/favorites') window.location.hash = '#/favorites';\n}\nfunction goCategories() {\n  if (window.location.hash !== '#/categories') window.location.hash = '#/categories';\n}\nexport default function App() {\n  _s2();\n  var _s = $RefreshSig$();\n  const [view, setView] = useState(getViewFromHash());\n  const [activeTab, setActiveTab] = useState('Home');\n  const [language, setLanguage] = useState('en');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [chatInput, setChatInput] = useState('');\n  const [groups, setGroups] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [currentUser, setCurrentUser] = useState(null);\n\n  // >>> store last goal for visual plan + prompts\n  const [lastGoal, setLastGoal] = useState('');\n\n  // dropdowns\n  const [signinOpen, setSigninOpen] = useState(false);\n  const signinRef = useRef(null);\n  const [profileOpen, setProfileOpen] = useState(false);\n  const profileRef = useRef(null);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  // Email modal\n  const [showEmailModal, setShowEmailModal] = useState(false);\n  const [authMode, setAuthMode] = useState('signup');\n  const [authEmail, setAuthEmail] = useState('');\n  const [authPassword, setAuthPassword] = useState('');\n  const [authName, setAuthName] = useState('');\n  const [authSubmitting, setAuthSubmitting] = useState(false);\n  const [authError, setAuthError] = useState(null);\n\n  // Profile modal\n  const [showProfileModal, setShowProfileModal] = useState(false);\n  const [profName, setProfName] = useState('');\n  const [profPic, setProfPic] = useState('');\n  const [profSaving, setProfSaving] = useState(false);\n\n  // Favorites v2 (map by name)\n  const [favs, setFavs] = useState(new Map());\n  const [showFavsOnly, setShowFavsOnly] = useState(false);\n\n  // Recent prompts\n  const [recents, setRecents] = useState([]);\n\n  // Get translation function (memoized to prevent re-renders)\n  const t = useCallback(key => translations[language][key], [language]);\n\n  // Memoize the onOpenTool callback to prevent re-renders\n  const handleOpenTool = useCallback(tool => {\n    if (tool.link) {\n      window.open(tool.link, '_blank', 'noreferrer,noopener');\n    }\n  }, []);\n\n  // Memoize the buildPrompt callback to prevent re-renders\n  const buildPromptCallback = useCallback(({\n    goal,\n    stepTitle,\n    tools\n  }) => buildStepPrompt(goal, stepTitle, tools, language), [language]);\n\n  // –ü–û–î–û–ë–†–ï–ù–ê goHome —Ñ—É–Ω–∫—Ü–∏—è\n  const goHome = useCallback(() => {\n    console.log('goHome called');\n    window.location.hash = '#/';\n    setView('home');\n\n    // –ò–∑—á–∏—Å—Ç–≤–∞–Ω–µ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –ø—Ä–∏ –Ω—É–∂–¥–∞\n    setGroups([]);\n    setLastGoal('');\n    setError(null);\n\n    // –°–∫—Ä–æ–ª–∏—Ä–∞–Ω–µ –¥–æ top\n    setTimeout(() => {\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    }, 100);\n  }, []);\n\n  // ---- –ü–û–î–û–ë–†–ï–ù hash router listener ----\n  useEffect(() => {\n    const onHash = () => {\n      const newView = getViewFromHash();\n      console.log('Hash changed to:', window.location.hash, 'setting view to:', newView);\n      setView(newView);\n    };\n\n    // –ò–∑–ø—ä–ª–Ω–∏ –≤–µ–¥–Ω—ä–∂ –ø—Ä–∏ mount\n    onHash();\n    window.addEventListener('hashchange', onHash);\n    return () => window.removeEventListener('hashchange', onHash);\n  }, []);\n\n  // –§–æ—Ä—Å–∏—Ä–∞–Ω–µ –Ω–∞ home view –∑–∞ –ø—Ä–∞–∑–Ω–∏ hash-–æ–≤–µ\n  useEffect(() => {\n    const currentHash = window.location.hash;\n    if (currentHash === '' || currentHash === '#' || currentHash === '#/' || !currentHash) {\n      console.log('Forcing home view for hash:', currentHash);\n      setView('home');\n    }\n  }, []);\n\n  // Load saved language preference\n  useEffect(() => {\n    try {\n      const savedLang = localStorage.getItem(LANGUAGE_KEY);\n      if (savedLang && (savedLang === 'en' || savedLang === 'bg')) {\n        setLanguage(savedLang);\n      }\n    } catch {}\n  }, []);\n\n  // Language saver without timeout to prevent race conditions\n  const saveLanguage = useCallback(lang => {\n    if (language !== lang) {\n      setLanguage(lang);\n      try {\n        localStorage.setItem(LANGUAGE_KEY, lang);\n      } catch {}\n    }\n  }, [language]);\n\n  // click outside for dropdowns\n  useEffect(() => {\n    const onDocClick = e => {\n      if (signinRef.current && !signinRef.current.contains(e.target)) setSigninOpen(false);\n      if (profileRef.current && !profileRef.current.contains(e.target)) setProfileOpen(false);\n    };\n    document.addEventListener('click', onDocClick, true);\n    return () => document.removeEventListener('click', onDocClick, true);\n  }, []);\n\n  // load favorites\n  useEffect(() => {\n    try {\n      const v2raw = localStorage.getItem(FAVS_V2_KEY);\n      if (v2raw) {\n        const arr = JSON.parse(v2raw) || [];\n        setFavs(new Map(arr.map(t => [t.name, t])));\n      } else {\n        const v1raw = localStorage.getItem(FAVS_V1_KEY);\n        if (v1raw) {\n          const names = JSON.parse(v1raw) || [];\n          const arr = names.map(name => ({\n            name\n          }));\n          localStorage.setItem(FAVS_V2_KEY, JSON.stringify(arr));\n          localStorage.removeItem(FAVS_V1_KEY);\n          setFavs(new Map(arr.map(t => [t.name, t])));\n        }\n      }\n    } catch {}\n  }, []);\n  function saveFavs(next) {\n    setFavs(new Map(next));\n    try {\n      localStorage.setItem(FAVS_V2_KEY, JSON.stringify(Array.from(next.values())));\n    } catch {}\n  }\n  function toggleFav(tool) {\n    const next = new Map(favs);\n    if (next.has(tool.name)) next.delete(tool.name);else next.set(tool.name, {\n      name: tool.name,\n      icon: tool.icon,\n      link: tool.link\n    });\n    saveFavs(next);\n  }\n\n  // load recents\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(RECENT_KEY);\n      if (raw) setRecents(JSON.parse(raw));\n    } catch {}\n  }, []);\n  function pushRecent(prompt) {\n    const p = prompt.trim();\n    if (!p) return;\n    const next = [p, ...recents.filter(r => r !== p)].slice(0, RECENT_MAX);\n    setRecents(next);\n    try {\n      localStorage.setItem(RECENT_KEY, JSON.stringify(next));\n    } catch {}\n  }\n  function removeRecent(prompt) {\n    const next = recents.filter(r => r !== prompt);\n    setRecents(next);\n    try {\n      localStorage.setItem(RECENT_KEY, JSON.stringify(next));\n    } catch {}\n  }\n  function clearRecents() {\n    setRecents([]);\n    try {\n      localStorage.removeItem(RECENT_KEY);\n    } catch {}\n  }\n\n  // Fixed fetchPlan function with cache busting\n  async function fetchPlan(prompt) {\n    const timestamp = Date.now();\n    const res = await fetch(`${API_BASE}/plan?t=${timestamp}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\n        'Pragma': 'no-cache',\n        'Expires': '0'\n      },\n      body: JSON.stringify({\n        user_goal: prompt\n      })\n    });\n    if (!res.ok) throw new Error('Failed to fetch tools from backend');\n    return res.json();\n  }\n\n  // Fixed handleFindTools function\n  const handleFindTools = useCallback(async fromPrompt => {\n    const prompt = (fromPrompt !== null && fromPrompt !== void 0 ? fromPrompt : chatInput).trim();\n    if (!prompt) return;\n\n    // Clear previous results immediately\n    setGroups([]);\n    setLastGoal('');\n    setLoading(true);\n    setError(null);\n    try {\n      // Detect language and save immediately (no timeout)\n      const detectedLang = detectLanguage(prompt);\n      saveLanguage(detectedLang);\n      const data = await fetchPlan(prompt);\n      const grouped = data.groups && data.groups.length ? data.groups : groupsFromPlanFallback(data.plan);\n      setGroups(grouped);\n      setLastGoal(data.goal || prompt);\n      pushRecent(prompt);\n\n      // Clear input after successful search\n      if (!fromPrompt) {\n        setChatInput('');\n      }\n    } catch (e) {\n      console.error('Error fetching plan:', e);\n      setError(language === 'bg' ? '‚ö†Ô∏è –í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ—Ç–æ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏—Ç–µ.' : '‚ö†Ô∏è Something went wrong while fetching tools.');\n    } finally {\n      setLoading(false);\n    }\n  }, [chatInput, saveLanguage, language]);\n\n  // ------- Auth (cookie session) -------\n  async function handleGoogleSignIn() {\n    try {\n      const {\n        user\n      } = await openOAuthPopup('google');\n      setCurrentUser(user);\n      setError(null);\n    } catch (e) {\n      console.error(e);\n      setError(t('signInFailed'));\n    }\n  }\n  async function handleSignOut() {\n    try {\n      await logout();\n    } catch (e) {\n      console.warn('Logout error:', e);\n    }\n    setCurrentUser(null);\n  }\n  async function submitEmailAuth() {\n    setAuthSubmitting(true);\n    setAuthError(null);\n    setError(null);\n    try {\n      const url = authMode === 'signup' ? `${API_BASE}/auth/register` : `${API_BASE}/auth/login`;\n      const res = await fetch(url, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email: authEmail,\n          password: authPassword,\n          name: authMode === 'signup' ? authName : undefined\n        })\n      });\n      if (!res.ok) {\n        const t = await res.text();\n        throw new Error(t || `HTTP ${res.status}`);\n      }\n      const data = await res.json();\n      setCurrentUser(data.user);\n      setShowEmailModal(false);\n      setAuthEmail('');\n      setAuthPassword('');\n      setAuthName('');\n    } catch (e) {\n      console.error(e);\n      setAuthError(authMode === 'signup' ? t('signUpFailed') : t('signInFailed'));\n    } finally {\n      setAuthSubmitting(false);\n    }\n  }\n\n  // Profile modal open\n  function openProfile() {\n    var _currentUser$name, _currentUser$picture;\n    if (!currentUser) return;\n    setProfName((_currentUser$name = currentUser.name) !== null && _currentUser$name !== void 0 ? _currentUser$name : '');\n    setProfPic((_currentUser$picture = currentUser.picture) !== null && _currentUser$picture !== void 0 ? _currentUser$picture : '');\n    setShowProfileModal(true);\n    setProfileOpen(false);\n  }\n\n  // Save profile (PATCH /auth/me)\n  async function saveProfile() {\n    if (!currentUser) return;\n    setProfSaving(true);\n    setError(null);\n    try {\n      const xsrf = getCookie('XSRF-TOKEN');\n      const res = await fetch(`${API_BASE}/auth/me`, {\n        method: 'PATCH',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(xsrf ? {\n            'X-XSRF-TOKEN': xsrf\n          } : {})\n        },\n        body: JSON.stringify({\n          name: profName,\n          picture: profPic\n        })\n      });\n      if (!res.ok) {\n        const t = await res.text();\n        throw new Error(t || 'Update failed');\n      }\n      const user = await res.json();\n      setCurrentUser(user);\n      setShowProfileModal(false);\n    } catch (e) {\n      console.error(e);\n      setError(t('profileUpdateFailed'));\n    } finally {\n      setProfSaving(false);\n    }\n  }\n\n  // auto-load session\n  useEffect(() => {\n    let mounted = true;\n    (async () => {\n      try {\n        const u = await fetchMe();\n        if (mounted) setCurrentUser(u);\n      } catch {\n        try {\n          await refreshSession();\n          const u2 = await fetchMe();\n          if (mounted) setCurrentUser(u2);\n        } catch {\n          if (mounted) setCurrentUser(null);\n        }\n      }\n    })();\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  // Filtering logic\n  const term = searchQuery.trim().toLowerCase();\n  const filteredGroups = groups.map(g => ({\n    title: g.title,\n    tools: g.tools.filter(t => {\n      var _t$name;\n      const match = !term || g.title.toLowerCase().includes(term) || ((_t$name = t.name) !== null && _t$name !== void 0 ? _t$name : '').toLowerCase().includes(term);\n      const favOk = !showFavsOnly || favs.has(t.name);\n      return match && favOk;\n    })\n  })).filter(g => g.tools.length > 0);\n  const favCount = favs.size;\n\n  // Stable input change handler to prevent focus loss\n  const handleChatInputChange = useCallback(e => {\n    setChatInput(e.target.value);\n  }, []);\n  const handleKeyDown = useCallback(e => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleFindTools();\n    }\n  }, [handleFindTools]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-200/50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-6xl mx-auto px-4 py-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3 cursor-pointer\",\n            onClick: goHome,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/25\",\n              children: /*#__PURE__*/_jsxDEV(Sparkles, {\n                className: \"w-5 h-5 text-white\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 915,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 914,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xl text-slate-800 font-semibold\",\n              children: \"My AI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 917,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 913,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"nav\", {\n            className: \"hidden md:flex items-center gap-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: goHome,\n              className: `font-medium transition-colors ${view === 'home' ? 'text-blue-600' : 'text-slate-600 hover:text-blue-600'}`,\n              children: t('discover')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 922,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: goCategories,\n              className: `font-medium transition-colors ${view === 'categories' ? 'text-blue-600' : 'text-slate-600 hover:text-blue-600'}`,\n              children: t('categories')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 928,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"#\",\n              className: \"text-slate-600 hover:text-blue-600 font-medium transition-colors\",\n              children: t('learn')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 934,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: goFavorites,\n              className: `inline-flex items-center gap-2 font-medium transition-colors ${view === 'favorites' ? 'text-blue-600' : 'text-slate-700 hover:text-blue-600'}`,\n              title: t('favorites'),\n              children: [/*#__PURE__*/_jsxDEV(Star, {\n                className: `w-4 h-4 ${favCount ? 'fill-yellow-400 text-yellow-500' : ''}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 944,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"hidden lg:inline\",\n                children: t('favorites')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 945,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded-full\",\n                children: favCount\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 946,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 937,\n              columnNumber: 15\n            }, this), currentUser ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              ref: profileRef,\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setProfileOpen(!profileOpen),\n                className: \"flex items-center gap-2 hover:bg-slate-50 p-2 rounded-xl transition-colors\",\n                title: currentUser.email,\n                children: [currentUser.picture ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: currentUser.picture,\n                  alt: \"avatar\",\n                  className: \"w-8 h-8 rounded-full border border-slate-200\",\n                  referrerPolicy: \"no-referrer\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 958,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-8 h-8 rounded-full bg-blue-200\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 965,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-slate-700 font-medium max-w-[120px] truncate hidden lg:block\",\n                  children: currentUser.name || currentUser.email\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 967,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 952,\n                columnNumber: 19\n              }, this), profileOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute right-0 mt-2 w-56 bg-white rounded-2xl shadow-xl border border-slate-200/60 p-1 z-50\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: openProfile,\n                  className: \"w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors\",\n                  children: t('profile')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 973,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"my-1 border-t border-slate-100\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 976,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleSignOut,\n                  className: \"w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors text-red-600\",\n                  children: t('signOut')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 977,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 972,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 951,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              ref: signinRef,\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline\",\n                size: \"sm\",\n                onClick: () => setSigninOpen(!signinOpen),\n                className: \"border-blue-300 text-blue-600 hover:bg-blue-50 font-medium\",\n                children: t('signIn')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 985,\n                columnNumber: 19\n              }, this), signinOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute right-0 mt-2 w-64 bg-white rounded-2xl shadow-2xl border border-slate-200/60 p-1 z-50\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    setSigninOpen(false);\n                    setAuthMode('signup');\n                    setShowEmailModal(true);\n                  },\n                  className: \"w-full flex items-center px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"w-6 h-6 rounded-md bg-slate-200 mr-3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 999,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex flex-col items-start\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-slate-800 font-medium\",\n                      children: t('createAccount')\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1001,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-slate-400 text-xs\",\n                      children: t('emailPassword')\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1002,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1000,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 995,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"my-1 border-t border-slate-100\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1005,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    setSigninOpen(false);\n                    handleGoogleSignIn();\n                  },\n                  className: \"w-full flex items-center px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors\",\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: \"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg\",\n                    alt: \"Google\",\n                    className: \"w-4 h-4 mr-3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1010,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-slate-800 font-medium\",\n                    children: t('signInWithGoogle')\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1011,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1006,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 994,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 984,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 921,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outline\",\n            size: \"sm\",\n            className: \"md:hidden\",\n            onClick: () => setMobileMenuOpen(!mobileMenuOpen),\n            children: /*#__PURE__*/_jsxDEV(Menu, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1026,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1020,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 911,\n          columnNumber: 11\n        }, this), mobileMenuOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"md:hidden mt-4 pb-4 border-t border-slate-200/50 pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                goHome();\n                setMobileMenuOpen(false);\n              },\n              className: \"block w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors font-medium\",\n              children: t('discover')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1034,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                goCategories();\n                setMobileMenuOpen(false);\n              },\n              className: \"block w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors font-medium\",\n              children: t('categories')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1037,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                goFavorites();\n                setMobileMenuOpen(false);\n              },\n              className: \"block w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors font-medium\",\n              children: [t('favorites'), \" (\", favCount, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1040,\n              columnNumber: 17\n            }, this), !currentUser && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setShowEmailModal(true);\n                setMobileMenuOpen(false);\n              },\n              className: \"block w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors font-medium text-blue-600\",\n              children: t('signIn')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1044,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1033,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1032,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 910,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 909,\n      columnNumber: 7\n    }, this), showEmailModal && /*#__PURE__*/_jsxDEV(AuthModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1055,\n      columnNumber: 26\n    }, this), showProfileModal && currentUser && /*#__PURE__*/_jsxDEV(ProfileModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1056,\n      columnNumber: 43\n    }, this), (() => {\n      const currentHash = window.location.hash;\n\n      // –î–∏—Ä–µ–∫—Ç–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ hash-–∞ –∏–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç\n      if (currentHash === '#/favorites') return /*#__PURE__*/_jsxDEV(FavoritesView, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1063,\n        columnNumber: 51\n      }, this);\n      if (currentHash === '#/categories') return /*#__PURE__*/_jsxDEV(CategoriesView, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1064,\n        columnNumber: 52\n      }, this);\n      if (currentHash.startsWith('#/categories/') && currentHash !== '#/categories') {\n        return /*#__PURE__*/_jsxDEV(CategoryViewWrapper, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1066,\n          columnNumber: 18\n        }, this);\n      }\n\n      // –ó–∞ –ø—Ä–∞–∑–Ω–∏ –∏–ª–∏ home hash-–æ–≤–µ –≤–∏–Ω–∞–≥–∏ –ø–æ–∫–∞–∑–≤–∞–º–µ home\n      if (!currentHash || currentHash === '#' || currentHash === '#/') {\n        return /*#__PURE__*/_jsxDEV(HomeView, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1071,\n          columnNumber: 18\n        }, this);\n      }\n\n      // Fallback –∫—ä–º view state\n      if (view === 'favorites') return /*#__PURE__*/_jsxDEV(FavoritesView, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1075,\n        columnNumber: 42\n      }, this);\n      if (view === 'categories') return /*#__PURE__*/_jsxDEV(CategoriesView, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1076,\n        columnNumber: 43\n      }, this);\n      if (view === 'category') return /*#__PURE__*/_jsxDEV(CategoryViewWrapper, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1077,\n        columnNumber: 41\n      }, this);\n      return /*#__PURE__*/_jsxDEV(HomeView, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1079,\n        columnNumber: 16\n      }, this);\n    })(), /*#__PURE__*/_jsxDEV(\"nav\", {\n      className: \"fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-xl border-t border-slate-200/50 md:hidden z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-around py-2\",\n        children: [{\n          name: t('home'),\n          icon: Grid3x3,\n          active: activeTab === 'Home',\n          action: () => {\n            goHome();\n            setActiveTab('Home');\n          }\n        }, {\n          name: t('categories'),\n          icon: MessageCircle,\n          active: activeTab === 'Categories',\n          action: () => {\n            goCategories();\n            setActiveTab('Categories');\n          }\n        }, {\n          name: t('favorites'),\n          icon: Heart,\n          active: activeTab === 'Favorites',\n          action: () => {\n            goFavorites();\n            setActiveTab('Favorites');\n          }\n        }, {\n          name: t('profile'),\n          icon: User,\n          active: activeTab === 'Profile',\n          action: () => setActiveTab('Profile')\n        }].map(item => {\n          const IconComponent = item.icon;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: item.action,\n            className: `flex flex-col items-center py-2 px-3 rounded-xl transition-colors ${item.active ? 'text-blue-600 bg-blue-50' : 'text-slate-400 hover:text-slate-600'}`,\n            children: [/*#__PURE__*/_jsxDEV(IconComponent, {\n              className: \"w-5 h-5 mb-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1100,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs font-medium\",\n              children: item.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1101,\n              columnNumber: 17\n            }, this)]\n          }, item.name, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1093,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1084,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1083,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 907,\n    columnNumber: 5\n  }, this);\n\n  // Auth Modal Component\n  function AuthModal() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white w-full max-w-md rounded-2xl shadow-2xl p-6 mx-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-xl font-semibold text-slate-800\",\n            children: authMode === 'signup' ? t('createYourAccount') : t('signInToAccount')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1116,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowEmailModal(false),\n            className: \"text-slate-500 hover:text-slate-700 p-1\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1120,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1119,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [authMode === 'signup' && /*#__PURE__*/_jsxDEV(Input, {\n            placeholder: t('yourName'),\n            value: authName,\n            onChange: e => setAuthName(e.target.value),\n            className: \"h-12 rounded-xl\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1126,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            placeholder: t('email'),\n            type: \"email\",\n            value: authEmail,\n            onChange: e => setAuthEmail(e.target.value),\n            className: \"h-12 rounded-xl\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1133,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            placeholder: t('password'),\n            type: \"password\",\n            value: authPassword,\n            onChange: e => setAuthPassword(e.target.value),\n            className: \"h-12 rounded-xl\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1140,\n            columnNumber: 13\n          }, this), authError && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-red-600 text-sm p-3 bg-red-50 rounded-xl\",\n            children: authError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1147,\n            columnNumber: 27\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1124,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setAuthMode(authMode === 'signup' ? 'signin' : 'signup'),\n            className: \"text-sm text-blue-600 hover:underline\",\n            children: authMode === 'signup' ? t('alreadyHaveAccount') : t('dontHaveAccount')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1151,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              variant: \"outline\",\n              onClick: () => setShowEmailModal(false),\n              children: t('cancel')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1158,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              onClick: submitEmailAuth,\n              disabled: authSubmitting,\n              className: \"bg-gradient-to-r from-blue-600 to-indigo-600\",\n              children: authMode === 'signup' ? t('createAccount') : t('signIn')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1159,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1157,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1150,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center text-xs text-slate-400 mb-3\",\n            children: t('orContinueWith')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1166,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => {\n              setShowEmailModal(false);\n              handleGoogleSignIn();\n            },\n            className: \"w-full bg-white border border-slate-200 text-slate-800 hover:bg-slate-50 h-12\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg\",\n              alt: \"Google\",\n              className: \"w-5 h-5 mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1171,\n              columnNumber: 15\n            }, this), t('google')]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1167,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1165,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1114,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1113,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Profile Modal Component\n  function ProfileModal() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white w-full max-w-md rounded-2xl shadow-2xl p-6 mx-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-xl font-semibold text-slate-800\",\n            children: t('yourProfile')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1186,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowProfileModal(false),\n            className: \"text-slate-500 hover:text-slate-700 p-1\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1188,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1187,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1185,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-4 mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-16 h-16 rounded-full overflow-hidden bg-slate-100 border-2 border-slate-200\",\n            children: profPic ? /*#__PURE__*/_jsxDEV(\"img\", {\n              src: profPic,\n              className: \"w-full h-full object-cover\",\n              referrerPolicy: \"no-referrer\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1195,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-full h-full bg-blue-200\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1197,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1193,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-slate-500 mb-1\",\n              children: t('email')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1201,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-slate-800 font-medium\",\n              children: currentUser.email\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1202,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1200,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1192,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"text-sm font-medium text-slate-700 mb-2 block\",\n              children: t('name')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1208,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              placeholder: t('name'),\n              value: profName,\n              onChange: e => setProfName(e.target.value),\n              className: \"h-12 rounded-xl\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1209,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1207,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"text-sm font-medium text-slate-700 mb-2 block\",\n              children: t('avatarUrl')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1217,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              placeholder: \"https://...\",\n              value: profPic,\n              onChange: e => setProfPic(e.target.value),\n              className: \"h-12 rounded-xl\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1218,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1216,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end gap-3 mt-8\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outline\",\n            onClick: () => setShowProfileModal(false),\n            children: t('cancel')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1228,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: saveProfile,\n            disabled: profSaving,\n            className: \"bg-gradient-to-r from-blue-600 to-indigo-600\",\n            children: t('saveChanges')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1229,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1227,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1184,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1183,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Home View Component with BOTH PlanMindMap AND Results sections\n  function HomeView() {\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-6xl mx-auto px-4 py-8 pb-24 md:pb-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"text-center mb-16\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-4xl md:text-5xl text-slate-800 mb-6 font-bold tracking-tight\",\n          children: [t('heroTitle'), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\",\n            children: t('heroTitleHighlight')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1245,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1244,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xl text-slate-600 mb-10 max-w-2xl mx-auto leading-relaxed\",\n          children: t('heroSubtitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1247,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"max-w-2xl mx-auto mb-8\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative bg-white/80 backdrop-blur-sm rounded-3xl p-6 border border-slate-200/50 shadow-2xl shadow-blue-500/10\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-4 mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/25\",\n                children: /*#__PURE__*/_jsxDEV(MessageCircle, {\n                  className: \"w-6 h-6 text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1256,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1255,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-slate-700 text-lg font-medium\",\n                children: t('inputPlaceholder')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1258,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1254,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(Input, {\n                placeholder: language === 'bg' ? '–Ω–∞–ø—Ä., –ü–∏—Å–∞–Ω–µ –Ω–∞ –ø–æ-–¥–æ–±—Ä–∏ –∏–º–µ–π–ª–∏, —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –ª–æ–≥–æ, –∞–Ω–∞–ª–∏–∑ –Ω–∞ –¥–∞–Ω–Ω–∏...' : 'e.g., Write better emails, create a logo, analyze data...',\n                autoFocus: true,\n                value: chatInput,\n                onChange: handleChatInputChange,\n                onKeyDown: handleKeyDown,\n                className: \"flex-1 bg-slate-50/80 border-slate-200 text-base h-14 rounded-2xl px-5 font-medium placeholder:text-slate-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1261,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                onClick: () => handleFindTools(),\n                className: \"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 px-6 h-14 rounded-2xl shadow-lg shadow-blue-500/25 font-medium\",\n                disabled: loading,\n                children: [/*#__PURE__*/_jsxDEV(Zap, {\n                  className: \"w-5 h-5 mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1274,\n                  columnNumber: 19\n                }, this), \" \", t('findTools')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1269,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1260,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1253,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1252,\n          columnNumber: 11\n        }, this), recents.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"max-w-2xl mx-auto mb-10\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between mb-3 px-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2 text-slate-600\",\n              children: [/*#__PURE__*/_jsxDEV(History, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1285,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium\",\n                children: t('recentPrompts')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1286,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1284,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"text-xs text-slate-400 hover:text-slate-600 transition-colors\",\n              onClick: clearRecents,\n              children: t('clearAll')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1288,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1283,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-wrap gap-2\",\n            children: recents.map(prompt => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"group inline-flex items-center max-w-full bg-white/90 border border-slate-200/60 rounded-xl px-3 py-2 shadow-sm hover:shadow-md transition-shadow\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"text-sm text-slate-700 truncate max-w-[200px] hover:text-blue-600 transition-colors\",\n                title: prompt,\n                onClick: () => {\n                  setChatInput(prompt);\n                  handleFindTools(prompt);\n                },\n                children: prompt\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1295,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"ml-2 text-slate-400 hover:text-red-500 transition-colors p-1\",\n                onClick: () => removeRecent(prompt),\n                \"aria-label\": \"remove\",\n                title: \"Remove\",\n                children: /*#__PURE__*/_jsxDEV(X, {\n                  className: \"w-3 h-3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1308,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1302,\n                columnNumber: 21\n              }, this)]\n            }, prompt, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1294,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1292,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1282,\n          columnNumber: 13\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-600 font-medium mb-6 p-4 bg-red-50 rounded-2xl border border-red-200 max-w-2xl mx-auto\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1318,\n          columnNumber: 13\n        }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-blue-600 font-medium mb-6 p-4 bg-blue-50 rounded-2xl border border-blue-200 max-w-2xl mx-auto\",\n          children: t('loading')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1323,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1243,\n        columnNumber: 9\n      }, this), filteredGroups.length > 0 && /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"mb-12\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col sm:flex-row gap-4 mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative flex-1\",\n            children: [/*#__PURE__*/_jsxDEV(Search, {\n              className: \"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1334,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              placeholder: t('searchPlaceholder'),\n              value: searchQuery,\n              onChange: e => setSearchQuery(e.target.value),\n              className: \"pl-12 bg-white/80 border-slate-200/50 h-12 rounded-2xl backdrop-blur-sm font-medium\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1335,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1333,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"inline-flex items-center gap-2 text-slate-700 bg-white/80 border border-slate-200/50 rounded-2xl px-4 h-12 whitespace-nowrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: showFavsOnly,\n              onChange: e => setShowFavsOnly(e.target.checked),\n              className: \"accent-blue-600 w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1343,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-sm font-medium\",\n              children: t('favoritesOnly')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1349,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs text-slate-400\",\n              children: [\"(\", favCount, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1350,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1342,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1332,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1331,\n        columnNumber: 11\n      }, this), filteredGroups.length > 0 && /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"mb-16\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3 mb-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-10 h-10 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-purple-500/25\",\n            children: /*#__PURE__*/_jsxDEV(Wand2, {\n              className: \"w-5 h-5 text-white\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1361,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1360,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-2xl text-slate-800 font-bold\",\n              children: t('journeyTitle')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1364,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-slate-600 text-sm\",\n              children: t('journeySubtitle')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1365,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1363,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1359,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(PlanMindMap, {\n          goal: lastGoal || chatInput,\n          steps: filteredGroups,\n          onOpenTool: handleOpenTool,\n          language: language,\n          buildPrompt: buildPromptCallback\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1368,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1358,\n        columnNumber: 11\n      }, this), filteredGroups.length === 0 && !loading && groups.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-20\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-20 h-20 bg-slate-100 rounded-3xl flex items-center justify-center mx-auto mb-6\",\n          children: /*#__PURE__*/_jsxDEV(Sparkles, {\n            className: \"w-10 h-10 text-slate-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1382,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1381,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-slate-800 mb-3 font-bold text-xl\",\n          children: t('readyTitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1384,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-slate-600\",\n          children: t('readySubtitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1385,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1380,\n        columnNumber: 11\n      }, this), filteredGroups.length === 0 && !loading && groups.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-16\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-20 h-20 bg-slate-100 rounded-3xl flex items-center justify-center mx-auto mb-6\",\n          children: /*#__PURE__*/_jsxDEV(Search, {\n            className: \"w-10 h-10 text-slate-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1392,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1391,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-slate-800 mb-3 font-bold text-xl\",\n          children: t('noToolsTitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1394,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-slate-600\",\n          children: t('noToolsSubtitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1395,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1390,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1241,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Favorites View Component\n  function FavoritesView() {\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-6xl mx-auto px-4 py-8 pb-24 md:pb-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: goHome,\n            className: \"inline-flex items-center gap-2 text-slate-600 hover:text-blue-600 transition-colors p-2 -ml-2 rounded-xl\",\n            children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1409,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: t('back')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1410,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1408,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-px h-6 bg-slate-300\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1412,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-2xl text-slate-800 font-bold\",\n            children: t('myFavorites')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1413,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1407,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-slate-500 font-medium bg-slate-100 px-3 py-1 rounded-full text-sm\",\n          children: [favCount, \" \", t('savedCount')]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1415,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1406,\n        columnNumber: 9\n      }, this), favCount === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-20\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-20 h-20 bg-slate-100 rounded-3xl flex items-center justify-center mx-auto mb-6\",\n          children: /*#__PURE__*/_jsxDEV(Star, {\n            className: \"w-10 h-10 text-slate-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1423,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1422,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-slate-800 mb-3 font-bold text-xl\",\n          children: t('noFavoritesTitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1425,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-slate-600 mb-8\",\n          children: t('noFavoritesSubtitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1426,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: goHome,\n          className: \"bg-gradient-to-r from-blue-600 to-indigo-600\",\n          children: t('discoverTools')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1427,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1421,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid sm:grid-cols-2 lg:grid-cols-3 gap-6\",\n        children: Array.from(favs.values()).map(tool => /*#__PURE__*/_jsxDEV(ToolCard, {\n          tool: tool,\n          isFav: true,\n          onToggleFav: () => toggleFav(tool)\n        }, `fav-${tool.name}`, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1434,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1432,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1405,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Tool Card Component (used in FavoritesView)\n  function ToolCard({\n    tool,\n    isFav,\n    onToggleFav\n  }) {\n    return /*#__PURE__*/_jsxDEV(Card, {\n      className: \"border-slate-200/50 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 bg-white/90 backdrop-blur-sm group\",\n      children: /*#__PURE__*/_jsxDEV(CardContent, {\n        className: \"p-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-start justify-between mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-14 h-14 rounded-2xl overflow-hidden bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform duration-300\",\n            children: 'icon' in tool && tool.icon ? /*#__PURE__*/_jsxDEV(\"img\", {\n              src: tool.icon,\n              alt: tool.name,\n              className: \"w-8 h-8 object-contain\",\n              loading: \"lazy\",\n              referrerPolicy: \"no-referrer\",\n              onError: e => {\n                const img = e.currentTarget;\n                img.onerror = null;\n                img.style.display = 'none';\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1455,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(Sparkles, {\n              className: \"w-7 h-7 text-white\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1468,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1453,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: onToggleFav,\n            className: `flex items-center gap-1 px-3 py-1.5 rounded-xl border transition-all ${isFav ? 'bg-yellow-100 border-yellow-200 text-yellow-700 hover:bg-yellow-200' : 'bg-white border-slate-200 text-slate-500 hover:bg-slate-50 hover:border-slate-300'}`,\n            title: isFav ? t('removeFromFavorites') : t('addToFavorites'),\n            children: [/*#__PURE__*/_jsxDEV(Star, {\n              className: `w-4 h-4 ${isFav ? 'fill-current' : ''}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1481,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-sm font-medium hidden sm:inline\",\n              children: isFav ? t('saved') : t('save')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1482,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1472,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1452,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-slate-800 mb-3 font-bold text-lg leading-tight\",\n          children: tool.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1488,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 mb-5\",\n          children: [/*#__PURE__*/_jsxDEV(Badge, {\n            variant: \"secondary\",\n            className: \"text-xs bg-blue-100 text-blue-700 font-medium px-2 py-1\",\n            children: t('aiTool')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1491,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Badge, {\n            variant: \"secondary\",\n            className: \"text-xs font-medium px-2 py-1 bg-emerald-100 text-emerald-700\",\n            children: t('free')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1494,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1490,\n          columnNumber: 11\n        }, this), 'link' in tool && tool.link ? /*#__PURE__*/_jsxDEV(\"a\", {\n          href: tool.link,\n          target: \"_blank\",\n          rel: \"noreferrer noopener\",\n          className: \"block w-full text-center bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white rounded-2xl h-11 leading-[44px] font-medium shadow-lg shadow-red-500/25 transition-all duration-200\",\n          children: t('openTool')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1500,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(Button, {\n          disabled: true,\n          className: \"w-full rounded-2xl h-11 bg-slate-100 text-slate-400\",\n          children: t('noLink')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1509,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1451,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1450,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Categories View Component\n  function CategoriesView() {\n    _s();\n    const [searchQuery, setSearchQuery] = useState('');\n    const [loading, setLoading] = useState(true);\n\n    // Categories data based on comprehensive AI tools research\n    const categories = [{\n      id: 'assistants-productivity',\n      label: language === 'bg' ? '–ê—Å–∏—Å—Ç–µ–Ω—Ç–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç' : 'Assistants & Productivity',\n      emoji: 'ü§ñ',\n      description: language === 'bg' ? '–£–º–Ω–∏ –ø–æ–º–æ—â–Ω–∏—Ü–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –ø–æ–≤–∏—à–∞–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—Ç–∞' : 'Smart assistants and productivity enhancement tools',\n      count: 48,\n      gradient: 'from-blue-500 to-indigo-600'\n    }, {\n      id: 'text-writing',\n      label: language === 'bg' ? '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ —Ç–µ–∫—Å—Ç –∏ –ø–∏—Å–∞–Ω–µ' : 'Text Generation & Writing',\n      emoji: '‚úèÔ∏è',\n      description: language === 'bg' ? '–°—ä–∑–¥–∞–≤–∞–Ω–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –∏ –ø–æ–¥–æ–±—Ä—è–≤–∞–Ω–µ –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ' : 'Creating, editing and improving written content',\n      count: 42,\n      gradient: 'from-emerald-500 to-teal-600'\n    }, {\n      id: 'images-design',\n      label: language === 'bg' ? '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –¥–∏–∑–∞–π–Ω' : 'Images & Design',\n      emoji: 'üé®',\n      description: language === 'bg' ? '–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –∏ –¥–∏–∑–∞–π–Ω –Ω–∞ –≤–∏–∑—É–∞–ª–Ω–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ' : 'Generate, edit and design visual content',\n      count: 39,\n      gradient: 'from-purple-500 to-pink-600'\n    }, {\n      id: 'video-3d',\n      label: language === 'bg' ? '–í–∏–¥–µ–æ –∏ 3D' : 'Video & 3D',\n      emoji: 'üé¨',\n      description: language === 'bg' ? '–°—ä–∑–¥–∞–≤–∞–Ω–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –≤–∏–¥–µ–æ –∏ 3D —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ' : 'Create and edit video and 3D content',\n      count: 35,\n      gradient: 'from-red-500 to-orange-600'\n    }, {\n      id: 'audio-music',\n      label: language === 'bg' ? '–ê—É–¥–∏–æ –∏ –º—É–∑–∏–∫–∞' : 'Audio & Music',\n      emoji: 'üéµ',\n      description: language === 'bg' ? '–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –∑–≤—É–∫, –º—É–∑–∏–∫–∞ –∏ –≥–ª–∞—Å–æ–≤–∏ –∑–∞–ø–∏—Å–∏' : 'Generate sound, music and voice recordings',\n      count: 28,\n      gradient: 'from-amber-500 to-yellow-600'\n    }, {\n      id: 'business-marketing',\n      label: language === 'bg' ? '–ë–∏–∑–Ω–µ—Å, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ —Å–æ—Ü–∏–∞–ª–Ω–∏ –º–µ–¥–∏–∏' : 'Business, Marketing & Social Media',\n      emoji: 'üìà',\n      description: language === 'bg' ? '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –±–∏–∑–Ω–µ—Å, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ —Å–æ—Ü–∏–∞–ª–Ω–∏ –º—Ä–µ–∂–∏' : 'Tools for business, marketing and social networks',\n      count: 44,\n      gradient: 'from-cyan-500 to-blue-600'\n    }, {\n      id: 'coding-development',\n      label: language === 'bg' ? '–ö–æ–¥–∏—Ä–∞–Ω–µ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞' : 'Coding & Development',\n      emoji: 'üíª',\n      description: language === 'bg' ? '–ü–æ–º–æ—â–Ω–∏—Ü–∏ –∑–∞ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å–æ—Ñ—Ç—É–µ—Ä' : 'Programming assistants and software development',\n      count: 33,\n      gradient: 'from-slate-600 to-gray-700'\n    }, {\n      id: 'automation-agents',\n      label: language === 'bg' ? '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –∞–≥–µ–Ω—Ç–∏' : 'Automation & AI Agents',\n      emoji: '‚ö°',\n      description: language === 'bg' ? '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ –ø—Ä–æ—Ü–µ—Å–∏ –∏ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∏ AI –∞–≥–µ–Ω—Ç–∏' : 'Process automation and intelligent AI agents',\n      count: 26,\n      gradient: 'from-violet-500 to-purple-600'\n    }, {\n      id: 'data-analysis',\n      label: language === 'bg' ? '–î–∞–Ω–Ω–∏ –∏ –∞–Ω–∞–ª–∏–∑' : 'Data & Analysis',\n      emoji: 'üìä',\n      description: language === 'bg' ? '–ê–Ω–∞–ª–∏–∑ –Ω–∞ –¥–∞–Ω–Ω–∏ –∏ –±–∏–∑–Ω–µ—Å –∞–Ω–∞–ª–∏—Ç–∏–∫–∞' : 'Data analysis and business intelligence',\n      count: 31,\n      gradient: 'from-teal-600 to-emerald-700'\n    }, {\n      id: 'education-learning',\n      label: language === 'bg' ? '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ' : 'Education & Learning',\n      emoji: 'üéì',\n      description: language === 'bg' ? '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ —É—á–µ–Ω–µ –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª–Ω–∏ –ø–æ–º–æ—â–Ω–∏—Ü–∏' : 'Learning tools and educational assistants',\n      count: 23,\n      gradient: 'from-indigo-500 to-blue-600'\n    }, {\n      id: 'health-wellness',\n      label: language === 'bg' ? '–ó–¥—Ä–∞–≤–µ –∏ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ' : 'Health & Wellness',\n      emoji: 'üè•',\n      description: language === 'bg' ? 'AI —Ä–µ—à–µ–Ω–∏—è –∑–∞ –∑–¥—Ä–∞–≤–µ –∏ –ª–∏—á–Ω–æ —Ä–∞–∑–≤–∏—Ç–∏–µ' : 'AI solutions for health and personal development',\n      count: 19,\n      gradient: 'from-green-500 to-emerald-600'\n    }, {\n      id: 'specialized-niche',\n      label: language === 'bg' ? '–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏/–Ω–∏—à–æ–≤–∏' : 'Specialized & Niche',\n      emoji: 'üéØ',\n      description: language === 'bg' ? '–°–ø–µ—Ü–∏–∞–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –æ–±–ª–∞—Å—Ç–∏ –∏ –ø—Ä–æ—Ñ–µ—Å–∏–∏' : 'Special tools for specific fields and professions',\n      count: 27,\n      gradient: 'from-rose-500 to-pink-600'\n    }];\n\n    // Filter categories based on search\n    const filteredCategories = categories.filter(category => category.label.toLowerCase().includes(searchQuery.toLowerCase()) || category.description.toLowerCase().includes(searchQuery.toLowerCase()));\n    useEffect(() => {\n      // Simulate loading\n      setTimeout(() => setLoading(false), 500);\n    }, []);\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-6xl mx-auto px-4 py-8 pb-24 md:pb-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-8\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: goHome,\n            className: \"inline-flex items-center gap-2 text-slate-600 hover:text-blue-600 transition-colors p-2 -ml-2 rounded-xl\",\n            children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1640,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: t('back')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1641,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1639,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-px h-6 bg-slate-300\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1643,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-3xl text-slate-800 font-bold\",\n              children: t('categoriesTitle')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1645,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-slate-600 text-sm mt-1\",\n              children: t('categoriesSubtitle')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1646,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1644,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1638,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1637,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative max-w-md\",\n          children: [/*#__PURE__*/_jsxDEV(Search, {\n            className: \"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1654,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            placeholder: t('searchCategories'),\n            value: searchQuery,\n            onChange: e => setSearchQuery(e.target.value),\n            className: \"pl-12 bg-white/80 border-slate-200/50 h-12 rounded-2xl backdrop-blur-sm font-medium\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1655,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1653,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1652,\n        columnNumber: 9\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid sm:grid-cols-2 lg:grid-cols-3 gap-6\",\n        children: Array.from({\n          length: 9\n        }).map((_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-40 bg-slate-100 rounded-3xl animate-pulse\"\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1668,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1666,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid sm:grid-cols-2 lg:grid-cols-3 gap-6\",\n        children: filteredCategories.map(category => /*#__PURE__*/_jsxDEV(Card, {\n          className: \"group border-slate-200/50 hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 bg-white/90 backdrop-blur-sm cursor-pointer overflow-hidden\",\n          onClick: () => {\n            const capParam = CATEGORY_TO_CAP_MAPPING[category.id] || category.id;\n            const newHash = `#/categories/${encodeURIComponent(capParam)}`;\n            window.location.hash = newHash;\n          },\n          children: /*#__PURE__*/_jsxDEV(CardContent, {\n            className: \"p-6 relative\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: `absolute inset-0 bg-gradient-to-br ${category.gradient} opacity-5 group-hover:opacity-10 transition-opacity duration-300`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1685,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-start justify-between mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `w-16 h-16 rounded-3xl bg-gradient-to-br ${category.gradient} flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300`,\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-2xl\",\n                    children: category.emoji\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1691,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1690,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-right\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-xs text-slate-500\",\n                    children: category.count\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1694,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-xs text-slate-400\",\n                    children: t('toolsInCategory')\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1695,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1693,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1689,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-xl font-bold text-slate-800 mb-2 group-hover:text-slate-900 transition-colors\",\n                children: category.label\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1699,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-slate-600 mb-4 leading-relaxed\",\n                children: category.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1703,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(Badge, {\n                  variant: \"secondary\",\n                  className: `text-xs font-medium px-3 py-1 bg-gradient-to-r ${category.gradient} text-white border-0`,\n                  children: t('browseCategory')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1708,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(ArrowLeft, {\n                  className: \"w-4 h-4 text-slate-400 rotate-180 group-hover:translate-x-1 transition-transform duration-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1714,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1707,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1688,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1683,\n            columnNumber: 17\n          }, this)\n        }, category.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1674,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1672,\n        columnNumber: 11\n      }, this), !loading && filteredCategories.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-20\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-20 h-20 bg-slate-100 rounded-3xl flex items-center justify-center mx-auto mb-6\",\n          children: /*#__PURE__*/_jsxDEV(Search, {\n            className: \"w-10 h-10 text-slate-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1727,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1726,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-slate-800 mb-3 font-bold text-xl\",\n          children: t('noToolsTitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1729,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-slate-600\",\n          children: t('noToolsSubtitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1730,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1725,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-12 text-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inline-flex items-center gap-6 bg-white/80 border border-slate-200/50 rounded-2xl px-6 py-4 backdrop-blur-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-slate-800\",\n              children: filteredCategories.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1738,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-slate-500\",\n              children: t('totalCategories')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1739,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1737,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-px h-8 bg-slate-300\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1741,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-slate-800\",\n              children: filteredCategories.reduce((total, cat) => total + cat.count, 0)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1743,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-slate-500\",\n              children: t('totalTools')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1746,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1742,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1736,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1735,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1635,\n      columnNumber: 7\n    }, this);\n  }\n  _s(CategoriesView, \"ObI5xCVGslSwVS0hWUU6Du1nr+M=\");\n}\n_s2(App, \"BiXtV+m2wObn9JgMiLLbJ0BJw/8=\");\n_c2 = App;\nvar _c, _c2;\n$RefreshReg$(_c, \"CategoryViewWrapper\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","Search","Star","MessageCircle","Zap","Sparkles","History","X","ArrowLeft","Grid3x3","Heart","User","Menu","Wand2","Button","Input","Badge","Card","CardContent","openOAuthPopup","fetchMe","refreshSession","logout","PlanMindMap","CategoryView","jsxDEV","_jsxDEV","CATEGORY_TO_CAP_MAPPING","API_BASE","_env","import","meta","env","VITE_API_BASE","window","__API_BASE__","translations","en","discover","categories","learn","favorites","signIn","profile","signOut","heroTitle","heroTitleHighlight","heroSubtitle","inputPlaceholder","inputExamples","findTools","recentPrompts","clearAll","loading","errorGeneric","searchPlaceholder","favoritesOnly","journeyTitle","journeySubtitle","resultsTitle","resultsSubtitle","resultsFor","toolsFound","savedCount","assistantSuggestion","copyPasteReady","copy","copied","promptHint","recommendedTools","stepSpecificTools","sharedToolsForStep","usedInXSteps","uniqueTools","sharedAcrossSteps","stepsTotal","aiTool","free","openTool","noLink","save","saved","addToFavorites","removeFromFavorites","readyTitle","readySubtitle","noToolsTitle","noToolsSubtitle","myFavorites","back","noFavoritesTitle","noFavoritesSubtitle","discoverTools","categoriesTitle","categoriesSubtitle","searchCategories","browseCategory","toolsInCategory","totalCategories","totalTools","createAccount","emailPassword","signInWithGoogle","createYourAccount","signInToAccount","yourName","email","password","alreadyHaveAccount","dontHaveAccount","cancel","orContinueWith","google","yourProfile","name","avatarUrl","saveChanges","home","chat","signInFailed","signUpFailed","profileUpdateFailed","copyFailed","executionSummary","executionSummarySubtitle","forSteps","forStep","useTheseTool","useTheseTools","toolRecommendation","bg","detectLanguage","text","trim","length","bulgarianChars","bulgarianMatches","match","bulgarianRatio","FAVS_V2_KEY","FAVS_V1_KEY","RECENT_KEY","RECENT_MAX","LANGUAGE_KEY","groupsFromPlanFallback","plan","byTitle","Map","p","_byTitle$get","title","task","bucket","get","t","tools","set","Array","from","entries","map","values","buildStepPrompt","goal","stepTitle","language","isBg","stepLower","toLowerCase","goalLower","goalPlaceholder","actionablePrompt","includes","toolNames","join","toolGuidance","getCookie","parts","document","cookie","split","part","eq","indexOf","key","decodeURIComponent","slice","val","getViewFromHash","location","hash","startsWith","CategoryViewWrapper","cap","pathPart","substring","fileName","_jsxFileName","lineNumber","columnNumber","_c","goFavorites","goCategories","App","_s2","_s","$RefreshSig$","view","setView","activeTab","setActiveTab","setLanguage","searchQuery","setSearchQuery","chatInput","setChatInput","groups","setGroups","setLoading","error","setError","currentUser","setCurrentUser","lastGoal","setLastGoal","signinOpen","setSigninOpen","signinRef","profileOpen","setProfileOpen","profileRef","mobileMenuOpen","setMobileMenuOpen","showEmailModal","setShowEmailModal","authMode","setAuthMode","authEmail","setAuthEmail","authPassword","setAuthPassword","authName","setAuthName","authSubmitting","setAuthSubmitting","authError","setAuthError","showProfileModal","setShowProfileModal","profName","setProfName","profPic","setProfPic","profSaving","setProfSaving","favs","setFavs","showFavsOnly","setShowFavsOnly","recents","setRecents","handleOpenTool","tool","link","open","buildPromptCallback","goHome","console","log","setTimeout","scrollTo","top","behavior","onHash","newView","addEventListener","removeEventListener","currentHash","savedLang","localStorage","getItem","saveLanguage","lang","setItem","onDocClick","e","current","contains","target","v2raw","arr","JSON","parse","v1raw","names","stringify","removeItem","saveFavs","next","toggleFav","has","delete","icon","raw","pushRecent","prompt","filter","r","removeRecent","clearRecents","fetchPlan","timestamp","Date","now","res","fetch","method","headers","body","user_goal","ok","Error","json","handleFindTools","fromPrompt","detectedLang","data","grouped","handleGoogleSignIn","user","handleSignOut","warn","submitEmailAuth","url","credentials","undefined","status","openProfile","_currentUser$name","_currentUser$picture","picture","saveProfile","xsrf","mounted","u","u2","term","filteredGroups","g","_t$name","favOk","favCount","size","handleChatInputChange","value","handleKeyDown","preventDefault","className","children","onClick","href","ref","src","alt","referrerPolicy","variant","AuthModal","ProfileModal","FavoritesView","CategoriesView","HomeView","active","action","item","IconComponent","placeholder","onChange","type","disabled","autoFocus","onKeyDown","checked","steps","onOpenTool","buildPrompt","ToolCard","isFav","onToggleFav","onError","img","currentTarget","onerror","style","display","rel","id","label","emoji","description","count","gradient","filteredCategories","category","_","i","capParam","newHash","encodeURIComponent","reduce","total","cat","_c2","$RefreshReg$"],"sources":["C:/Users/komun/booking-app/frontend/src/App.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { Search, Star, MessageCircle, Zap, Sparkles, History, X, ArrowLeft, Copy, Check, Grid3x3, Heart, User, Menu, Lightbulb, Wand2 } from 'lucide-react';\r\n\r\nimport { Button } from './components/ui/button';\r\nimport { Input } from './components/ui/input';\r\nimport { Badge } from './components/ui/badge';\r\nimport { Card, CardContent } from './components/ui/card';\r\n\r\nimport { openOAuthPopup, fetchMe, refreshSession, logout } from './auth';\r\nimport PlanMindMap from './components/ui/PlanMindMap';\r\nimport CategoryView from './pages/CategoryView';\r\n\r\n// Mapping –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç App.tsx –∏ cap –ø–∞—Ä–∞–º–µ—Ç—Ä–∏\r\nconst CATEGORY_TO_CAP_MAPPING: Record<string, string> = {\r\n  'assistants-productivity': 'cap:text-explain',\r\n  'text-writing': 'cap:text-edit', \r\n  'images-design': 'cap:image-generate',\r\n  'video-3d': 'cap:video-generate',\r\n  'audio-music': 'cap:voice-generate',\r\n  'business-marketing': 'cap:research-web',\r\n  'coding-development': 'cap:automate-workflow', // –∏–ª–∏ —Å—ä–∑–¥–∞–π –Ω–æ–≤ cap –∑–∞ coding\r\n  'automation-agents': 'cap:automate-workflow',\r\n  'data-analysis': 'cap:slide-generate',\r\n  'education-learning': 'cap:doc-read-pdf', // –∏–ª–∏ —Å—ä–∑–¥–∞–π –Ω–æ–≤ cap\r\n  'health-wellness': 'cap:integrations', // –∏–ª–∏ —Å—ä–∑–¥–∞–π –Ω–æ–≤ cap  \r\n  'specialized-niche': 'cap:integrations'\r\n};\r\n/* ---------- API base ---------- */\r\nconst API_BASE =\r\n  (import.meta as any).env?.VITE_API_BASE ||\r\n  (window as any).__API_BASE__ ||\r\n  'http://127.0.0.1:8000';\r\n\r\n/* ---------- Types matching backend ---------- */\r\ntype Tool = { name: string; link?: string | null; icon?: string | null };\r\ntype Group = { title: string; tools: Tool[] };\r\ntype PlanItem = { task: string; tools: Tool[] };\r\ntype PlanResponse = { goal: string; plan: PlanItem[]; groups?: Group[] };\r\n\r\ntype CurrentUser = {\r\n  id: number;\r\n  email: string;\r\n  name?: string | null;\r\n  picture?: string | null;\r\n} | null;\r\n\r\n/* ---------- Language and Localization ---------- */\r\ntype Language = 'en' | 'bg';\r\n\r\nconst translations = {\r\n  en: {\r\n    // Header\r\n    discover: 'Discover',\r\n    categories: 'Categories',\r\n    learn: 'Learn',\r\n    favorites: 'Favorites',\r\n    signIn: 'Sign In',\r\n    profile: 'Profile',\r\n    signOut: 'Sign Out',\r\n    \r\n    // Hero\r\n    heroTitle: 'Discover AI tools that',\r\n    heroTitleHighlight: 'actually help',\r\n    heroSubtitle: 'From writing essays to creating art, find the perfect AI tools for your goals.',\r\n    inputPlaceholder: 'What do you want to achieve with AI?',\r\n    inputExamples: 'e.g., Write better emails, create a logo, analyze data...',\r\n    findTools: 'Find Tools',\r\n    \r\n    // Recent prompts\r\n    recentPrompts: 'Recent prompts',\r\n    clearAll: 'Clear all',\r\n    \r\n    // Status messages\r\n    loading: 'üîÑ Finding the best tools for you...',\r\n    errorGeneric: '‚ö†Ô∏è Something went wrong while fetching tools.',\r\n    \r\n    // Search and filters\r\n    searchPlaceholder: 'Search tools, categories, or goals...',\r\n    favoritesOnly: 'Favorites only',\r\n    \r\n    // Journey section\r\n    journeyTitle: 'Your AI Journey',\r\n    journeySubtitle: 'Interactive visualization of your personalized AI workflow',\r\n    \r\n    // Results section\r\n    resultsTitle: 'AI Tools & Suggestions',\r\n    resultsSubtitle: 'Detailed step-by-step guide with AI assistance',\r\n    resultsFor: 'Results for',\r\n    toolsFound: 'tools',\r\n    savedCount: 'saved',\r\n    \r\n    // Prompt suggestion\r\n    assistantSuggestion: 'AI Assistant Suggestion',\r\n    copyPasteReady: 'Copy & Paste Ready',\r\n    copy: 'Copy',\r\n    copied: 'Copied!',\r\n    promptHint: 'üí° Copy this prompt and paste it into any AI assistant (ChatGPT, Claude, etc.) for personalized guidance on this step.',\r\n    recommendedTools: 'recommended tools',\r\n    \r\n    // Mind map specific\r\n    stepSpecificTools: 'Step-specific tools',\r\n    sharedToolsForStep: 'Shared tools for this step',\r\n    usedInXSteps: 'Used in {count} steps',\r\n    uniqueTools: 'unique tools',\r\n    sharedAcrossSteps: 'shared across steps',\r\n    stepsTotal: 'steps total',\r\n    \r\n    // Tool cards\r\n    aiTool: 'AI Tool',\r\n    free: 'Free',\r\n    openTool: 'Open Tool',\r\n    noLink: 'No Link Available',\r\n    save: 'Save',\r\n    saved: 'Saved',\r\n    addToFavorites: 'Add to favorites',\r\n    removeFromFavorites: 'Remove from favorites',\r\n    \r\n    // Empty states\r\n    readyTitle: 'Ready to discover AI tools?',\r\n    readySubtitle: 'Tell us what you want to achieve and we\\'ll find the perfect tools for you.',\r\n    noToolsTitle: 'No tools found',\r\n    noToolsSubtitle: 'Try adjusting your search or filters.',\r\n    \r\n    // Favorites page\r\n    myFavorites: 'My Favorites',\r\n    back: 'Back',\r\n    noFavoritesTitle: 'No favorites yet',\r\n    noFavoritesSubtitle: 'Mark tools with the star to save them here for quick access.',\r\n    discoverTools: 'Discover Tools',\r\n    \r\n    // Categories page\r\n    categoriesTitle: 'AI Tool Categories',\r\n    categoriesSubtitle: 'Browse our comprehensive collection of AI tools organized by purpose and functionality.',\r\n    searchCategories: 'Search categories...',\r\n    browseCategory: 'Browse Category',\r\n    toolsInCategory: 'tools in this category',\r\n    totalCategories: 'Categories',\r\n    totalTools: 'Total Tools',\r\n    \r\n    // Auth\r\n    createAccount: 'Create account',\r\n    emailPassword: 'email / password',\r\n    signInWithGoogle: 'Sign in with Google',\r\n    createYourAccount: 'Create your account',\r\n    signInToAccount: 'Sign in to your account',\r\n    yourName: 'Your name (optional)',\r\n    email: 'Email',\r\n    password: 'Password',\r\n    alreadyHaveAccount: 'Already have an account?',\r\n    dontHaveAccount: 'Don\\'t have an account?',\r\n    cancel: 'Cancel',\r\n    orContinueWith: 'or continue with',\r\n    google: 'Google',\r\n    \r\n    // Profile\r\n    yourProfile: 'Your Profile',\r\n    name: 'Name',\r\n    avatarUrl: 'Avatar URL',\r\n    saveChanges: 'Save changes',\r\n    \r\n    // Mobile nav\r\n    home: 'Home',\r\n    chat: 'Chat',\r\n    \r\n    // Errors\r\n    signInFailed: 'Sign in failed. Check backend/.env and CORS.',\r\n    signUpFailed: 'Sign up failed.',\r\n    profileUpdateFailed: 'Profile update failed.',\r\n    copyFailed: 'Copy failed. Please select and copy manually.',\r\n    \r\n    // Execution summary\r\n    executionSummary: 'Execution Summary',\r\n    executionSummarySubtitle: 'Quick overview of your AI workflow',\r\n    forSteps: 'For steps',\r\n    forStep: 'For step',\r\n    useTheseTool: 'use this tool',\r\n    useTheseTools: 'use these tools',\r\n    toolRecommendation: 'Tool Recommendation',\r\n  },\r\n  bg: {\r\n    // Header\r\n    discover: '–û—Ç–∫—Ä–∏–≤–∞–Ω–µ',\r\n    categories: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏',\r\n    learn: '–ù–∞—É—á–∏',\r\n    favorites: '–õ—é–±–∏–º–∏',\r\n    signIn: '–í—Ö–æ–¥',\r\n    profile: '–ü—Ä–æ—Ñ–∏–ª',\r\n    signOut: '–ò–∑—Ö–æ–¥',\r\n    \r\n    // Hero\r\n    heroTitle: '–û—Ç–∫—Ä–∏–π—Ç–µ AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∫–æ–∏—Ç–æ',\r\n    heroTitleHighlight: '–Ω–∞–∏—Å—Ç–∏–Ω–∞ –ø–æ–º–∞–≥–∞—Ç',\r\n    heroSubtitle: '–û—Ç –ø–∏—Å–∞–Ω–µ –Ω–∞ –µ—Å–µ—Ç–∞ –¥–æ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –∏–∑–∫—É—Å—Ç–≤–æ - –Ω–∞–º–µ—Ä–µ—Ç–µ –ø–µ—Ä—Ñ–µ–∫—Ç–Ω–∏—Ç–µ AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –≤–∞—à–∏—Ç–µ —Ü–µ–ª–∏.',\r\n    inputPlaceholder: '–ö–∞–∫–≤–æ –∏—Å–∫–∞—Ç–µ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ —Å AI?',\r\n    inputExamples: '–Ω–∞–ø—Ä., –ü–∏—Å–∞–Ω–µ –Ω–∞ –ø–æ-–¥–æ–±—Ä–∏ –∏–º–µ–π–ª–∏, —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –ª–æ–≥–æ, –∞–Ω–∞–ª–∏–∑ –Ω–∞ –¥–∞–Ω–Ω–∏...',\r\n    findTools: '–ù–∞–º–µ—Ä–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\r\n    \r\n    // Recent prompts\r\n    recentPrompts: '–ü–æ—Å–ª–µ–¥–Ω–∏ –∑–∞—è–≤–∫–∏',\r\n    clearAll: '–ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–∏',\r\n    \r\n    // Status messages\r\n    loading: 'üîÑ –¢—ä—Ä—Å–∏–º –Ω–∞–π-–¥–æ–±—Ä–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –≤–∞—Å...',\r\n    errorGeneric: '‚ö†Ô∏è –í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ—Ç–æ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏—Ç–µ.',\r\n    \r\n    // Search and filters\r\n    searchPlaceholder: '–¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ —Ü–µ–ª–∏...',\r\n    favoritesOnly: '–°–∞–º–æ –ª—é–±–∏–º–∏',\r\n    \r\n    // Journey section\r\n    journeyTitle: '–í–∞—à–µ—Ç–æ AI –ø—ä—Ç–µ—à–µ—Å—Ç–≤–∏–µ',\r\n    journeySubtitle: '–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –≤–∞—à–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω AI —Ä–∞–±–æ—Ç–µ–Ω –ø–æ—Ç–æ–∫',\r\n    \r\n    // Results section\r\n    resultsTitle: 'AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è',\r\n    resultsSubtitle: '–ü–æ–¥—Ä–æ–±–Ω–æ —Å—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å AI –ø–æ–º–æ—â',\r\n    resultsFor: '–†–µ–∑—É–ª—Ç–∞—Ç–∏ –∑–∞',\r\n    toolsFound: '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞',\r\n    savedCount: '–∑–∞–ø–∞–∑–µ–Ω–∏',\r\n    \r\n    // Prompt suggestion\r\n    assistantSuggestion: '–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç AI –∞—Å–∏—Å—Ç–µ–Ω—Ç',\r\n    copyPasteReady: '–ì–æ—Ç–æ–≤–æ –∑–∞ –∫–æ–ø–∏—Ä–∞–Ω–µ',\r\n    copy: '–ö–æ–ø–∏—Ä–∞–π',\r\n    copied: '–ö–æ–ø–∏—Ä–∞–Ω–æ!',\r\n    promptHint: 'üí° –ö–æ–ø–∏—Ä–∞–π—Ç–µ —Ç–æ–∑–∏ –ø—Ä–æ–º–ø—Ç –∏ –≥–æ –ø–æ—Å—Ç–∞–≤–µ—Ç–µ –≤ –Ω—è–∫–æ–π AI –∞—Å–∏—Å—Ç–µ–Ω—Ç (ChatGPT, Claude, –∏ –¥—Ä.) –∑–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–æ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∑–∞ —Ç–∞–∑–∏ —Å—Ç—ä–ø–∫–∞.',\r\n    recommendedTools: '–ø—Ä–µ–ø–æ—Ä—ä—á–∞–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞',\r\n    \r\n    // Mind map specific\r\n    stepSpecificTools: '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ —Ç–∞–∑–∏ —Å—Ç—ä–ø–∫–∞',\r\n    sharedToolsForStep: '–°–ø–æ–¥–µ–ª–µ–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ —Ç–∞–∑–∏ —Å—Ç—ä–ø–∫–∞',\r\n    usedInXSteps: '–ò–∑–ø–æ–ª–∑–≤–∞–Ω –≤ {count} —Å—Ç—ä–ø–∫–∏',\r\n    uniqueTools: '—É–Ω–∏–∫–∞–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞',\r\n    sharedAcrossSteps: '—Å–ø–æ–¥–µ–ª–µ–Ω–∏ –º–µ–∂–¥—É —Å—Ç—ä–ø–∫–∏—Ç–µ',\r\n    stepsTotal: '—Å—Ç—ä–ø–∫–∏ –æ–±—â–æ',\r\n    \r\n    // Tool cards\r\n    aiTool: 'AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç',\r\n    free: '–ë–µ–∑–ø–ª–∞—Ç–µ–Ω',\r\n    openTool: '–û—Ç–≤–æ—Ä–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç',\r\n    noLink: '–ù—è–º–∞ –Ω–∞–ª–∏—á–µ–Ω –ª–∏–Ω–∫',\r\n    save: '–ó–∞–ø–∞–∑–∏',\r\n    saved: '–ó–∞–ø–∞–∑–µ–Ω–æ',\r\n    addToFavorites: '–î–æ–±–∞–≤–∏ –≤ –ª—é–±–∏–º–∏',\r\n    removeFromFavorites: '–ü—Ä–µ–º–∞—Ö–Ω–∏ –æ—Ç –ª—é–±–∏–º–∏',\r\n    \r\n    // Empty states\r\n    readyTitle: '–ì–æ—Ç–æ–≤–∏ –¥–∞ –æ—Ç–∫—Ä–∏–≤–∞–µ—Ç–µ AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏?',\r\n    readySubtitle: '–ö–∞–∂–µ—Ç–µ –Ω–∏ –∫–∞–∫–≤–æ –∏—Å–∫–∞—Ç–µ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ –∏ —â–µ –Ω–∞–º–µ—Ä–∏–º –ø–µ—Ä—Ñ–µ–∫—Ç–Ω–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –≤–∞—Å.',\r\n    noToolsTitle: '–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\r\n    noToolsSubtitle: '–û–ø–∏—Ç–∞–π—Ç–µ –¥–∞ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ —Ç—ä—Ä—Å–µ–Ω–µ—Ç–æ –∏–ª–∏ —Ñ–∏–ª—Ç—Ä–∏—Ç–µ.',\r\n    \r\n    // Favorites page\r\n    myFavorites: '–ú–æ–∏—Ç–µ –ª—é–±–∏–º–∏',\r\n    back: '–ù–∞–∑–∞–¥',\r\n    noFavoritesTitle: '–û—â–µ –Ω—è–º–∞ –ª—é–±–∏–º–∏',\r\n    noFavoritesSubtitle: '–ú–∞—Ä–∫–∏—Ä–∞–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Å—ä—Å –∑–≤–µ–∑–¥–∏—á–∫–∞—Ç–∞, –∑–∞ –¥–∞ –≥–∏ –∑–∞–ø–∞–∑–∏—Ç–µ —Ç—É–∫ –∑–∞ –±—ä—Ä–∑ –¥–æ—Å—Ç—ä–ø.',\r\n    discoverTools: '–û—Ç–∫—Ä–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\r\n    \r\n    // Categories page\r\n    categoriesTitle: 'AI –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\r\n    categoriesSubtitle: '–†–∞–∑–≥–ª–µ–¥–∞–π—Ç–µ –Ω–∞—à–∞—Ç–∞ –æ–±—à–∏—Ä–Ω–∞ –∫–æ–ª–µ–∫—Ü–∏—è –æ—Ç AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –æ—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–Ω–∏ –ø–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç.',\r\n    searchCategories: '–¢—ä—Ä—Å–µ–Ω–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...',\r\n    browseCategory: '–†–∞–∑–≥–ª–µ–¥–∞–π –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\r\n    toolsInCategory: '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤ —Ç–∞–∑–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\r\n    totalCategories: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏',\r\n    totalTools: '–û–±—â–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\r\n    \r\n    // Auth\r\n    createAccount: '–°—ä–∑–¥–∞–π –ø—Ä–æ—Ñ–∏–ª',\r\n    emailPassword: '–∏–º–µ–π–ª / –ø–∞—Ä–æ–ª–∞',\r\n    signInWithGoogle: '–í—Ö–æ–¥ —Å Google',\r\n    createYourAccount: '–°—ä–∑–¥–∞–π—Ç–µ –≤–∞—à–∏—è –ø—Ä–æ—Ñ–∏–ª',\r\n    signInToAccount: '–í–ª–µ–∑—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª–∞ —Å–∏',\r\n    yourName: '–í–∞—à–µ—Ç–æ –∏–º–µ (–ø–æ –∏–∑–±–æ—Ä)',\r\n    email: '–ò–º–µ–π–ª',\r\n    password: '–ü–∞—Ä–æ–ª–∞',\r\n    alreadyHaveAccount: '–í–µ—á–µ –∏–º–∞—Ç–µ –ø—Ä–æ—Ñ–∏–ª?',\r\n    dontHaveAccount: '–ù—è–º–∞—Ç–µ –ø—Ä–æ—Ñ–∏–ª?',\r\n    cancel: '–û—Ç–∫–∞–∑',\r\n    orContinueWith: '–∏–ª–∏ –ø—Ä–æ–¥—ä–ª–∂–µ—Ç–µ —Å',\r\n    google: 'Google',\r\n    \r\n    // Profile\r\n    yourProfile: '–í–∞—à–∏—è—Ç –ø—Ä–æ—Ñ–∏–ª',\r\n    name: '–ò–º–µ',\r\n    avatarUrl: 'URL –Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞',\r\n    saveChanges: '–ó–∞–ø–∞–∑–∏ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ',\r\n    \r\n    // Mobile nav\r\n    home: '–ù–∞—á–∞–ª–æ',\r\n    chat: '–ß–∞—Ç',\r\n    \r\n    // Errors\r\n    signInFailed: '–ù–µ—É—Å–ø–µ—à–µ–Ω –≤—Ö–æ–¥. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ backend/.env –∏ CORS.',\r\n    signUpFailed: '–ù–µ—É—Å–ø–µ—à–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è.',\r\n    profileUpdateFailed: '–ù–µ—É—Å–ø–µ—à–Ω–æ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞.',\r\n    copyFailed: '–ù–µ—É—Å–ø–µ—à–Ω–æ –∫–æ–ø–∏—Ä–∞–Ω–µ. –ú–æ–ª—è, —Å–µ–ª–µ–∫—Ç–∏—Ä–∞–π—Ç–µ –∏ –∫–æ–ø–∏—Ä–∞–π—Ç–µ —Ä—ä—á–Ω–æ.',\r\n    \r\n    // Execution summary\r\n    executionSummary: '–ò–∑–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω –ø—Ä–µ–≥–ª–µ–¥',\r\n    executionSummarySubtitle: '–ë—ä—Ä–∑ –ø—Ä–µ–≥–ª–µ–¥ –Ω–∞ –≤–∞—à–∏—è AI —Ä–∞–±–æ—Ç–µ–Ω –ø–æ—Ç–æ–∫',\r\n    forSteps: '–ó–∞ —Å—Ç—ä–ø–∫–∏',\r\n    forStep: '–ó–∞ —Å—Ç—ä–ø–∫–∞',\r\n    useTheseTool: '–∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Ç–æ–∑–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç',\r\n    useTheseTools: '–∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Ç–µ–∑–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\r\n    toolRecommendation: '–ü—Ä–µ–ø–æ—Ä—ä–∫–∞ –∑–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏',\r\n  }\r\n};\r\n\r\n// Language detection function\r\nfunction detectLanguage(text: string): Language {\r\n  if (!text || text.trim().length < 3) return 'en';\r\n  \r\n  // Bulgarian characters detection\r\n  const bulgarianChars = /[–∞-—è]/gi;\r\n  const bulgarianMatches = text.match(bulgarianChars);\r\n  const bulgarianRatio = bulgarianMatches ? bulgarianMatches.length / text.length : 0;\r\n  \r\n  // If more than 20% of characters are Cyrillic, consider it Bulgarian\r\n  return bulgarianRatio > 0.2 ? 'bg' : 'en';\r\n}\r\n\r\n/* ---------- Favorites v2 (persist full tool) ---------- */\r\ntype FavTool = { name: string; icon?: string | null; link?: string | null };\r\nconst FAVS_V2_KEY = 'myai:favs_v2';\r\nconst FAVS_V1_KEY = 'myai:favs';\r\n\r\n/* ---------- Recent prompts ---------- */\r\nconst RECENT_KEY = 'myai:recent_prompts';\r\nconst RECENT_MAX = 6;\r\n\r\n/* ---------- Language preference ---------- */\r\nconst LANGUAGE_KEY = 'myai:language';\r\n\r\n/* ---------- Helpers ---------- */\r\nfunction groupsFromPlanFallback(plan: PlanItem[]): Group[] {\r\n  const byTitle = new Map<string, Map<string, Tool>>();\r\n  for (const p of plan) {\r\n    const title = p.task;\r\n    const bucket = byTitle.get(title) ?? new Map<string, Tool>();\r\n    for (const t of p.tools) bucket.set(t.name, t);\r\n    byTitle.set(title, bucket);\r\n  }\r\n  return Array.from(byTitle.entries()).map(([title, bucket]) => ({\r\n    title,\r\n    tools: Array.from(bucket.values()),\r\n  }));\r\n}\r\n\r\n// Enhanced suggested prompt builder with language support\r\n// Enhanced suggested prompt builder with language support and step-specific context\r\n// Direct actionable prompt builder that creates copy-paste ready prompts\r\nfunction buildStepPrompt(goal: string, stepTitle: string, tools: Tool[], language: Language) {\r\n  const isBg = language === 'bg';\r\n  \r\n  // Normalize goal and step for analysis\r\n  const stepLower = stepTitle.toLowerCase();\r\n  const goalLower = goal.toLowerCase();\r\n  \r\n  // Create placeholder for user's specific context\r\n  const goalPlaceholder = goal || (isBg ? '[–≤–∞—à–∞—Ç–∞ —Ü–µ–ª/–ø—Ä–æ–¥—É–∫—Ç/—É—Å–ª—É–≥–∞]' : '[your goal/product/service]');\r\n  \r\n  // Generate specific, actionable prompts based on step content\r\n  let actionablePrompt = '';\r\n  \r\n  // Research steps\r\n  if (stepLower.includes('–∏–∑—Å–ª–µ–¥–≤') || stepLower.includes('–ø—Ä–æ—É—á') || stepLower.includes('research') || \r\n      stepLower.includes('–∞–Ω–∞–ª–∏–∑') || stepLower.includes('analyze') || stepLower.includes('–∞—É–¥–∏—Ç–æ—Ä–∏—è')) {\r\n    \r\n    if (stepLower.includes('–∞—É–¥–∏—Ç–æ—Ä–∏—è') || stepLower.includes('audience') || stepLower.includes('–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç') || stepLower.includes('competitor')) {\r\n      actionablePrompt = isBg \r\n        ? `–ù–∞–ø—Ä–∞–≤–∏ –ø–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ—É—á–≤–∞–Ω–µ –Ω–∞ —Ü–µ–ª–µ–≤–∞—Ç–∞ –∞—É–¥–∏—Ç–æ—Ä–∏—è –∑–∞ ${goalPlaceholder}, –∫–∞—Ç–æ –≤–∫–ª—é—á–∏—à –¥–µ–º–æ–≥—Ä–∞—Ñ—Å–∫–∏ –¥–∞–Ω–Ω–∏, –ø—Å–∏—Ö–æ–≥—Ä–∞—Ñ—Å–∫–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏ –º–æ–¥–µ–ª–∏ –∏ –æ—Å–Ω–æ–≤–Ω–∏ –±–æ–ª–∫–∏/–∂–µ–ª–∞–Ω–∏—è. –°–ª–µ–¥ —Ç–æ–≤–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∏—Ç–µ (–º–µ—Å—Ç–Ω–∏ –∏ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∏), –æ–ø–∏—à–∏ —Ç–µ—Ö–Ω–∏—Ç–µ —Å–∏–ª–Ω–∏ –∏ —Å–ª–∞–±–∏ —Å—Ç—Ä–∞–Ω–∏, —Ü–µ–Ω–æ–≤–∞ –ø–æ–ª–∏—Ç–∏–∫–∞, –∫–∞–Ω–∞–ª–∏ –∑–∞ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—è –∏ —É–Ω–∏–∫–∞–ª–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ. –ó–∞–≤—ä—Ä—à–∏ —Å –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∫–∞–∫ –º–æ—è—Ç –±–∏–∑–Ω–µ—Å –º–æ–∂–µ –¥–∞ —Å–µ –æ—Ç–ª–∏—á–∏.`\r\n        : `Conduct detailed research on the target audience for ${goalPlaceholder}, including demographic data, psychographic characteristics, behavioral patterns, and main pain points/desires. Then analyze competitors (local and international), describe their strengths and weaknesses, pricing policy, communication channels, and unique value proposition. End with recommendations on how my business can differentiate itself.`;\r\n    } else if (stepLower.includes('–ø–∞–∑–∞—Ä') || stepLower.includes('market') || stepLower.includes('—Ç–µ–Ω–¥–µ–Ω') || stepLower.includes('trend')) {\r\n      actionablePrompt = isBg \r\n        ? `–ê–Ω–∞–ª–∏–∑–∏—Ä–∞–π –ø–∞–∑–∞—Ä–Ω–∏—Ç–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞ ${goalPlaceholder}. –ü—Ä–æ—É—á–∏ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –ø–∞–∑–∞—Ä–∞, —Ç–µ–º–ø–æ–≤–µ—Ç–µ –Ω–∞ —Ä–∞—Å—Ç–µ–∂, –∫–ª—é—á–æ–≤–∏—Ç–µ –∏–≥—Ä–∞—á–∏, —Ä–µ–≥—É–ª–∞—Ç–æ—Ä–Ω–∏—Ç–µ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω–∏—Ç–µ –ø—Ä–æ–º–µ–Ω–∏. –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–π –Ω–∏—à–æ–≤–∏ —Å–µ–≥–º–µ–Ω—Ç–∏, –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏ –Ω—É–∂–¥–∏ –∏ –±—ä–¥–µ—â–∏ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –¥–∞–Ω–Ω–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –∏–∑—Ç–æ—á–Ω–∏—Ü–∏, –∏ –∑–∞–≤—ä—Ä—à–∏ —Å –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –ø–∞–∑–∞—Ä–Ω–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–∞–Ω–µ.`\r\n        : `Analyze market trends and opportunities for ${goalPlaceholder}. Research market size, growth rates, key players, regulatory requirements, and technological changes. Identify niche segments, unmet needs, and future opportunities. Provide specific data, statistics, and sources, and conclude with market positioning recommendations.`;\r\n    } else {\r\n      actionablePrompt = isBg \r\n        ? `–ü—Ä–æ–≤–µ–¥–∏ –∑–∞–¥—ä–ª–±–æ—á–µ–Ω–æ –∏–∑—Å–ª–µ–¥–≤–∞–Ω–µ –∑–∞ ${goalPlaceholder}. –°—ä–±–µ—Ä–∏ –∞–∫—Ç—É–∞–ª–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç –Ω–∞–¥–µ–∂–¥–Ω–∏ sources, –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–π –Ω–∞–π-–¥–æ–±—Ä–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏—è—Ç–∞, –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–π –∫–ª—é—á–æ–≤–∏—Ç–µ —É—Å–ø–µ—à–Ω–∏ —Ñ–∞–∫—Ç–æ—Ä–∏ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏—Ç–µ —Ä–∏—Å–∫–æ–≤–µ. –°—ä–∑–¥–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω –¥–æ–∫–ª–∞–¥ —Å –æ—Å–Ω–æ–≤–Ω–∏ –Ω–∞—Ö–æ–¥–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ —Å–ª–µ–¥–≤–∞—â–∏ —Å—Ç—ä–ø–∫–∏.`\r\n        : `Conduct in-depth research on ${goalPlaceholder}. Gather current information from reliable sources, analyze industry best practices, identify key success factors and potential risks. Create a structured report with key findings, statistics, and recommendations for next steps.`;\r\n    }\r\n  }\r\n  \r\n  // Creative/Design steps\r\n  else if (stepLower.includes('—Å—ä–∑–¥–∞') || stepLower.includes('–≥–µ–Ω–µ—Ä–∏—Ä') || stepLower.includes('create') || \r\n           stepLower.includes('–¥–∏–∑–∞–π–Ω') || stepLower.includes('design') || stepLower.includes('–∫–æ–Ω—Ü–µ–ø—Ü') || stepLower.includes('concept')) {\r\n    \r\n    if (stepLower.includes('–ª–æ–≥–æ') || stepLower.includes('logo') || stepLower.includes('–±—Ä–∞–Ω–¥') || stepLower.includes('brand')) {\r\n      actionablePrompt = isBg \r\n        ? `–°—ä–∑–¥–∞–π –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –∑–∞ –ª–æ–≥–æ –∏ –≤–∏–∑—É–∞–ª–Ω–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç –∑–∞ ${goalPlaceholder}. –û–ø–∏—à–∏ 3-5 —Ä–∞–∑–ª–∏—á–Ω–∏ –¥–∏–∑–∞–π–Ω–µ—Ä—Å–∫–∏ –ø–æ—Å–æ–∫–∏, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ —Ü–≤–µ—Ç–æ–≤–∞ –ø–∞–ª–∏—Ç—Ä–∞, —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏—è, —Å—Ç–∏–ª –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ. –ó–∞ –≤—Å—è–∫–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –æ–±—è—Å–Ω–∏ —Å–∏–º–≤–æ–ª–∏–∫–∞—Ç–∞, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ—Ç–æ –≤—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∫–∞–∫ –æ—Ç—Ä–∞–∑—è–≤–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ –±—Ä–∞–Ω–¥–∞. –î–æ–±–∞–≤–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ –Ω–æ—Å–∏—Ç–µ–ª–∏ (—É–µ–±, –ø–µ—á–∞—Ç, —Å–æ—Ü–∏–∞–ª–Ω–∏ –º—Ä–µ–∂–∏) –∏ —Ñ–∞–π–ª–æ–≤–∏ —Ñ–æ—Ä–º–∞—Ç–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ.`\r\n        : `Create a logo and visual identity concept for ${goalPlaceholder}. Describe 3-5 different design directions, including color palette, typography, style, and mood. For each concept, explain the symbolism, psychological impact, and how it reflects the brand values. Add recommendations for application across different media (web, print, social media) and file formats for execution.`;\r\n    } else if (stepLower.includes('–∫–æ–Ω—Ç–µ–Ω—Ç') || stepLower.includes('content') || stepLower.includes('–º–∞—Ç–µ—Ä–∏–∞–ª') || stepLower.includes('–∫–∞–º–ø–∞–Ω') || stepLower.includes('campaign')) {\r\n      actionablePrompt = isBg \r\n        ? `–°—ä–∑–¥–∞–π –Ω–∞–±–æ—Ä –æ—Ç –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∏ –∑–∞ ${goalPlaceholder}, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ: —Å–ª–æ–≥–∞–Ω, –∫–ª—é—á–æ–≤–∏ –ø–æ—Å–ª–∞–Ω–∏—è, —Ç–µ–∫—Å—Ç–æ–≤–µ –∑–∞ —Å–æ—Ü–∏–∞–ª–Ω–∏ –º—Ä–µ–∂–∏, –∏–º–µ–π–ª –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –∫—Ä–∞—Ç–∫–æ –≤–∏–¥–µ–æ-—Å—Ü–µ–Ω–∞—Ä–∏–π. –ú–∞—Ç–µ—Ä–∏–∞–ª–∏—Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–∞ —Å—ä–æ–±—Ä–∞–∑–µ–Ω–∏ —Å —Ü–µ–ª–µ–≤–∞—Ç–∞ –∞—É–¥–∏—Ç–æ—Ä–∏—è, –¥–∞ –ø–æ–¥—á–µ—Ä—Ç–∞–≤–∞—Ç —É–Ω–∏–∫–∞–ª–Ω–æ—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏ –¥–∞ –ø—Ä–µ–¥–∏–∑–≤–∏–∫–≤–∞—Ç –µ–º–æ—Ü–∏—è –∏ –∞–Ω–≥–∞–∂–∏—Ä–∞–Ω–æ—Å—Ç. –î–∞–π –º–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∑–∞ —Ä–µ–∫–ª–∞–º–Ω–∏ –∫–∞–º–ø–∞–Ω–∏–∏ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∫–∞–Ω–∞–ª–∏ (Facebook, Instagram, Google Ads, TikTok –∏ –¥—Ä.), –±—é–¥–∂–µ—Ç–∏ –∏ –æ—á–∞–∫–≤–∞–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏.`\r\n        : `Create a set of marketing materials for ${goalPlaceholder}, including: slogan, key messages, social media copy, email campaigns, and a short video script. Materials should be tailored to the target audience, highlight the unique value proposition, and evoke emotion and engagement. Also provide advertising campaign suggestions with specific channels (Facebook, Instagram, Google Ads, TikTok, etc.), budgets, and expected results.`;\r\n    } else {\r\n      actionablePrompt = isBg \r\n        ? `–†–∞–∑—Ä–∞–±–æ—Ç–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –∑–∞ ${goalPlaceholder}. –°—ä–∑–¥–∞–π 3 —Ä–∞–∑–ª–∏—á–Ω–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –≤–∏–∑—É–∞–ª–Ω–∏—Ç–µ –µ–ª–µ–º–µ–Ω—Ç–∏, —Ü–≤–µ—Ç–æ–≤–∞ —Å—Ö–µ–º–∞, —Å—Ç–∏–ª –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ. –ó–∞ –≤—Å–µ–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç –æ–±—è—Å–Ω–∏ —Ü–µ–ª–µ–≤–∞—Ç–∞ –∞—É–¥–∏—Ç–æ—Ä–∏—è, –∫–ª—é—á–æ–≤–∏—Ç–µ —Å—ä–æ–±—â–µ–Ω–∏—è –∏ –æ—á–∞–∫–≤–∞–Ω–æ—Ç–æ –≤—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ. –í–∫–ª—é—á–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∏ –∏ –≤—Ä–µ–º–µ –∑–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è.`\r\n        : `Develop a creative concept for ${goalPlaceholder}. Create 3 different variants with detailed description of visual elements, color scheme, style, and mood. For each variant, explain the target audience, key messages, and expected impact. Include specific implementation recommendations, required resources, and timeline for execution.`;\r\n    }\r\n  }\r\n  \r\n  // Strategy/Planning steps\r\n  else if (stepLower.includes('–ø–ª–∞–Ω') || stepLower.includes('—Å—Ç—Ä–∞—Ç–µ–≥') || stepLower.includes('plan') || \r\n           stepLower.includes('strategy') || stepLower.includes('–æ—Ä–≥–∞–Ω–∏') || stepLower.includes('organize')) {\r\n    \r\n    actionablePrompt = isBg \r\n      ? `–°—ä–∑–¥–∞–π –¥–µ—Ç–∞–π–ª–µ–Ω —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏ –ø–ª–∞–Ω –∑–∞ ${goalPlaceholder}. –í–∫–ª—é—á–∏: –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ —Ü–µ–ª–∏ —Å –≤—Ä–µ–º–µ–≤–∏ —Ä–∞–º–∫–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∏ –∏ –±—é–¥–∂–µ—Ç, –∫–ª—é—á–æ–≤–∏ –¥–µ–π—Å—Ç–≤–∏—è –∏ –º–∏–ª–µ—Å—Ç—ä–Ω–∏, –æ—Ç–≥–æ–≤–æ—Ä–Ω–∏ –ª–∏—Ü–∞/—Ä–æ–ª–∏, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ —Ä–∏—Å–∫–æ–≤–µ –∏ –º–µ—Ä–∫–∏ –∑–∞ —Ç—è—Ö–Ω–æ—Ç–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–∞–Ω–µ. –î–æ–±–∞–≤–∏ KPI –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ –∏–∑–º–µ—Ä–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å–∞ –∏ –ø–ª–∞–Ω –∑–∞ —Ä–µ–¥–æ–≤–Ω–æ —Ä–µ–≤—é –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ç–∞.`\r\n      : `Create a detailed strategic plan for ${goalPlaceholder}. Include: specific goals with timelines, required resources and budget, key activities and milestones, responsible persons/roles, potential risks and mitigation measures. Add KPI metrics for measuring progress and a plan for regular review and strategy updates.`;\r\n  }\r\n  \r\n  // Implementation/Execution steps\r\n  else if (stepLower.includes('–∏–∑–ø—ä–ª–Ω') || stepLower.includes('—Ä–µ–∞–ª–∏–∑') || stepLower.includes('implement') || \r\n           stepLower.includes('execute') || stepLower.includes('build') || stepLower.includes('develop')) {\r\n    \r\n    actionablePrompt = isBg \r\n      ? `–°—ä–∑–¥–∞–π –ø–æ–¥—Ä–æ–±–µ–Ω –ø–ª–∞–Ω –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω–∞ ${goalPlaceholder}. –†–∞–∑–±–∏–π –ø—Ä–æ—Ü–µ—Å–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∑–∞–¥–∞—á–∏ —Å—ä—Å —Å—Ä–æ–∫–æ–≤–µ, –¥–µ—Ñ–∏–Ω–∏—Ä–∞–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏—Ç–µ —Ä–µ—Å—É—Ä—Å–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Å—ä–∑–¥–∞–π –≤—Ä–µ–º–µ–≤–∞ –ª–∏–Ω–∏—è —Å –∫—Ä–∏—Ç–∏—á–Ω–∏ –º–æ–º–µ–Ω—Ç–∏. –í–∫–ª—é—á–∏ –∫–æ–Ω—Ç—Ä–æ–ª–Ω–∏ —Ç–æ—á–∫–∏ –∑–∞ –∫–∞—á–µ—Å—Ç–≤–æ, –≤—ä–∑–º–æ–∂–Ω–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –∏ –∞–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏ —Ä–µ—à–µ–Ω–∏—è. –î–æ–±–∞–≤–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –µ–∫–∏–ø, –±—é–¥–∂–µ—Ç –∏ –º–µ—Ç–æ–¥–∏ –∑–∞ –ø—Ä–æ—Å–ª–µ–¥—è–≤–∞–Ω–µ –Ω–∞ –Ω–∞–ø—Ä–µ–¥—ä–∫–∞.`\r\n      : `Create a detailed execution plan for ${goalPlaceholder}. Break down the process into specific tasks with deadlines, define required resources and tools, create a timeline with critical moments. Include quality checkpoints, possible obstacles, and alternative solutions. Add recommendations for team, budget, and progress tracking methods.`;\r\n  }\r\n  \r\n  // Testing/Validation steps\r\n  else if (stepLower.includes('—Ç–µ—Å—Ç') || stepLower.includes('–ø—Ä–æ–≤–µ—Ä') || stepLower.includes('test') || \r\n           stepLower.includes('validate') || stepLower.includes('–æ—Ü–µ–Ω–∫') || stepLower.includes('evaluate')) {\r\n    \r\n    actionablePrompt = isBg \r\n      ? `–°—ä–∑–¥–∞–π –ø–ª–∞–Ω –∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ ${goalPlaceholder}. –î–µ—Ñ–∏–Ω–∏—Ä–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞ —É—Å–ø–µ—Ö, –º–µ—Ç–æ–¥–∏ –∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ (A/B —Ç–µ—Å—Ç–æ–≤–µ, –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –∏–Ω—Ç–µ—Ä–≤—é—Ç–∞, –ø–∏–ª–æ—Ç–Ω–∏ –ø—Ä–æ–≥—Ä–∞–º–∏), –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏. –û–ø–∏—à–∏ –∫–∞–∫ –¥–∞ —Å—ä–±–∏—Ä–∞—à –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞—à –æ–±—Ä–∞—Ç–Ω–∞—Ç–∞ –≤—Ä—ä–∑–∫–∞, –∫–∞–∫ –¥–∞ –∏—Ç–µ—Ä–∏—Ä–∞—à –±–∞–∑–∏—Ä–∞–Ω–æ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ –∏ –∫–∞–∫–≤–∏ –∫–æ—Ä–µ–∫—Ü–∏–∏ –¥–∞ –ø—Ä–∞–≤–∏—à –ø—Ä–µ–¥–∏ —Ñ–∏–Ω–∞–ª–Ω–æ—Ç–æ –ø—É—Å–∫–∞–Ω–µ.`\r\n      : `Create a testing and validation plan for ${goalPlaceholder}. Define specific success criteria, testing methods (A/B tests, user interviews, pilot programs), required tools and metrics. Describe how to collect and analyze feedback, how to iterate based on results, and what corrections to make before final launch.`;\r\n  }\r\n  \r\n  // Launch/Finalization steps\r\n  else if (stepLower.includes('–ø—É—Å–∫–∞') || stepLower.includes('–ª–∞–Ω—Å–∏—Ä') || stepLower.includes('launch') || \r\n           stepLower.includes('—Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä') || stepLower.includes('–∑–∞–≤—ä—Ä—à') || stepLower.includes('complete') ||\r\n           stepLower.includes('–ø—É–±–ª–∏–∫') || stepLower.includes('publish')) {\r\n    \r\n    actionablePrompt = isBg \r\n      ? `–ù–∞–ø—Ä–∞–≤–∏ –ø–ª–∞–Ω –∑–∞ –ª–∞–Ω—Å–∏—Ä–∞–Ω–µ –Ω–∞ ${goalPlaceholder}, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –≤—Ä–µ–º–µ–≤–∞ –ª–∏–Ω–∏—è, —Å—Ç—ä–ø–∫–∏ –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞, —Å—ä–¥—ä—Ä–∂–∞—Ç–µ–ª–µ–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä –∑–∞ —Å–æ—Ü–∏–∞–ª–Ω–∏—Ç–µ –º—Ä–µ–∂–∏, PR —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∏ –≤—ä–∑–º–æ–∂–Ω–∏ –ø–∞—Ä—Ç–Ω—å–æ—Ä—Å—Ç–≤–∞/–∏–Ω—Ñ–ª—É–µ–Ω—Å—ä—Ä–∏. –û–ø–∏—à–∏ –∫–∞–∫ –¥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–∞–º–µ –æ–Ω–ª–∞–π–Ω –∏ –æ—Ñ–ª–∞–π–Ω –¥–µ–π–Ω–æ—Å—Ç–∏—Ç–µ, –∫–∞–∫ –¥–∞ –∏–∑–≥—Ä–∞–¥—è –æ—á–∞–∫–≤–∞–Ω–µ –ø—Ä–µ–¥–∏ –ª–∞–Ω—Å–∏—Ä–∞–Ω–µ—Ç–æ –∏ –∫–∞–∫ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ –≤–∏–¥–∏–º–æ—Å—Ç –≤ –ø—ä—Ä–≤–∏—Ç–µ 30 –¥–Ω–∏.`\r\n      : `Create a launch plan for ${goalPlaceholder}, including timeline, preparation steps, social media content calendar, PR strategy, and potential partnerships/influencers. Describe how to synchronize online and offline activities, how to build anticipation before launch, and how to achieve maximum visibility in the first 30 days.`;\r\n  }\r\n  \r\n  // Monitoring/Optimization steps\r\n  else if (stepLower.includes('–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥') || stepLower.includes('—Å–ª–µ–¥–µ–Ω') || stepLower.includes('monitor') || \r\n           stepLower.includes('–∞–Ω–∞–ª–∏–∑') || stepLower.includes('–ø–æ–¥–æ–±—Ä') || stepLower.includes('optimize') ||\r\n           stepLower.includes('—Ä–µ–∑—É–ª—Ç–∞—Ç') || stepLower.includes('result')) {\r\n    \r\n    actionablePrompt = isBg \r\n      ? `–ü—Ä–µ–¥–ª–æ–∂–∏ —Å–∏—Å—Ç–µ–º–∞ –∑–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ –æ—Ç ${goalPlaceholder}. –û–ø–∏—à–∏ –∫–æ–∏ KPI –¥–∞ —Å–ª–µ–¥—è (—Ç—Ä–∞—Ñ–∏–∫, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, CAC, ROI, –∞–Ω–≥–∞–∂–∏—Ä–∞–Ω–æ—Å—Ç, –æ—Ç–∑–∏–≤–∏), –∫–∞–∫–≤–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º (Google Analytics, Meta Ads Manager, CRM –∏ –¥—Ä.), –∫–∞–∫ –¥–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–º –¥–∞–Ω–Ω–∏—Ç–µ –∏ –∫–∞–∫–≤–∏ —Å—Ç—ä–ø–∫–∏ –∑–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–≥–∞ –¥–∞ –ø—Ä–µ–¥–ø—Ä–∏–µ–º–∞–º. –î–æ–±–∞–≤–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∏–¥–µ–∏ –∑–∞ A/B —Ç–µ—Å—Ç–æ–≤–µ, –∑–∞ –¥–∞ –ø–æ–¥–æ–±—Ä—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—Ç–∞.`\r\n      : `Suggest a system for monitoring results from ${goalPlaceholder}. Describe which KPIs to track (traffic, conversions, CAC, ROI, engagement, reviews), what tools to use (Google Analytics, Meta Ads Manager, CRM, etc.), how to analyze data, and what optimization steps I can take. Also add specific A/B test ideas to improve effectiveness.`;\r\n  }\r\n  \r\n  // Generic fallback\r\n  else {\r\n    actionablePrompt = isBg \r\n      ? `–°—ä–∑–¥–∞–π –¥–µ—Ç–∞–π–ª–µ–Ω –ø–ª–∞–Ω –∑–∞ \"${stepTitle}\" –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ ${goalPlaceholder}. –í–∫–ª—é—á–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ —Å—Ç—ä–ø–∫–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –≤—Ä–µ–º–µ–≤–∏ —Ä–∞–º–∫–∏, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ –ø—Ä–µ–¥–∏–∑–≤–∏–∫–∞—Ç–µ–ª—Å—Ç–≤–∞ –∏ –∫–∞–∫ –¥–∞ –≥–∏ –ø—Ä–µ–æ–¥–æ–ª–µ–µ–º. –î–æ–±–∞–≤–∏ –∏–∑–º–µ—Ä–∏–º–∏ —Ü–µ–ª–∏, –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞ —É—Å–ø–µ—Ö –∏ –ø–ª–∞–Ω –∑–∞ –ø—Ä–æ—Å–ª–µ–¥—è–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å–∞.`\r\n      : `Create a detailed plan for \"${stepTitle}\" in the context of ${goalPlaceholder}. Include specific execution steps, required resources and tools, timelines, potential challenges and how to overcome them. Add measurable goals, success criteria, and a progress tracking plan.`;\r\n  }\r\n  \r\n  // Add tool-specific guidance if tools are available\r\n  if (tools.length > 0) {\r\n    const toolNames = tools.map(t => t.name).join(', ');\r\n    const toolGuidance = isBg \r\n      ? `\\n\\n–ü—Ä–∏ —Ä–∞–±–æ—Ç–∞—Ç–∞ –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–ª–µ–¥–Ω–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏: ${toolNames}. –ó–∞ –≤—Å–µ–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ–±—è—Å–Ω–∏ –∫–∞–∫ —Ç–æ—á–Ω–æ –¥–∞ –≥–æ –∏–∑–ø–æ–ª–∑–≤–∞–º –∑–∞ —Ç–∞–∑–∏ –∑–∞–¥–∞—á–∞, –∫–∞–∫–≤–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∞ –Ω–∞–π-–ø–æ–ª–µ–∑–Ω–∏ –∏ –∫–∞–∫ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–∞ –Ω–∞–π-–¥–æ–±—Ä–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏.`\r\n      : `\\n\\nUse these tools in your work: ${toolNames}. For each tool, explain exactly how to use it for this task, which features are most useful, and how to achieve the best results.`;\r\n    actionablePrompt += toolGuidance;\r\n  }\r\n  \r\n  return actionablePrompt;\r\n}\r\n\r\n// read a cookie by name (for XSRF)\r\nfunction getCookie(name: string) {\r\n  const parts = document.cookie ? document.cookie.split('; ') : [];\r\n  for (const part of parts) {\r\n    const eq = part.indexOf('=');\r\n    const key = decodeURIComponent(eq > -1 ? part.slice(0, eq) : part);\r\n    if (key === name) {\r\n      const val = eq > -1 ? part.slice(eq + 1) : '';\r\n      return decodeURIComponent(val);\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n/* ---------- Simple hash router ---------- */\r\ntype View = 'home' | 'favorites' | 'categories'| 'category';\r\nfunction getViewFromHash(): View {\r\n  if (window.location.hash === '#/favorites') return 'favorites';\r\n  if (window.location.hash === '#/categories') return 'categories';\r\n  if (window.location.hash.startsWith('#/categories/')) return 'category';\r\n  return 'home';\r\n}\r\n\r\nfunction CategoryViewWrapper() {\r\n  const hash = window.location.hash;\r\n  \r\n  let cap = '';\r\n  if (hash.startsWith('#/categories/')) {\r\n    const pathPart = hash.substring('#/categories/'.length);\r\n    cap = decodeURIComponent(pathPart);\r\n  }\r\n  \r\n  return <CategoryView cap={cap} />;\r\n}\r\n\r\nfunction goFavorites() {\r\n  if (window.location.hash !== '#/favorites') window.location.hash = '#/favorites';\r\n}\r\nfunction goCategories() {\r\n  if (window.location.hash !== '#/categories') window.location.hash = '#/categories';\r\n}\r\n\r\nexport default function App() {\r\n  const [view, setView] = useState<View>(getViewFromHash());\r\n  const [activeTab, setActiveTab] = useState('Home');\r\n  const [language, setLanguage] = useState<Language>('en');\r\n\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [chatInput, setChatInput] = useState('');\r\n  const [groups, setGroups] = useState<Group[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [currentUser, setCurrentUser] = useState<CurrentUser>(null);\r\n\r\n  // >>> store last goal for visual plan + prompts\r\n  const [lastGoal, setLastGoal] = useState<string>('');\r\n\r\n  // dropdowns\r\n  const [signinOpen, setSigninOpen] = useState(false);\r\n  const signinRef = useRef<HTMLDivElement>(null);\r\n  const [profileOpen, setProfileOpen] = useState(false);\r\n  const profileRef = useRef<HTMLDivElement>(null);\r\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\r\n\r\n  // Email modal\r\n  const [showEmailModal, setShowEmailModal] = useState(false);\r\n  const [authMode, setAuthMode] = useState<'signup' | 'signin'>('signup');\r\n  const [authEmail, setAuthEmail] = useState('');\r\n  const [authPassword, setAuthPassword] = useState('');\r\n  const [authName, setAuthName] = useState('');\r\n  const [authSubmitting, setAuthSubmitting] = useState(false);\r\n  const [authError, setAuthError] = useState<string | null>(null);\r\n\r\n  // Profile modal\r\n  const [showProfileModal, setShowProfileModal] = useState(false);\r\n  const [profName, setProfName] = useState('');\r\n  const [profPic, setProfPic] = useState('');\r\n  const [profSaving, setProfSaving] = useState(false);\r\n\r\n  // Favorites v2 (map by name)\r\n  const [favs, setFavs] = useState<Map<string, FavTool>>(new Map());\r\n  const [showFavsOnly, setShowFavsOnly] = useState(false);\r\n\r\n  // Recent prompts\r\n  const [recents, setRecents] = useState<string[]>([]);\r\n\r\n  // Get translation function (memoized to prevent re-renders)\r\n  const t = useCallback((key: keyof typeof translations.en) => translations[language][key], [language]);\r\n\r\n  // Memoize the onOpenTool callback to prevent re-renders\r\n  const handleOpenTool = useCallback((tool: Tool) => {\r\n    if (tool.link) {\r\n      window.open(tool.link, '_blank', 'noreferrer,noopener');\r\n    }\r\n  }, []);\r\n\r\n  // Memoize the buildPrompt callback to prevent re-renders\r\n  const buildPromptCallback = useCallback(({ goal, stepTitle, tools }: { goal: string; stepTitle: string; tools: Tool[] }) => \r\n    buildStepPrompt(goal, stepTitle, tools, language)\r\n  , [language]);\r\n\r\n  // –ü–û–î–û–ë–†–ï–ù–ê goHome —Ñ—É–Ω–∫—Ü–∏—è\r\n  const goHome = useCallback(() => {\r\n    console.log('goHome called');\r\n    window.location.hash = '#/';\r\n    setView('home');\r\n    \r\n    // –ò–∑—á–∏—Å—Ç–≤–∞–Ω–µ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –ø—Ä–∏ –Ω—É–∂–¥–∞\r\n    setGroups([]);\r\n    setLastGoal('');\r\n    setError(null);\r\n    \r\n    // –°–∫—Ä–æ–ª–∏—Ä–∞–Ω–µ –¥–æ top\r\n    setTimeout(() => {\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }, 100);\r\n  }, []);\r\n\r\n  // ---- –ü–û–î–û–ë–†–ï–ù hash router listener ----\r\n  useEffect(() => {\r\n    const onHash = () => {\r\n      const newView = getViewFromHash();\r\n      console.log('Hash changed to:', window.location.hash, 'setting view to:', newView);\r\n      setView(newView);\r\n    };\r\n    \r\n    // –ò–∑–ø—ä–ª–Ω–∏ –≤–µ–¥–Ω—ä–∂ –ø—Ä–∏ mount\r\n    onHash();\r\n    \r\n    window.addEventListener('hashchange', onHash);\r\n    return () => window.removeEventListener('hashchange', onHash);\r\n  }, []);\r\n\r\n  // –§–æ—Ä—Å–∏—Ä–∞–Ω–µ –Ω–∞ home view –∑–∞ –ø—Ä–∞–∑–Ω–∏ hash-–æ–≤–µ\r\n  useEffect(() => {\r\n    const currentHash = window.location.hash;\r\n    if (currentHash === '' || currentHash === '#' || currentHash === '#/' || !currentHash) {\r\n      console.log('Forcing home view for hash:', currentHash);\r\n      setView('home');\r\n    }\r\n  }, []);\r\n\r\n  // Load saved language preference\r\n  useEffect(() => {\r\n    try {\r\n      const savedLang = localStorage.getItem(LANGUAGE_KEY) as Language;\r\n      if (savedLang && (savedLang === 'en' || savedLang === 'bg')) {\r\n        setLanguage(savedLang);\r\n      }\r\n    } catch {}\r\n  }, []);\r\n\r\n  // Language saver without timeout to prevent race conditions\r\n  const saveLanguage = useCallback((lang: Language) => {\r\n    if (language !== lang) {\r\n      setLanguage(lang);\r\n      try {\r\n        localStorage.setItem(LANGUAGE_KEY, lang);\r\n      } catch {}\r\n    }\r\n  }, [language]);\r\n\r\n  // click outside for dropdowns\r\n  useEffect(() => {\r\n    const onDocClick = (e: MouseEvent) => {\r\n      if (signinRef.current && !signinRef.current.contains(e.target as Node)) setSigninOpen(false);\r\n      if (profileRef.current && !profileRef.current.contains(e.target as Node)) setProfileOpen(false);\r\n    };\r\n    document.addEventListener('click', onDocClick, true);\r\n    return () => document.removeEventListener('click', onDocClick, true);\r\n  }, []);\r\n\r\n  // load favorites\r\n  useEffect(() => {\r\n    try {\r\n      const v2raw = localStorage.getItem(FAVS_V2_KEY);\r\n      if (v2raw) {\r\n        const arr: FavTool[] = JSON.parse(v2raw) || [];\r\n        setFavs(new Map(arr.map((t) => [t.name, t])));\r\n      } else {\r\n        const v1raw = localStorage.getItem(FAVS_V1_KEY);\r\n        if (v1raw) {\r\n          const names: string[] = JSON.parse(v1raw) || [];\r\n          const arr: FavTool[] = names.map((name) => ({ name }));\r\n          localStorage.setItem(FAVS_V2_KEY, JSON.stringify(arr));\r\n          localStorage.removeItem(FAVS_V1_KEY);\r\n          setFavs(new Map(arr.map((t) => [t.name, t])));\r\n        }\r\n      }\r\n    } catch {}\r\n  }, []);\r\n\r\n  function saveFavs(next: Map<string, FavTool>) {\r\n    setFavs(new Map(next));\r\n    try {\r\n      localStorage.setItem(FAVS_V2_KEY, JSON.stringify(Array.from(next.values())));\r\n    } catch {}\r\n  }\r\n\r\n  function toggleFav(tool: Tool | FavTool) {\r\n    const next = new Map(favs);\r\n    if (next.has(tool.name)) next.delete(tool.name);\r\n    else next.set(tool.name, { name: tool.name, icon: (tool as any).icon, link: (tool as any).link });\r\n    saveFavs(next);\r\n  }\r\n\r\n  // load recents\r\n  useEffect(() => {\r\n    try {\r\n      const raw = localStorage.getItem(RECENT_KEY);\r\n      if (raw) setRecents(JSON.parse(raw));\r\n    } catch {}\r\n  }, []);\r\n\r\n  function pushRecent(prompt: string) {\r\n    const p = prompt.trim();\r\n    if (!p) return;\r\n    const next = [p, ...recents.filter((r) => r !== p)].slice(0, RECENT_MAX);\r\n    setRecents(next);\r\n    try {\r\n      localStorage.setItem(RECENT_KEY, JSON.stringify(next));\r\n    } catch {}\r\n  }\r\n\r\n  function removeRecent(prompt: string) {\r\n    const next = recents.filter((r) => r !== prompt);\r\n    setRecents(next);\r\n    try {\r\n      localStorage.setItem(RECENT_KEY, JSON.stringify(next));\r\n    } catch {}\r\n  }\r\n\r\n  function clearRecents() {\r\n    setRecents([]);\r\n    try {\r\n      localStorage.removeItem(RECENT_KEY);\r\n    } catch {}\r\n  }\r\n\r\n  // Fixed fetchPlan function with cache busting\r\n  async function fetchPlan(prompt: string): Promise<PlanResponse> {\r\n    const timestamp = Date.now();\r\n    const res = await fetch(`${API_BASE}/plan?t=${timestamp}`, {\r\n      method: 'POST',\r\n      headers: { \r\n        'Content-Type': 'application/json',\r\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\r\n        'Pragma': 'no-cache',\r\n        'Expires': '0'\r\n      },\r\n      body: JSON.stringify({ user_goal: prompt }),\r\n    });\r\n    if (!res.ok) throw new Error('Failed to fetch tools from backend');\r\n    return res.json();\r\n  }\r\n\r\n  // Fixed handleFindTools function\r\n  const handleFindTools = useCallback(async (fromPrompt?: string) => {\r\n    const prompt = (fromPrompt ?? chatInput).trim();\r\n    if (!prompt) return;\r\n    \r\n    // Clear previous results immediately\r\n    setGroups([]);\r\n    setLastGoal('');\r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      // Detect language and save immediately (no timeout)\r\n      const detectedLang = detectLanguage(prompt);\r\n      saveLanguage(detectedLang);\r\n      \r\n      const data = await fetchPlan(prompt);\r\n      const grouped = data.groups && data.groups.length ? data.groups : groupsFromPlanFallback(data.plan);\r\n      \r\n      setGroups(grouped);\r\n      setLastGoal(data.goal || prompt);\r\n      pushRecent(prompt);\r\n      \r\n      // Clear input after successful search\r\n      if (!fromPrompt) {\r\n        setChatInput('');\r\n      }\r\n    } catch (e) {\r\n      console.error('Error fetching plan:', e);\r\n      setError(language === 'bg' ? '‚ö†Ô∏è –í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ—Ç–æ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏—Ç–µ.' : '‚ö†Ô∏è Something went wrong while fetching tools.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [chatInput, saveLanguage, language]);\r\n\r\n  // ------- Auth (cookie session) -------\r\n  async function handleGoogleSignIn() {\r\n    try {\r\n      const { user } = await openOAuthPopup('google');\r\n      setCurrentUser(user);\r\n      setError(null);\r\n    } catch (e) {\r\n      console.error(e);\r\n      setError(t('signInFailed'));\r\n    }\r\n  }\r\n\r\n  async function handleSignOut() {\r\n    try {\r\n      await logout();\r\n    } catch (e) {\r\n      console.warn('Logout error:', e);\r\n    }\r\n    setCurrentUser(null);\r\n  }\r\n\r\n  async function submitEmailAuth() {\r\n    setAuthSubmitting(true);\r\n    setAuthError(null);\r\n    setError(null);\r\n    try {\r\n      const url = authMode === 'signup' ? `${API_BASE}/auth/register` : `${API_BASE}/auth/login`;\r\n      const res = await fetch(url, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          email: authEmail,\r\n          password: authPassword,\r\n          name: authMode === 'signup' ? authName : undefined,\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const t = await res.text();\r\n        throw new Error(t || `HTTP ${res.status}`);\r\n      }\r\n\r\n      const data = await res.json();\r\n      setCurrentUser(data.user);\r\n      setShowEmailModal(false);\r\n      setAuthEmail('');\r\n      setAuthPassword('');\r\n      setAuthName('');\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setAuthError(authMode === 'signup' ? t('signUpFailed') : t('signInFailed'));\r\n    } finally {\r\n      setAuthSubmitting(false);\r\n    }\r\n  }\r\n\r\n  // Profile modal open\r\n  function openProfile() {\r\n    if (!currentUser) return;\r\n    setProfName(currentUser.name ?? '');\r\n    setProfPic(currentUser.picture ?? '');\r\n    setShowProfileModal(true);\r\n    setProfileOpen(false);\r\n  }\r\n\r\n  // Save profile (PATCH /auth/me)\r\n  async function saveProfile() {\r\n    if (!currentUser) return;\r\n    setProfSaving(true);\r\n    setError(null);\r\n    try {\r\n      const xsrf = getCookie('XSRF-TOKEN');\r\n      const res = await fetch(`${API_BASE}/auth/me`, {\r\n        method: 'PATCH',\r\n        credentials: 'include',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          ...(xsrf ? { 'X-XSRF-TOKEN': xsrf } : {}),\r\n        },\r\n        body: JSON.stringify({ name: profName, picture: profPic }),\r\n      });\r\n      if (!res.ok) {\r\n        const t = await res.text();\r\n        throw new Error(t || 'Update failed');\r\n      }\r\n      const user = await res.json();\r\n      setCurrentUser(user);\r\n      setShowProfileModal(false);\r\n    } catch (e) {\r\n      console.error(e);\r\n      setError(t('profileUpdateFailed'));\r\n    } finally {\r\n      setProfSaving(false);\r\n    }\r\n  }\r\n\r\n  // auto-load session\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        const u = await fetchMe();\r\n        if (mounted) setCurrentUser(u);\r\n      } catch {\r\n        try {\r\n          await refreshSession();\r\n          const u2 = await fetchMe();\r\n          if (mounted) setCurrentUser(u2);\r\n        } catch {\r\n          if (mounted) setCurrentUser(null);\r\n        }\r\n      }\r\n    })();\r\n    return () => { mounted = false; };\r\n  }, []);\r\n\r\n  // Filtering logic\r\n  const term = searchQuery.trim().toLowerCase();\r\n  const filteredGroups: Group[] = groups\r\n    .map((g) => ({\r\n      title: g.title,\r\n      tools: g.tools.filter((t) => {\r\n        const match = !term || g.title.toLowerCase().includes(term) || (t.name ?? '').toLowerCase().includes(term);\r\n        const favOk = !showFavsOnly || favs.has(t.name);\r\n        return match && favOk;\r\n      }),\r\n    }))\r\n    .filter((g) => g.tools.length > 0);\r\n\r\n  const favCount = favs.size;\r\n\r\n  // Stable input change handler to prevent focus loss\r\n  const handleChatInputChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setChatInput(e.target.value);\r\n  }, []);\r\n\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      handleFindTools();\r\n    }\r\n  }, [handleFindTools]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50\">\r\n      {/* Header */}\r\n      <header className=\"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-200/50\">\r\n        <div className=\"max-w-6xl mx-auto px-4 py-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            {/* Logo */}\r\n            <div className=\"flex items-center gap-3 cursor-pointer\" onClick={goHome}>\r\n              <div className=\"w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/25\">\r\n                <Sparkles className=\"w-5 h-5 text-white\" />\r\n              </div>\r\n              <span className=\"text-xl text-slate-800 font-semibold\">My AI</span>\r\n            </div>\r\n\r\n            {/* Desktop Navigation */}\r\n            <nav className=\"hidden md:flex items-center gap-8\">\r\n              <button \r\n                onClick={goHome} \r\n                className={`font-medium transition-colors ${view === 'home' ? 'text-blue-600' : 'text-slate-600 hover:text-blue-600'}`}\r\n              >\r\n                {t('discover')}\r\n              </button>\r\n              <button \r\n                onClick={goCategories} \r\n                className={`font-medium transition-colors ${view === 'categories' ? 'text-blue-600' : 'text-slate-600 hover:text-blue-600'}`}\r\n              >\r\n                {t('categories')}\r\n              </button>\r\n              <a href=\"#\" className=\"text-slate-600 hover:text-blue-600 font-medium transition-colors\">{t('learn')}</a>\r\n\r\n              {/* Favorites */}\r\n              <button\r\n                onClick={goFavorites}\r\n                className={`inline-flex items-center gap-2 font-medium transition-colors ${\r\n                  view === 'favorites' ? 'text-blue-600' : 'text-slate-700 hover:text-blue-600'\r\n                }`}\r\n                title={t('favorites')}\r\n              >\r\n                <Star className={`w-4 h-4 ${favCount ? 'fill-yellow-400 text-yellow-500' : ''}`} />\r\n                <span className=\"hidden lg:inline\">{t('favorites')}</span>\r\n                <span className=\"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded-full\">{favCount}</span>\r\n              </button>\r\n\r\n              {/* Auth section */}\r\n              {currentUser ? (\r\n                <div className=\"relative\" ref={profileRef}>\r\n                  <button \r\n                    onClick={() => setProfileOpen(!profileOpen)} \r\n                    className=\"flex items-center gap-2 hover:bg-slate-50 p-2 rounded-xl transition-colors\" \r\n                    title={currentUser.email}\r\n                  >\r\n                    {currentUser.picture ? (\r\n                      <img \r\n                        src={currentUser.picture} \r\n                        alt=\"avatar\" \r\n                        className=\"w-8 h-8 rounded-full border border-slate-200\" \r\n                        referrerPolicy=\"no-referrer\" \r\n                      />\r\n                    ) : (\r\n                      <div className=\"w-8 h-8 rounded-full bg-blue-200\" />\r\n                    )}\r\n                    <span className=\"text-slate-700 font-medium max-w-[120px] truncate hidden lg:block\">\r\n                      {currentUser.name || currentUser.email}\r\n                    </span>\r\n                  </button>\r\n                  {profileOpen && (\r\n                    <div className=\"absolute right-0 mt-2 w-56 bg-white rounded-2xl shadow-xl border border-slate-200/60 p-1 z-50\">\r\n                      <button onClick={openProfile} className=\"w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors\">\r\n                        {t('profile')}\r\n                      </button>\r\n                      <div className=\"my-1 border-t border-slate-100\" />\r\n                      <button onClick={handleSignOut} className=\"w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors text-red-600\">\r\n                        {t('signOut')}\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ) : (\r\n                <div className=\"relative\" ref={signinRef}>\r\n                  <Button \r\n                    variant=\"outline\" \r\n                    size=\"sm\" \r\n                    onClick={() => setSigninOpen(!signinOpen)} \r\n                    className=\"border-blue-300 text-blue-600 hover:bg-blue-50 font-medium\"\r\n                  >\r\n                    {t('signIn')}\r\n                  </Button>\r\n                  {signinOpen && (\r\n                    <div className=\"absolute right-0 mt-2 w-64 bg-white rounded-2xl shadow-2xl border border-slate-200/60 p-1 z-50\">\r\n                      <button\r\n                        onClick={() => { setSigninOpen(false); setAuthMode('signup'); setShowEmailModal(true); }}\r\n                        className=\"w-full flex items-center px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors\"\r\n                      >\r\n                        <div className=\"w-6 h-6 rounded-md bg-slate-200 mr-3\" />\r\n                        <div className=\"flex flex-col items-start\">\r\n                          <span className=\"text-slate-800 font-medium\">{t('createAccount')}</span>\r\n                          <span className=\"text-slate-400 text-xs\">{t('emailPassword')}</span>\r\n                        </div>\r\n                      </button>\r\n                      <div className=\"my-1 border-t border-slate-100\" />\r\n                      <button\r\n                        onClick={() => { setSigninOpen(false); handleGoogleSignIn(); }}\r\n                        className=\"w-full flex items-center px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors\"\r\n                      >\r\n                        <img src=\"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg\" alt=\"Google\" className=\"w-4 h-4 mr-3\" />\r\n                        <span className=\"text-slate-800 font-medium\">{t('signInWithGoogle')}</span>\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </nav>\r\n\r\n            {/* Mobile menu button */}\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              className=\"md:hidden\"\r\n              onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\r\n            >\r\n              <Menu className=\"w-4 h-4\" />\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Mobile menu */}\r\n          {mobileMenuOpen && (\r\n            <div className=\"md:hidden mt-4 pb-4 border-t border-slate-200/50 pt-4\">\r\n              <div className=\"space-y-2\">\r\n                <button onClick={() => { goHome(); setMobileMenuOpen(false); }} className=\"block w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors font-medium\">\r\n                  {t('discover')}\r\n                </button>\r\n                <button onClick={() => { goCategories(); setMobileMenuOpen(false); }} className=\"block w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors font-medium\">\r\n                  {t('categories')}\r\n                </button>\r\n                <button onClick={() => { goFavorites(); setMobileMenuOpen(false); }} className=\"block w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors font-medium\">\r\n                  {t('favorites')} ({favCount})\r\n                </button>\r\n                {!currentUser && (\r\n                  <button onClick={() => { setShowEmailModal(true); setMobileMenuOpen(false); }} className=\"block w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 transition-colors font-medium text-blue-600\">\r\n                    {t('signIn')}\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </header>\r\n\r\n      {/* Modals */}\r\n      {showEmailModal && <AuthModal />}\r\n      {showProfileModal && currentUser && <ProfileModal />}\r\n\r\n      {/* –ü–û–î–û–ë–†–ï–ù–ê Main Content –ª–æ–≥–∏–∫–∞ */}\r\n      {(() => {\r\n        const currentHash = window.location.hash;\r\n        \r\n        // –î–∏—Ä–µ–∫—Ç–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ hash-–∞ –∏–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç\r\n        if (currentHash === '#/favorites') return <FavoritesView />;\r\n        if (currentHash === '#/categories') return <CategoriesView />;\r\n        if (currentHash.startsWith('#/categories/') && currentHash !== '#/categories') {\r\n          return <CategoryViewWrapper />;\r\n        }\r\n        \r\n        // –ó–∞ –ø—Ä–∞–∑–Ω–∏ –∏–ª–∏ home hash-–æ–≤–µ –≤–∏–Ω–∞–≥–∏ –ø–æ–∫–∞–∑–≤–∞–º–µ home\r\n        if (!currentHash || currentHash === '#' || currentHash === '#/') {\r\n          return <HomeView />;\r\n        }\r\n\r\n        // Fallback –∫—ä–º view state\r\n        if (view === 'favorites') return <FavoritesView />;\r\n        if (view === 'categories') return <CategoriesView />;\r\n        if (view === 'category') return <CategoryViewWrapper />;\r\n        \r\n        return <HomeView />;\r\n      })()}\r\n\r\n      {/* Bottom Navigation (Mobile) */}\r\n      <nav className=\"fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-xl border-t border-slate-200/50 md:hidden z-50\">\r\n        <div className=\"flex items-center justify-around py-2\">\r\n          {[\r\n            { name: t('home'), icon: Grid3x3, active: activeTab === 'Home', action: () => { goHome(); setActiveTab('Home'); } },\r\n            { name: t('categories'), icon: MessageCircle, active: activeTab === 'Categories', action: () => { goCategories(); setActiveTab('Categories'); } },\r\n            { name: t('favorites'), icon: Heart, active: activeTab === 'Favorites', action: () => { goFavorites(); setActiveTab('Favorites'); } },\r\n            { name: t('profile'), icon: User, active: activeTab === 'Profile', action: () => setActiveTab('Profile') }\r\n          ].map((item) => {\r\n            const IconComponent = item.icon;\r\n            return (\r\n              <button\r\n                key={item.name}\r\n                onClick={item.action}\r\n                className={`flex flex-col items-center py-2 px-3 rounded-xl transition-colors ${\r\n                  item.active ? 'text-blue-600 bg-blue-50' : 'text-slate-400 hover:text-slate-600'\r\n                }`}\r\n              >\r\n                <IconComponent className=\"w-5 h-5 mb-1\" />\r\n                <span className=\"text-xs font-medium\">{item.name}</span>\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n      </nav>\r\n    </div>\r\n  );\r\n\r\n  // Auth Modal Component\r\n  function AuthModal() {\r\n    return (\r\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm\">\r\n        <div className=\"bg-white w-full max-w-md rounded-2xl shadow-2xl p-6 mx-4\">\r\n          <div className=\"flex items-center justify-between mb-6\">\r\n            <h3 className=\"text-xl font-semibold text-slate-800\">\r\n              {authMode === 'signup' ? t('createYourAccount') : t('signInToAccount')}\r\n            </h3>\r\n            <button onClick={() => setShowEmailModal(false)} className=\"text-slate-500 hover:text-slate-700 p-1\">\r\n              <X className=\"w-5 h-5\" />\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"space-y-4\">\r\n            {authMode === 'signup' && (\r\n              <Input \r\n                placeholder={t('yourName')} \r\n                value={authName} \r\n                onChange={(e) => setAuthName(e.target.value)}\r\n                className=\"h-12 rounded-xl\"\r\n              />\r\n            )}\r\n            <Input \r\n              placeholder={t('email')} \r\n              type=\"email\" \r\n              value={authEmail} \r\n              onChange={(e) => setAuthEmail(e.target.value)}\r\n              className=\"h-12 rounded-xl\"\r\n            />\r\n            <Input \r\n              placeholder={t('password')} \r\n              type=\"password\" \r\n              value={authPassword} \r\n              onChange={(e) => setAuthPassword(e.target.value)}\r\n              className=\"h-12 rounded-xl\"\r\n            />\r\n            {authError && <div className=\"text-red-600 text-sm p-3 bg-red-50 rounded-xl\">{authError}</div>}\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between mt-6\">\r\n            <button \r\n              onClick={() => setAuthMode(authMode === 'signup' ? 'signin' : 'signup')} \r\n              className=\"text-sm text-blue-600 hover:underline\"\r\n            >\r\n              {authMode === 'signup' ? t('alreadyHaveAccount') : t('dontHaveAccount')}\r\n            </button>\r\n            <div className=\"flex gap-3\">\r\n              <Button variant=\"outline\" onClick={() => setShowEmailModal(false)}>{t('cancel')}</Button>\r\n              <Button onClick={submitEmailAuth} disabled={authSubmitting} className=\"bg-gradient-to-r from-blue-600 to-indigo-600\">\r\n                {authMode === 'signup' ? t('createAccount') : t('signIn')}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-6\">\r\n            <div className=\"text-center text-xs text-slate-400 mb-3\">{t('orContinueWith')}</div>\r\n            <Button \r\n              onClick={() => { setShowEmailModal(false); handleGoogleSignIn(); }} \r\n              className=\"w-full bg-white border border-slate-200 text-slate-800 hover:bg-slate-50 h-12\"\r\n            >\r\n              <img src=\"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg\" alt=\"Google\" className=\"w-5 h-5 mr-2\" />\r\n              {t('google')}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Profile Modal Component\r\n  function ProfileModal() {\r\n    return (\r\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm\">\r\n        <div className=\"bg-white w-full max-w-md rounded-2xl shadow-2xl p-6 mx-4\">\r\n          <div className=\"flex items-center justify-between mb-6\">\r\n            <h3 className=\"text-xl font-semibold text-slate-800\">{t('yourProfile')}</h3>\r\n            <button onClick={() => setShowProfileModal(false)} className=\"text-slate-500 hover:text-slate-700 p-1\">\r\n              <X className=\"w-5 h-5\" />\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-4 mb-6\">\r\n            <div className=\"w-16 h-16 rounded-full overflow-hidden bg-slate-100 border-2 border-slate-200\">\r\n              {profPic ? (\r\n                <img src={profPic} className=\"w-full h-full object-cover\" referrerPolicy=\"no-referrer\" />\r\n              ) : (\r\n                <div className=\"w-full h-full bg-blue-200\" />\r\n              )}\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <div className=\"text-xs text-slate-500 mb-1\">{t('email')}</div>\r\n              <div className=\"text-slate-800 font-medium\">{currentUser!.email}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"text-sm font-medium text-slate-700 mb-2 block\">{t('name')}</label>\r\n              <Input \r\n                placeholder={t('name')} \r\n                value={profName} \r\n                onChange={(e) => setProfName(e.target.value)}\r\n                className=\"h-12 rounded-xl\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium text-slate-700 mb-2 block\">{t('avatarUrl')}</label>\r\n              <Input \r\n                placeholder=\"https://...\" \r\n                value={profPic} \r\n                onChange={(e) => setProfPic(e.target.value)}\r\n                className=\"h-12 rounded-xl\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex justify-end gap-3 mt-8\">\r\n            <Button variant=\"outline\" onClick={() => setShowProfileModal(false)}>{t('cancel')}</Button>\r\n            <Button onClick={saveProfile} disabled={profSaving} className=\"bg-gradient-to-r from-blue-600 to-indigo-600\">\r\n              {t('saveChanges')}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Home View Component with BOTH PlanMindMap AND Results sections\r\n  function HomeView() {\r\n    return (\r\n      <main className=\"max-w-6xl mx-auto px-4 py-8 pb-24 md:pb-12\">\r\n        {/* Hero Section */}\r\n        <section className=\"text-center mb-16\">\r\n          <h1 className=\"text-4xl md:text-5xl text-slate-800 mb-6 font-bold tracking-tight\">\r\n            {t('heroTitle')} <span className=\"bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\">{t('heroTitleHighlight')}</span>\r\n          </h1>\r\n          <p className=\"text-xl text-slate-600 mb-10 max-w-2xl mx-auto leading-relaxed\">\r\n            {t('heroSubtitle')}\r\n          </p>\r\n\r\n          {/* Main Chat Input */}\r\n          <div className=\"max-w-2xl mx-auto mb-8\">\r\n            <div className=\"relative bg-white/80 backdrop-blur-sm rounded-3xl p-6 border border-slate-200/50 shadow-2xl shadow-blue-500/10\">\r\n              <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/25\">\r\n                  <MessageCircle className=\"w-6 h-6 text-white\" />\r\n                </div>\r\n                <span className=\"text-slate-700 text-lg font-medium\">{t('inputPlaceholder')}</span>\r\n              </div>\r\n              <div className=\"flex gap-3\">\r\n                <Input\r\n                  placeholder={language === 'bg' ? '–Ω–∞–ø—Ä., –ü–∏—Å–∞–Ω–µ –Ω–∞ –ø–æ-–¥–æ–±—Ä–∏ –∏–º–µ–π–ª–∏, —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –ª–æ–≥–æ, –∞–Ω–∞–ª–∏–∑ –Ω–∞ –¥–∞–Ω–Ω–∏...' : 'e.g., Write better emails, create a logo, analyze data...'}\r\n                  autoFocus\r\n                  value={chatInput}\r\n                  onChange={handleChatInputChange}\r\n                  onKeyDown={handleKeyDown}\r\n                  className=\"flex-1 bg-slate-50/80 border-slate-200 text-base h-14 rounded-2xl px-5 font-medium placeholder:text-slate-400\"\r\n                />\r\n                <Button \r\n                  onClick={() => handleFindTools()} \r\n                  className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 px-6 h-14 rounded-2xl shadow-lg shadow-blue-500/25 font-medium\"\r\n                  disabled={loading}\r\n                >\r\n                  <Zap className=\"w-5 h-5 mr-2\" /> {t('findTools')}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Recent Prompts */}\r\n          {recents.length > 0 && (\r\n            <div className=\"max-w-2xl mx-auto mb-10\">\r\n              <div className=\"flex items-center justify-between mb-3 px-1\">\r\n                <div className=\"flex items-center gap-2 text-slate-600\">\r\n                  <History className=\"w-4 h-4\" />\r\n                  <span className=\"text-sm font-medium\">{t('recentPrompts')}</span>\r\n                </div>\r\n                <button className=\"text-xs text-slate-400 hover:text-slate-600 transition-colors\" onClick={clearRecents}>\r\n                  {t('clearAll')}\r\n                </button>\r\n              </div>\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {recents.map((prompt) => (\r\n                  <div key={prompt} className=\"group inline-flex items-center max-w-full bg-white/90 border border-slate-200/60 rounded-xl px-3 py-2 shadow-sm hover:shadow-md transition-shadow\">\r\n                    <button \r\n                      className=\"text-sm text-slate-700 truncate max-w-[200px] hover:text-blue-600 transition-colors\" \r\n                      title={prompt} \r\n                      onClick={() => { setChatInput(prompt); handleFindTools(prompt); }}\r\n                    >\r\n                      {prompt}\r\n                    </button>\r\n                    <button \r\n                      className=\"ml-2 text-slate-400 hover:text-red-500 transition-colors p-1\" \r\n                      onClick={() => removeRecent(prompt)} \r\n                      aria-label=\"remove\" \r\n                      title=\"Remove\"\r\n                    >\r\n                      <X className=\"w-3 h-3\" />\r\n                    </button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Status Messages */}\r\n          {error && (\r\n            <div className=\"text-red-600 font-medium mb-6 p-4 bg-red-50 rounded-2xl border border-red-200 max-w-2xl mx-auto\">\r\n              {error}\r\n            </div>\r\n          )}\r\n          {loading && (\r\n            <div className=\"text-blue-600 font-medium mb-6 p-4 bg-blue-50 rounded-2xl border border-blue-200 max-w-2xl mx-auto\">\r\n              {t('loading')}\r\n            </div>\r\n          )}\r\n        </section>\r\n\r\n        {/* Search and Filters */}\r\n        {filteredGroups.length > 0 && (\r\n          <section className=\"mb-12\">\r\n            <div className=\"flex flex-col sm:flex-row gap-4 mb-6\">\r\n              <div className=\"relative flex-1\">\r\n                <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5\" />\r\n                <Input\r\n                  placeholder={t('searchPlaceholder')}\r\n                  value={searchQuery}\r\n                  onChange={(e) => setSearchQuery(e.target.value)}\r\n                  className=\"pl-12 bg-white/80 border-slate-200/50 h-12 rounded-2xl backdrop-blur-sm font-medium\"\r\n                />\r\n              </div>\r\n              <label className=\"inline-flex items-center gap-2 text-slate-700 bg-white/80 border border-slate-200/50 rounded-2xl px-4 h-12 whitespace-nowrap\">\r\n                <input \r\n                  type=\"checkbox\" \r\n                  checked={showFavsOnly} \r\n                  onChange={(e) => setShowFavsOnly(e.target.checked)} \r\n                  className=\"accent-blue-600 w-4 h-4\" \r\n                />\r\n                <span className=\"text-sm font-medium\">{t('favoritesOnly')}</span>\r\n                <span className=\"text-xs text-slate-400\">({favCount})</span>\r\n              </label>\r\n            </div>\r\n          </section>\r\n        )}\r\n\r\n        {/* Visual Plan */}\r\n        {filteredGroups.length > 0 && (\r\n          <section className=\"mb-16\">\r\n            <div className=\"flex items-center gap-3 mb-8\">\r\n              <div className=\"w-10 h-10 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-purple-500/25\">\r\n                <Wand2 className=\"w-5 h-5 text-white\" />\r\n              </div>\r\n              <div>\r\n                <h2 className=\"text-2xl text-slate-800 font-bold\">{t('journeyTitle')}</h2>\r\n                <p className=\"text-slate-600 text-sm\">{t('journeySubtitle')}</p>\r\n              </div>\r\n            </div>\r\n            <PlanMindMap\r\n              goal={lastGoal || chatInput}\r\n              steps={filteredGroups}\r\n              onOpenTool={handleOpenTool}\r\n              language={language}\r\n              buildPrompt={buildPromptCallback}\r\n            />\r\n          </section>\r\n        )}\r\n\r\n        {/* Empty states */}\r\n        {filteredGroups.length === 0 && !loading && groups.length === 0 && (\r\n          <div className=\"text-center py-20\">\r\n            <div className=\"w-20 h-20 bg-slate-100 rounded-3xl flex items-center justify-center mx-auto mb-6\">\r\n              <Sparkles className=\"w-10 h-10 text-slate-400\" />\r\n            </div>\r\n            <h3 className=\"text-slate-800 mb-3 font-bold text-xl\">{t('readyTitle')}</h3>\r\n            <p className=\"text-slate-600\">{t('readySubtitle')}</p>\r\n          </div>\r\n        )}\r\n\r\n        {filteredGroups.length === 0 && !loading && groups.length > 0 && (\r\n          <div className=\"text-center py-16\">\r\n            <div className=\"w-20 h-20 bg-slate-100 rounded-3xl flex items-center justify-center mx-auto mb-6\">\r\n              <Search className=\"w-10 h-10 text-slate-400\" />\r\n            </div>\r\n            <h3 className=\"text-slate-800 mb-3 font-bold text-xl\">{t('noToolsTitle')}</h3>\r\n            <p className=\"text-slate-600\">{t('noToolsSubtitle')}</p>\r\n          </div>\r\n        )}\r\n      </main>\r\n    );\r\n  }\r\n\r\n  // Favorites View Component\r\n  function FavoritesView() {\r\n    return (\r\n      <main className=\"max-w-6xl mx-auto px-4 py-8 pb-24 md:pb-12\">\r\n        <div className=\"flex items-center justify-between mb-8\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <button onClick={goHome} className=\"inline-flex items-center gap-2 text-slate-600 hover:text-blue-600 transition-colors p-2 -ml-2 rounded-xl\">\r\n              <ArrowLeft className=\"w-4 h-4\" />\r\n              <span className=\"font-medium\">{t('back')}</span>\r\n            </button>\r\n            <div className=\"w-px h-6 bg-slate-300\" />\r\n            <h1 className=\"text-2xl text-slate-800 font-bold\">{t('myFavorites')}</h1>\r\n          </div>\r\n          <span className=\"text-slate-500 font-medium bg-slate-100 px-3 py-1 rounded-full text-sm\">\r\n            {favCount} {t('savedCount')}\r\n          </span>\r\n        </div>\r\n\r\n        {favCount === 0 ? (\r\n          <div className=\"text-center py-20\">\r\n            <div className=\"w-20 h-20 bg-slate-100 rounded-3xl flex items-center justify-center mx-auto mb-6\">\r\n              <Star className=\"w-10 h-10 text-slate-400\" />\r\n            </div>\r\n            <h3 className=\"text-slate-800 mb-3 font-bold text-xl\">{t('noFavoritesTitle')}</h3>\r\n            <p className=\"text-slate-600 mb-8\">{t('noFavoritesSubtitle')}</p>\r\n            <Button onClick={goHome} className=\"bg-gradient-to-r from-blue-600 to-indigo-600\">\r\n              {t('discoverTools')}\r\n            </Button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid sm:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            {Array.from(favs.values()).map((tool) => (\r\n              <ToolCard \r\n                key={`fav-${tool.name}`} \r\n                tool={tool} \r\n                isFav={true} \r\n                onToggleFav={() => toggleFav(tool)} \r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </main>\r\n    );\r\n  }\r\n\r\n  // Tool Card Component (used in FavoritesView)\r\n  function ToolCard({ tool, isFav, onToggleFav }: { tool: Tool | FavTool; isFav: boolean; onToggleFav: () => void }) {\r\n    return (\r\n      <Card className=\"border-slate-200/50 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 bg-white/90 backdrop-blur-sm group\">\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"flex items-start justify-between mb-4\">\r\n            <div className=\"w-14 h-14 rounded-2xl overflow-hidden bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform duration-300\">\r\n              {'icon' in tool && (tool as any).icon ? (\r\n                <img\r\n                  src={(tool as any).icon}\r\n                  alt={tool.name}\r\n                  className=\"w-8 h-8 object-contain\"\r\n                  loading=\"lazy\"\r\n                  referrerPolicy=\"no-referrer\"\r\n                  onError={(e) => {\r\n                    const img = e.currentTarget as HTMLImageElement;\r\n                    img.onerror = null;\r\n                    img.style.display = 'none';\r\n                  }}\r\n                />\r\n              ) : (\r\n                <Sparkles className=\"w-7 h-7 text-white\" />\r\n              )}\r\n            </div>\r\n\r\n            <button\r\n              onClick={onToggleFav}\r\n              className={`flex items-center gap-1 px-3 py-1.5 rounded-xl border transition-all ${\r\n                isFav \r\n                  ? 'bg-yellow-100 border-yellow-200 text-yellow-700 hover:bg-yellow-200' \r\n                  : 'bg-white border-slate-200 text-slate-500 hover:bg-slate-50 hover:border-slate-300'\r\n              }`}\r\n              title={isFav ? t('removeFromFavorites') : t('addToFavorites')}\r\n            >\r\n              <Star className={`w-4 h-4 ${isFav ? 'fill-current' : ''}`} />\r\n              <span className=\"text-sm font-medium hidden sm:inline\">\r\n                {isFav ? t('saved') : t('save')}\r\n              </span>\r\n            </button>\r\n          </div>\r\n\r\n          <h3 className=\"text-slate-800 mb-3 font-bold text-lg leading-tight\">{tool.name}</h3>\r\n          \r\n          <div className=\"flex gap-2 mb-5\">\r\n            <Badge variant=\"secondary\" className=\"text-xs bg-blue-100 text-blue-700 font-medium px-2 py-1\">\r\n              {t('aiTool')}\r\n            </Badge>\r\n            <Badge variant=\"secondary\" className=\"text-xs font-medium px-2 py-1 bg-emerald-100 text-emerald-700\">\r\n              {t('free')}\r\n            </Badge>\r\n          </div>\r\n\r\n          {'link' in tool && (tool as any).link ? (\r\n            <a\r\n              href={(tool as any).link}\r\n              target=\"_blank\"\r\n              rel=\"noreferrer noopener\"\r\n              className=\"block w-full text-center bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white rounded-2xl h-11 leading-[44px] font-medium shadow-lg shadow-red-500/25 transition-all duration-200\"\r\n            >\r\n              {t('openTool')}\r\n            </a>\r\n          ) : (\r\n            <Button disabled className=\"w-full rounded-2xl h-11 bg-slate-100 text-slate-400\">\r\n              {t('noLink')}\r\n            </Button>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  // Categories View Component\r\n  function CategoriesView() {\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Categories data based on comprehensive AI tools research\r\n    const categories = [\r\n      {\r\n        id: 'assistants-productivity',\r\n        label: language === 'bg' ? '–ê—Å–∏—Å—Ç–µ–Ω—Ç–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç' : 'Assistants & Productivity',\r\n        emoji: 'ü§ñ',\r\n        description: language === 'bg' ? '–£–º–Ω–∏ –ø–æ–º–æ—â–Ω–∏—Ü–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –ø–æ–≤–∏—à–∞–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—Ç–∞' : 'Smart assistants and productivity enhancement tools',\r\n        count: 48,\r\n        gradient: 'from-blue-500 to-indigo-600'\r\n      },\r\n      {\r\n        id: 'text-writing',\r\n        label: language === 'bg' ? '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ —Ç–µ–∫—Å—Ç –∏ –ø–∏—Å–∞–Ω–µ' : 'Text Generation & Writing',\r\n        emoji: '‚úèÔ∏è',\r\n        description: language === 'bg' ? '–°—ä–∑–¥–∞–≤–∞–Ω–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –∏ –ø–æ–¥–æ–±—Ä—è–≤–∞–Ω–µ –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ' : 'Creating, editing and improving written content',\r\n        count: 42,\r\n        gradient: 'from-emerald-500 to-teal-600'\r\n      },\r\n      {\r\n        id: 'images-design',\r\n        label: language === 'bg' ? '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –¥–∏–∑–∞–π–Ω' : 'Images & Design',\r\n        emoji: 'üé®',\r\n        description: language === 'bg' ? '–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –∏ –¥–∏–∑–∞–π–Ω –Ω–∞ –≤–∏–∑—É–∞–ª–Ω–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ' : 'Generate, edit and design visual content',\r\n        count: 39,\r\n        gradient: 'from-purple-500 to-pink-600'\r\n      },\r\n      {\r\n        id: 'video-3d',\r\n        label: language === 'bg' ? '–í–∏–¥–µ–æ –∏ 3D' : 'Video & 3D',\r\n        emoji: 'üé¨',\r\n        description: language === 'bg' ? '–°—ä–∑–¥–∞–≤–∞–Ω–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –≤–∏–¥–µ–æ –∏ 3D —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ' : 'Create and edit video and 3D content',\r\n        count: 35,\r\n        gradient: 'from-red-500 to-orange-600'\r\n      },\r\n      {\r\n        id: 'audio-music',\r\n        label: language === 'bg' ? '–ê—É–¥–∏–æ –∏ –º—É–∑–∏–∫–∞' : 'Audio & Music',\r\n        emoji: 'üéµ',\r\n        description: language === 'bg' ? '–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –∑–≤—É–∫, –º—É–∑–∏–∫–∞ –∏ –≥–ª–∞—Å–æ–≤–∏ –∑–∞–ø–∏—Å–∏' : 'Generate sound, music and voice recordings',\r\n        count: 28,\r\n        gradient: 'from-amber-500 to-yellow-600'\r\n      },\r\n      {\r\n        id: 'business-marketing',\r\n        label: language === 'bg' ? '–ë–∏–∑–Ω–µ—Å, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ —Å–æ—Ü–∏–∞–ª–Ω–∏ –º–µ–¥–∏–∏' : 'Business, Marketing & Social Media',\r\n        emoji: 'üìà',\r\n        description: language === 'bg' ? '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –±–∏–∑–Ω–µ—Å, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ —Å–æ—Ü–∏–∞–ª–Ω–∏ –º—Ä–µ–∂–∏' : 'Tools for business, marketing and social networks',\r\n        count: 44,\r\n        gradient: 'from-cyan-500 to-blue-600'\r\n      },\r\n      {\r\n        id: 'coding-development',\r\n        label: language === 'bg' ? '–ö–æ–¥–∏—Ä–∞–Ω–µ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞' : 'Coding & Development',\r\n        emoji: 'üíª',\r\n        description: language === 'bg' ? '–ü–æ–º–æ—â–Ω–∏—Ü–∏ –∑–∞ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å–æ—Ñ—Ç—É–µ—Ä' : 'Programming assistants and software development',\r\n        count: 33,\r\n        gradient: 'from-slate-600 to-gray-700'\r\n      },\r\n      {\r\n        id: 'automation-agents',\r\n        label: language === 'bg' ? '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –∞–≥–µ–Ω—Ç–∏' : 'Automation & AI Agents',\r\n        emoji: '‚ö°',\r\n        description: language === 'bg' ? '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ –ø—Ä–æ—Ü–µ—Å–∏ –∏ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∏ AI –∞–≥–µ–Ω—Ç–∏' : 'Process automation and intelligent AI agents',\r\n        count: 26,\r\n        gradient: 'from-violet-500 to-purple-600'\r\n      },\r\n      {\r\n        id: 'data-analysis',\r\n        label: language === 'bg' ? '–î–∞–Ω–Ω–∏ –∏ –∞–Ω–∞–ª–∏–∑' : 'Data & Analysis',\r\n        emoji: 'üìä',\r\n        description: language === 'bg' ? '–ê–Ω–∞–ª–∏–∑ –Ω–∞ –¥–∞–Ω–Ω–∏ –∏ –±–∏–∑–Ω–µ—Å –∞–Ω–∞–ª–∏—Ç–∏–∫–∞' : 'Data analysis and business intelligence',\r\n        count: 31,\r\n        gradient: 'from-teal-600 to-emerald-700'\r\n      },\r\n      {\r\n        id: 'education-learning',\r\n        label: language === 'bg' ? '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ' : 'Education & Learning',\r\n        emoji: 'üéì',\r\n        description: language === 'bg' ? '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ —É—á–µ–Ω–µ –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª–Ω–∏ –ø–æ–º–æ—â–Ω–∏—Ü–∏' : 'Learning tools and educational assistants',\r\n        count: 23,\r\n        gradient: 'from-indigo-500 to-blue-600'\r\n      },\r\n      {\r\n        id: 'health-wellness',\r\n        label: language === 'bg' ? '–ó–¥—Ä–∞–≤–µ –∏ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ' : 'Health & Wellness',\r\n        emoji: 'üè•',\r\n        description: language === 'bg' ? 'AI —Ä–µ—à–µ–Ω–∏—è –∑–∞ –∑–¥—Ä–∞–≤–µ –∏ –ª–∏—á–Ω–æ —Ä–∞–∑–≤–∏—Ç–∏–µ' : 'AI solutions for health and personal development',\r\n        count: 19,\r\n        gradient: 'from-green-500 to-emerald-600'\r\n      },\r\n      {\r\n        id: 'specialized-niche',\r\n        label: language === 'bg' ? '–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏/–Ω–∏—à–æ–≤–∏' : 'Specialized & Niche',\r\n        emoji: 'üéØ',\r\n        description: language === 'bg' ? '–°–ø–µ—Ü–∏–∞–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –æ–±–ª–∞—Å—Ç–∏ –∏ –ø—Ä–æ—Ñ–µ—Å–∏–∏' : 'Special tools for specific fields and professions',\r\n        count: 27,\r\n        gradient: 'from-rose-500 to-pink-600'\r\n      }\r\n    ];\r\n\r\n    // Filter categories based on search\r\n    const filteredCategories = categories.filter(category =>\r\n      category.label.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      category.description.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n\r\n    useEffect(() => {\r\n      // Simulate loading\r\n      setTimeout(() => setLoading(false), 500);\r\n    }, []);\r\n\r\n    return (\r\n      <main className=\"max-w-6xl mx-auto px-4 py-8 pb-24 md:pb-12\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between mb-8\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <button onClick={goHome} className=\"inline-flex items-center gap-2 text-slate-600 hover:text-blue-600 transition-colors p-2 -ml-2 rounded-xl\">\r\n              <ArrowLeft className=\"w-4 h-4\" />\r\n              <span className=\"font-medium\">{t('back')}</span>\r\n            </button>\r\n            <div className=\"w-px h-6 bg-slate-300\" />\r\n            <div>\r\n              <h1 className=\"text-3xl text-slate-800 font-bold\">{t('categoriesTitle')}</h1>\r\n              <p className=\"text-slate-600 text-sm mt-1\">{t('categoriesSubtitle')}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Search */}\r\n        <div className=\"mb-8\">\r\n          <div className=\"relative max-w-md\">\r\n            <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5\" />\r\n            <Input\r\n              placeholder={t('searchCategories')}\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-12 bg-white/80 border-slate-200/50 h-12 rounded-2xl backdrop-blur-sm font-medium\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Categories Grid */}\r\n        {loading ? (\r\n          <div className=\"grid sm:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            {Array.from({ length: 9 }).map((_, i) => (\r\n              <div key={i} className=\"h-40 bg-slate-100 rounded-3xl animate-pulse\" />\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid sm:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            {filteredCategories.map((category) => (\r\n              <Card \r\n                key={category.id} \r\n                className=\"group border-slate-200/50 hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 bg-white/90 backdrop-blur-sm cursor-pointer overflow-hidden\"\r\n                onClick={() => {\r\n                  const capParam = CATEGORY_TO_CAP_MAPPING[category.id] || category.id;\r\n                  const newHash = `#/categories/${encodeURIComponent(capParam)}`;\r\n                  window.location.hash = newHash;\r\n                }}\r\n              >\r\n                <CardContent className=\"p-6 relative\">\r\n                  {/* Background gradient */}\r\n                  <div className={`absolute inset-0 bg-gradient-to-br ${category.gradient} opacity-5 group-hover:opacity-10 transition-opacity duration-300`} />\r\n                  \r\n                  {/* Content */}\r\n                  <div className=\"relative\">\r\n                    <div className=\"flex items-start justify-between mb-4\">\r\n                      <div className={`w-16 h-16 rounded-3xl bg-gradient-to-br ${category.gradient} flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300`}>\r\n                        <span className=\"text-2xl\">{category.emoji}</span>\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <div className=\"text-xs text-slate-500\">{category.count}</div>\r\n                        <div className=\"text-xs text-slate-400\">{t('toolsInCategory')}</div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <h3 className=\"text-xl font-bold text-slate-800 mb-2 group-hover:text-slate-900 transition-colors\">\r\n                      {category.label}\r\n                    </h3>\r\n                    \r\n                    <p className=\"text-sm text-slate-600 mb-4 leading-relaxed\">\r\n                      {category.description}\r\n                    </p>\r\n\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <Badge \r\n                        variant=\"secondary\" \r\n                        className={`text-xs font-medium px-3 py-1 bg-gradient-to-r ${category.gradient} text-white border-0`}\r\n                      >\r\n                        {t('browseCategory')}\r\n                      </Badge>\r\n                      <ArrowLeft className=\"w-4 h-4 text-slate-400 rotate-180 group-hover:translate-x-1 transition-transform duration-300\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Empty state */}\r\n        {!loading && filteredCategories.length === 0 && (\r\n          <div className=\"text-center py-20\">\r\n            <div className=\"w-20 h-20 bg-slate-100 rounded-3xl flex items-center justify-center mx-auto mb-6\">\r\n              <Search className=\"w-10 h-10 text-slate-400\" />\r\n            </div>\r\n            <h3 className=\"text-slate-800 mb-3 font-bold text-xl\">{t('noToolsTitle')}</h3>\r\n            <p className=\"text-slate-600\">{t('noToolsSubtitle')}</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Stats */}\r\n        <div className=\"mt-12 text-center\">\r\n          <div className=\"inline-flex items-center gap-6 bg-white/80 border border-slate-200/50 rounded-2xl px-6 py-4 backdrop-blur-sm\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-slate-800\">{filteredCategories.length}</div>\r\n              <div className=\"text-xs text-slate-500\">{t('totalCategories')}</div>\r\n            </div>\r\n            <div className=\"w-px h-8 bg-slate-300\" />\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-slate-800\">\r\n                {filteredCategories.reduce((total, cat) => total + cat.count, 0)}\r\n              </div>\r\n              <div className=\"text-xs text-slate-500\">{t('totalTools')}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    );\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}